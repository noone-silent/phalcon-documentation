<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Phalcon Framework. A full-stack PHP framework delivered as a PHP extension, offering lower resource consumption and high performance."><meta name=author content="Phalcon Team"><link href=https://docs.phalcon.io/5.7/tutorial-invo/ rel=canonical><link href=../tutorial-basic/ rel=prev><link href=../tutorial-rest/ rel=next><link rel=icon href=../assets/images/favicon.ico><meta name=generator content="mkdocs-1.6.0, mkdocs-material-9.5.26"><title>Invo - Phalcon Documentation</title><link rel=stylesheet href=../assets/stylesheets/main.6543a935.min.css><link rel=stylesheet href=../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Titillium+Web:300,300i,400,400i,700,700i%7CSource+Code+Pro:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Titillium Web";--md-code-font:"Source Code Pro"}</style><link rel=stylesheet href=../assets/css/extra.css><script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-JR4REKBKH3"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-JR4REKBKH3",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-JR4REKBKH3",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script><!-- Fanart --><!--

Phalcon Framework

A full-stack PHP framework delivered as a PHP extension,
offering lower resource consumption and high performance.

<3 Phalcon Team

                         ..
                         ....
   %                  ,   ......
     %%%               ,,  .......
      %%%%%%           ,,,,.........
       %%%%%%%%&        ,,,,,.........,
    /    %%%%%%%%%%      ,,,,,,..........
      //  %%%%%%%%%%%%%    ,,,,,,..........
       //// %%%%%%%%%%%%%%%  ,,,,,,..........,
         ////%%%%%%%%%%%%%%%%%%,,,,,,...........
          ///////%%%%%%%%%%%%%%%%%%,,,,...........
            ////////%%%%%%%%%%%%%%%%%%/,,...........
          %%%%/////////(%%%%%%%%%%%%%%%%%%,..........
            %%%%%//////////%%%%%%%%%%%%%%%%%%........(
               %%%%///////////(%%%%%%%%%%%%%%%%.......(
                 %%%%%////////////%%%%%%%%%%%%%%%.....//
                ....%%%%%////////////#%%%%%%%%%%%%%....//
                   .......(%/////////////%%%%%%%%%%%%..  /
                      ...........///////********/%%%%%..
                     ,,,,.............,/***************.
                         ,,,,,.............************......,/(
                               ,,,,,,..........********.....//////////
                              ((((((((**((((((((((((((*.....///////////
                                  %*********.../(((((((..........///(/#/
                               **********..........#%%%           ..*%%%
                            *********(..........%%%                  %%%
                         *********/..........%%%                     %%
                   %    *******%%.........%%%%
                  %   ******%%%%...../.*((((((   %%%%
                     ****%%%%%%.....///* (((((((%%%%%
                    ***&%%%%%%.....////* ((((((((%%  %
                    *  &%%%%%#..../////*  (((     %
                       &%%%%%....//////*           %
                        %%%% ....//////***   %%%
                     (  %%%   ...*/////*****%%%%
                     (   %     ...  //(*****/%%
                      (  &      ..   // ***  %%
                                 .     /      %
--><!-- Fanart --></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#tutorial-invo class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=.. title="Phalcon Documentation" class="md-header__button md-logo" aria-label="Phalcon Documentation" data-md-component=logo> <img src=https://assets.phalcon.io/phalcon/images/svg/phalcon-logo-35x39.svg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Phalcon Documentation </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Invo </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media=(prefers-color-scheme) data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1M8 13h8v-2H8v2m9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1 0 1.71-1.39 3.1-3.1 3.1h-4V17h4a5 5 0 0 0 5-5 5 5 0 0 0-5-5Z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=custom data-md-color-accent=teal aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=custom data-md-color-accent=teal aria-label="Switch to system preference" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to system preference" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5M7 15a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg> </label> </form> <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/phalcon/documentation title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> phalcon/documentation </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../introduction/ class=md-tabs__link> Home </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../installation/ class=md-tabs__link> Getting Started </a> </li> <li class=md-tabs__item> <a href=../application/ class=md-tabs__link> Core </a> </li> <li class=md-tabs__item> <a href=../db-layer/ class=md-tabs__link> Database </a> </li> <li class=md-tabs__item> <a href=../assets/ class=md-tabs__link> Front End </a> </li> <li class=md-tabs__item> <a href=../acl/ class=md-tabs__link> Business Logic </a> </li> <li class=md-tabs__item> <a href=../cache/ class=md-tabs__link> Services </a> </li> <li class=md-tabs__item> <a href=../api/ class=md-tabs__link> API </a> </li> <li class=md-tabs__item> <a href=https://github.com/orgs/phalcon/discussions class=md-tabs__link> Discussions </a> </li> <li class=md-tabs__item> <a href=https://blog.phalcon.io/ class=md-tabs__link> Blog </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=.. title="Phalcon Documentation" class="md-nav__button md-logo" aria-label="Phalcon Documentation" data-md-component=logo> <img src=https://assets.phalcon.io/phalcon/images/svg/phalcon-logo-35x39.svg alt=logo> </a> Phalcon Documentation </label> <div class=md-nav__source> <a href=https://github.com/phalcon/documentation title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> phalcon/documentation </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_1> <label class=md-nav__link for=__nav_1 id=__nav_1_label tabindex=0> <span class=md-ellipsis> Home </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_1_label aria-expanded=false> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> Home </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../introduction/ class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_1_2> <label class=md-nav__link for=__nav_1_2 id=__nav_1_2_label tabindex=0> <span class=md-ellipsis> Changelog </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_1_2_label aria-expanded=false> <label class=md-nav__title for=__nav_1_2> <span class="md-nav__icon md-icon"></span> Changelog </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=https://github.com/phalcon/cphalcon/blob/5.0.x/CHANGELOG-5.0.md class=md-nav__link> <span class=md-ellipsis> Current Version </span> </a> </li> <li class=md-nav__item> <a href=../releases/ class=md-nav__link> <span class=md-ellipsis> Releases </span> </a> </li> <li class=md-nav__item> <a href=../upgrade/ class=md-nav__link> <span class=md-ellipsis> How to upgrade </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_1_3> <label class=md-nav__link for=__nav_1_3 id=__nav_1_3_label tabindex=0> <span class=md-ellipsis> Contributing </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_1_3_label aria-expanded=false> <label class=md-nav__title for=__nav_1_3> <span class="md-nav__icon md-icon"></span> Contributing </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../contributions/ class=md-nav__link> <span class=md-ellipsis> Contributions </span> </a> </li> <li class=md-nav__item> <a href=https://phalcon.io/discussions class=md-nav__link> <span class=md-ellipsis> Asking a question </span> </a> </li> <li class=md-nav__item> <a href=../new-feature-request/ class=md-nav__link> <span class=md-ellipsis> Requesting a change </span> </a> </li> <li class=md-nav__item> <a href=../new-pull-request/ class=md-nav__link> <span class=md-ellipsis> Issuing a Pull Request </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_1_4> <label class=md-nav__link for=__nav_1_4 id=__nav_1_4_label tabindex=0> <span class=md-ellipsis> Guides </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_1_4_label aria-expanded=false> <label class=md-nav__title for=__nav_1_4> <span class="md-nav__icon md-icon"></span> Guides </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../generating-backtrace/ class=md-nav__link> <span class=md-ellipsis> Backtrace Generation </span> </a> </li> <li class=md-nav__item> <a href=../reproducible-tests/ class=md-nav__link> <span class=md-ellipsis> Reproducible Tests </span> </a> </li> <li class=md-nav__item> <a href=../testing-environment/ class=md-nav__link> <span class=md-ellipsis> Testing environment </span> </a> </li> <li class=md-nav__item> <a href=../coding-standard/ class=md-nav__link> <span class=md-ellipsis> Coding Standard </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../sponsors/ class=md-nav__link> <span class=md-ellipsis> Sponsoring </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2 checked> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex> <span class=md-ellipsis> Getting Started </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=true> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Getting Started </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../installation/ class=md-nav__link> <span class=md-ellipsis> Installation </span> </a> </li> <li class=md-nav__item> <a href=../webserver-setup/ class=md-nav__link> <span class=md-ellipsis> Webserver Setup </span> </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3> <label class=md-nav__link for=__nav_2_3 id=__nav_2_3_label tabindex> <span class=md-ellipsis> Environments </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3> <span class="md-nav__icon md-icon"></span> Environments </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../environments-devilbox/ class=md-nav__link> <span class=md-ellipsis> Devilbox </span> </a> </li> <li class=md-nav__item> <a href=../environments-nanobox/ class=md-nav__link> <span class=md-ellipsis> Nanobox </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_4> <label class=md-nav__link for=__nav_2_4 id=__nav_2_4_label tabindex> <span class=md-ellipsis> Development Tools </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_4_label aria-expanded=false> <label class=md-nav__title for=__nav_2_4> <span class="md-nav__icon md-icon"></span> Development Tools </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../devtools/ class=md-nav__link> <span class=md-ellipsis> Devtools </span> </a> </li> <li class=md-nav__item> <a href=../support-debug/ class=md-nav__link> <span class=md-ellipsis> Debug </span> </a> </li> <li class=md-nav__item> <a href=../db-migrations/ class=md-nav__link> <span class=md-ellipsis> Migrations </span> </a> </li> <li class=md-nav__item> <a href=../unit-testing/ class=md-nav__link> <span class=md-ellipsis> Unit Testing </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_5 checked> <label class=md-nav__link for=__nav_2_5 id=__nav_2_5_label tabindex> <span class=md-ellipsis> Tutorials </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_5_label aria-expanded=true> <label class=md-nav__title for=__nav_2_5> <span class="md-nav__icon md-icon"></span> Tutorials </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../tutorial-basic/ class=md-nav__link> <span class=md-ellipsis> Basic </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Invo </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Invo </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#overview class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=#structure class=md-nav__link> <span class=md-ellipsis> Structure </span> </a> </li> <li class=md-nav__item> <a href=#routing class=md-nav__link> <span class=md-ellipsis> Routing </span> </a> </li> <li class=md-nav__item> <a href=#configuration class=md-nav__link> <span class=md-ellipsis> Configuration </span> </a> </li> <li class=md-nav__item> <a href=#autoloader class=md-nav__link> <span class=md-ellipsis> Autoloader </span> </a> <nav class=md-nav aria-label=Autoloader> <ul class=md-nav__list> <li class=md-nav__item> <a href=#dotenv class=md-nav__link> <span class=md-ellipsis> DotEnv </span> </a> </li> <li class=md-nav__item> <a href=#providers class=md-nav__link> <span class=md-ellipsis> Providers </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#request-handling class=md-nav__link> <span class=md-ellipsis> Request Handling </span> </a> </li> <li class=md-nav__item> <a href=#dependency-injection class=md-nav__link> <span class=md-ellipsis> Dependency Injection </span> </a> </li> <li class=md-nav__item> <a href=#log-in class=md-nav__link> <span class=md-ellipsis> Log in </span> </a> </li> <li class=md-nav__item> <a href=#backend-security class=md-nav__link> <span class=md-ellipsis> Backend Security </span> </a> <nav class=md-nav aria-label="Backend Security"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#events class=md-nav__link> <span class=md-ellipsis> Events </span> </a> </li> <li class=md-nav__item> <a href=#acl class=md-nav__link> <span class=md-ellipsis> ACL </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#crud class=md-nav__link> <span class=md-ellipsis> CRUD </span> </a> </li> <li class=md-nav__item> <a href=#search-form class=md-nav__link> <span class=md-ellipsis> Search Form </span> </a> </li> <li class=md-nav__item> <a href=#search class=md-nav__link> <span class=md-ellipsis> Search </span> </a> </li> <li class=md-nav__item> <a href=#createupdate class=md-nav__link> <span class=md-ellipsis> Create/Update </span> </a> </li> <li class=md-nav__item> <a href=#dynamic-titles class=md-nav__link> <span class=md-ellipsis> Dynamic Titles </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../tutorial-rest/ class=md-nav__link> <span class=md-ellipsis> REST </span> </a> </li> <li class=md-nav__item> <a href=../tutorial-vokuro/ class=md-nav__link> <span class=md-ellipsis> Vokuro </span> </a> </li> <li class=md-nav__item> <a href=../use-case/ class=md-nav__link> <span class=md-ellipsis> Use case </span> </a> </li> <li class=md-nav__item> <a href=../performance/ class=md-nav__link> <span class=md-ellipsis> Performance </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Core </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Core </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../application/ class=md-nav__link> <span class=md-ellipsis> Application </span> </a> </li> <li class=md-nav__item> <a href=../application-micro/ class=md-nav__link> <span class=md-ellipsis> Micro </span> </a> </li> <li class=md-nav__item> <a href=../application-cli/ class=md-nav__link> <span class=md-ellipsis> CLI </span> </a> </li> <li class=md-nav__item> <a href=../di/ class=md-nav__link> <span class=md-ellipsis> DI Container </span> </a> </li> <li class=md-nav__item> <a href=../mvc/ class=md-nav__link> <span class=md-ellipsis> MVC </span> </a> </li> <li class=md-nav__item> <a href=../namespaces/ class=md-nav__link> <span class=md-ellipsis> Namespaces </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> Database </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Database </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../db-layer/ class=md-nav__link> <span class=md-ellipsis> Layer </span> </a> </li> <li class=md-nav__item> <a href=../db-phql/ class=md-nav__link> <span class=md-ellipsis> PHQL </span> </a> </li> <li class=md-nav__item> <a href=../db-odm/ class=md-nav__link> <span class=md-ellipsis> ODM </span> </a> </li> <li class=md-nav__item> <a href=../db-models/ class=md-nav__link> <span class=md-ellipsis> Models </span> </a> </li> <li class=md-nav__item> <a href=../db-models-behaviors/ class=md-nav__link> <span class=md-ellipsis> Behaviors </span> </a> </li> <li class=md-nav__item> <a href=../db-models-cache/ class=md-nav__link> <span class=md-ellipsis> Cache </span> </a> </li> <li class=md-nav__item> <a href=../db-models-events/ class=md-nav__link> <span class=md-ellipsis> Events </span> </a> </li> <li class=md-nav__item> <a href=../db-models-metadata/ class=md-nav__link> <span class=md-ellipsis> Metadata </span> </a> </li> <li class=md-nav__item> <a href=../db-models-relationships/ class=md-nav__link> <span class=md-ellipsis> Relationships </span> </a> </li> <li class=md-nav__item> <a href=../db-models-transactions/ class=md-nav__link> <span class=md-ellipsis> Transactions </span> </a> </li> <li class=md-nav__item> <a href=../db-models-validation/ class=md-nav__link> <span class=md-ellipsis> Validators </span> </a> </li> <li class=md-nav__item> <a href=../db-pagination/ class=md-nav__link> <span class=md-ellipsis> Pagination </span> </a> </li> <li class=md-nav__item> <a href=../db-migrations/ class=md-nav__link> <span class=md-ellipsis> Migrations </span> </a> </li> <li class=md-nav__item> <a href=../datamapper/ class=md-nav__link> <span class=md-ellipsis> DataMapper </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> Front End </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Front End </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../assets/ class=md-nav__link> <span class=md-ellipsis> Assets </span> </a> </li> <li class=md-nav__item> <a href=../flash/ class=md-nav__link> <span class=md-ellipsis> Flash Messenger </span> </a> </li> <li class=md-nav__item> <a href=../forms/ class=md-nav__link> <span class=md-ellipsis> Forms </span> </a> </li> <li class=md-nav__item> <a href=../image/ class=md-nav__link> <span class=md-ellipsis> Image </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_5> <label class=md-nav__link for=__nav_5_5 id=__nav_5_5_label tabindex=0> <span class=md-ellipsis> HTML </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5_5> <span class="md-nav__icon md-icon"></span> HTML </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../html-attributes/ class=md-nav__link> <span class=md-ellipsis> Attributes </span> </a> </li> <li class=md-nav__item> <a href=../html-breadcrumbs/ class=md-nav__link> <span class=md-ellipsis> Breadcrumbs </span> </a> </li> <li class=md-nav__item> <a href=../html-escaper/ class=md-nav__link> <span class=md-ellipsis> Escaper </span> </a> </li> <li class=md-nav__item> <a href=../html-link/ class=md-nav__link> <span class=md-ellipsis> Link </span> </a> </li> <li class=md-nav__item> <a href=../html-tagfactory/ class=md-nav__link> <span class=md-ellipsis> Tag Factory </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../tag/ class=md-nav__link> <span class=md-ellipsis> Tag (legacy) </span> </a> </li> <li class=md-nav__item> <a href=../views/ class=md-nav__link> <span class=md-ellipsis> View </span> </a> </li> <li class=md-nav__item> <a href=../volt/ class=md-nav__link> <span class=md-ellipsis> Volt </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> <span class=md-ellipsis> Business Logic </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Business Logic </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../acl/ class=md-nav__link> <span class=md-ellipsis> Access Control Lists </span> </a> </li> <li class=md-nav__item> <a href=../annotations/ class=md-nav__link> <span class=md-ellipsis> Annotations </span> </a> </li> <li class=md-nav__item> <a href=../controllers/ class=md-nav__link> <span class=md-ellipsis> Controllers </span> </a> </li> <li class=md-nav__item> <a href=../dispatcher/ class=md-nav__link> <span class=md-ellipsis> Dispatcher </span> </a> </li> <li class=md-nav__item> <a href=../events/ class=md-nav__link> <span class=md-ellipsis> Event Manager </span> </a> </li> <li class=md-nav__item> <a href=../filter-filter/ class=md-nav__link> <span class=md-ellipsis> Filters </span> </a> </li> <li class=md-nav__item> <a href=../routing/ class=md-nav__link> <span class=md-ellipsis> Routing </span> </a> </li> <li class=md-nav__item> <a href=../session/ class=md-nav__link> <span class=md-ellipsis> Sessions </span> </a> </li> <li class=md-nav__item> <a href=../mvc-url/ class=md-nav__link> <span class=md-ellipsis> Url </span> </a> </li> <li class=md-nav__item> <a href=../filter-validation/ class=md-nav__link> <span class=md-ellipsis> Validation </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7> <label class=md-nav__link for=__nav_7 id=__nav_7_label tabindex=0> <span class=md-ellipsis> Services </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=false> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> Services </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../cache/ class=md-nav__link> <span class=md-ellipsis> Cache </span> </a> </li> <li class=md-nav__item> <a href=../config/ class=md-nav__link> <span class=md-ellipsis> Config </span> </a> </li> <li class=md-nav__item> <a href=../html-escaper/ class=md-nav__link> <span class=md-ellipsis> Escaper </span> </a> </li> <li class=md-nav__item> <a href=../autoload/ class=md-nav__link> <span class=md-ellipsis> Loader </span> </a> </li> <li class=md-nav__item> <a href=../logger/ class=md-nav__link> <span class=md-ellipsis> Logger </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_6> <label class=md-nav__link for=__nav_7_6 id=__nav_7_6_label tabindex=0> <span class=md-ellipsis> HTTP </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_7_6_label aria-expanded=false> <label class=md-nav__title for=__nav_7_6> <span class="md-nav__icon md-icon"></span> HTTP </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../response.md#cookies class=md-nav__link> <span class=md-ellipsis> Cookies </span> </a> </li> <li class=md-nav__item> <a href=../request/ class=md-nav__link> <span class=md-ellipsis> Request </span> </a> </li> <li class=md-nav__item> <a href=../response/ class=md-nav__link> <span class=md-ellipsis> Response </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_7> <label class=md-nav__link for=__nav_7_7 id=__nav_7_7_label tabindex=0> <span class=md-ellipsis> i18n </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_7_7_label aria-expanded=false> <label class=md-nav__title for=__nav_7_7> <span class="md-nav__icon md-icon"></span> i18n </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../i18n/ class=md-nav__link> <span class=md-ellipsis> Internationalization </span> </a> </li> <li class=md-nav__item> <a href=../translate/ class=md-nav__link> <span class=md-ellipsis> Translate </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../queue/ class=md-nav__link> <span class=md-ellipsis> Queue </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_9> <label class=md-nav__link for=__nav_7_9 id=__nav_7_9_label tabindex=0> <span class=md-ellipsis> Security </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_7_9_label aria-expanded=false> <label class=md-nav__title for=__nav_7_9> <span class="md-nav__icon md-icon"></span> Security </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../encryption-crypt/ class=md-nav__link> <span class=md-ellipsis> Cryptography </span> </a> </li> <li class=md-nav__item> <a href=../encryption-security/ class=md-nav__link> <span class=md-ellipsis> Security </span> </a> </li> <li class=md-nav__item> <a href=../encryption-security-jwt/ class=md-nav__link> <span class=md-ellipsis> JWT </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../storage/ class=md-nav__link> <span class=md-ellipsis> Storage </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_11> <label class=md-nav__link for=__nav_7_11 id=__nav_7_11_label tabindex=0> <span class=md-ellipsis> Utility </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_7_11_label aria-expanded=false> <label class=md-nav__title for=__nav_7_11> <span class="md-nav__icon md-icon"></span> Utility </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../support-collection/ class=md-nav__link> <span class=md-ellipsis> Collection </span> </a> </li> <li class=md-nav__item> <a href=../domain/ class=md-nav__link> <span class=md-ellipsis> Domain </span> </a> </li> <li class=md-nav__item> <a href=../support-helper/ class=md-nav__link> <span class=md-ellipsis> Helper </span> </a> </li> <li class=md-nav__item> <a href=../support-registry/ class=md-nav__link> <span class=md-ellipsis> Registry </span> </a> </li> <li class=md-nav__item> <a href=../support-version/ class=md-nav__link> <span class=md-ellipsis> Version </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../api/ class=md-nav__link> <span class=md-ellipsis> API </span> </a> </li> <li class=md-nav__item> <a href=https://github.com/orgs/phalcon/discussions class=md-nav__link> <span class=md-ellipsis> Discussions </span> </a> </li> <li class=md-nav__item> <a href=https://blog.phalcon.io/ class=md-nav__link> <span class=md-ellipsis> Blog </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#overview class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=#structure class=md-nav__link> <span class=md-ellipsis> Structure </span> </a> </li> <li class=md-nav__item> <a href=#routing class=md-nav__link> <span class=md-ellipsis> Routing </span> </a> </li> <li class=md-nav__item> <a href=#configuration class=md-nav__link> <span class=md-ellipsis> Configuration </span> </a> </li> <li class=md-nav__item> <a href=#autoloader class=md-nav__link> <span class=md-ellipsis> Autoloader </span> </a> <nav class=md-nav aria-label=Autoloader> <ul class=md-nav__list> <li class=md-nav__item> <a href=#dotenv class=md-nav__link> <span class=md-ellipsis> DotEnv </span> </a> </li> <li class=md-nav__item> <a href=#providers class=md-nav__link> <span class=md-ellipsis> Providers </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#request-handling class=md-nav__link> <span class=md-ellipsis> Request Handling </span> </a> </li> <li class=md-nav__item> <a href=#dependency-injection class=md-nav__link> <span class=md-ellipsis> Dependency Injection </span> </a> </li> <li class=md-nav__item> <a href=#log-in class=md-nav__link> <span class=md-ellipsis> Log in </span> </a> </li> <li class=md-nav__item> <a href=#backend-security class=md-nav__link> <span class=md-ellipsis> Backend Security </span> </a> <nav class=md-nav aria-label="Backend Security"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#events class=md-nav__link> <span class=md-ellipsis> Events </span> </a> </li> <li class=md-nav__item> <a href=#acl class=md-nav__link> <span class=md-ellipsis> ACL </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#crud class=md-nav__link> <span class=md-ellipsis> CRUD </span> </a> </li> <li class=md-nav__item> <a href=#search-form class=md-nav__link> <span class=md-ellipsis> Search Form </span> </a> </li> <li class=md-nav__item> <a href=#search class=md-nav__link> <span class=md-ellipsis> Search </span> </a> </li> <li class=md-nav__item> <a href=#createupdate class=md-nav__link> <span class=md-ellipsis> Create/Update </span> </a> </li> <li class=md-nav__item> <a href=#dynamic-titles class=md-nav__link> <span class=md-ellipsis> Dynamic Titles </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/phalcon/documentation/edit/master/docs/tutorial-invo.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"/></svg> </a> <a href=https://github.com/phalcon/documentation/raw/master/docs/tutorial-invo.md title="View source of this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.15 8.15 0 0 1-1.23-2Z"/></svg> </a> <h1 id=tutorial-invo>Tutorial - INVO<a class=headerlink href=#tutorial-invo title="Permanent link">&para;</a></h1> <hr> <h2 id=overview>Overview<a class=headerlink href=#overview title="Permanent link">&para;</a></h2> <p><a href=https://github.com/phalcon/invo>INVO</a> is a small application that allows users to generate invoices, manage customers and products as well as sign up and log in. It showcases how certain tasks are handled by Phalcon. On the client side, <a href=https://getbootstrap.com>Bootstrap</a> is used for the UI. The application does not generate actual invoices but serves as an example of how these tasks are implemented using Phalcon.</p> <div class="admonition info"> <p class=admonition-title>NOTE</p> <p>It is recommended that you open the application in your favorite editor so that you can follow this tutorial easier. </p> </div> <div class="admonition info"> <p class=admonition-title>NOTE</p> <p>Note the code below has been formatted to increase readability</p> </div> <h2 id=structure>Structure<a class=headerlink href=#structure title="Permanent link">&para;</a></h2> <p>You can clone the repository to your machine (or download it) from <a href=https://github.com/phalcon/invo>GitHub</a>. Once you clone it (or download and unzip it) you will end up with the following directory structure:</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a>└──<span class=w> </span>invo
<a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=w>    </span>├──<span class=w> </span>config
<a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=w>    </span>├──<span class=w> </span>db
<a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=w>    </span>│<span class=w>   </span>└──<span class=w> </span>migrations
<a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=w>    </span>│<span class=w>       </span>└──<span class=w> </span><span class=m>1</span>.0.0
<a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=w>    </span>├──<span class=w> </span>docker
<a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=w>    </span>│<span class=w>   </span>└──<span class=w> </span><span class=m>8</span>.0
<a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=w>    </span>│<span class=w>   </span>└──<span class=w> </span><span class=m>8</span>.1
<a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a><span class=w>    </span>│──<span class=w> </span>public
<a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a><span class=w>    </span>│<span class=w>   </span>├──<span class=w> </span>index.php
<a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a><span class=w>    </span>│<span class=w>   </span>└──<span class=w> </span>js
<a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a><span class=w>    </span>├──<span class=w> </span>src
<a id=__codelineno-0-13 name=__codelineno-0-13 href=#__codelineno-0-13></a><span class=w>    </span>│<span class=w>   </span>├──<span class=w> </span>Controllers
<a id=__codelineno-0-14 name=__codelineno-0-14 href=#__codelineno-0-14></a><span class=w>    </span>│<span class=w>   </span>├──<span class=w> </span>Forms
<a id=__codelineno-0-15 name=__codelineno-0-15 href=#__codelineno-0-15></a><span class=w>    </span>│<span class=w>   </span>├──<span class=w> </span>Models
<a id=__codelineno-0-16 name=__codelineno-0-16 href=#__codelineno-0-16></a><span class=w>    </span>│<span class=w>   </span>├──<span class=w> </span>Plugins
<a id=__codelineno-0-17 name=__codelineno-0-17 href=#__codelineno-0-17></a><span class=w>    </span>│<span class=w>   </span>├──<span class=w> </span>Providers
<a id=__codelineno-0-18 name=__codelineno-0-18 href=#__codelineno-0-18></a><span class=w>    </span>├──<span class=w> </span>themes
<a id=__codelineno-0-19 name=__codelineno-0-19 href=#__codelineno-0-19></a><span class=w>    </span>│<span class=w>   </span>├──<span class=w> </span>about
<a id=__codelineno-0-20 name=__codelineno-0-20 href=#__codelineno-0-20></a><span class=w>    </span>│<span class=w>   </span>├──<span class=w> </span>companies
<a id=__codelineno-0-21 name=__codelineno-0-21 href=#__codelineno-0-21></a><span class=w>    </span>│<span class=w>   </span>├──<span class=w> </span>contact
<a id=__codelineno-0-22 name=__codelineno-0-22 href=#__codelineno-0-22></a><span class=w>    </span>│<span class=w>   </span>├──<span class=w> </span>errors
<a id=__codelineno-0-23 name=__codelineno-0-23 href=#__codelineno-0-23></a><span class=w>    </span>│<span class=w>   </span>├──<span class=w> </span>index
<a id=__codelineno-0-24 name=__codelineno-0-24 href=#__codelineno-0-24></a><span class=w>    </span>│<span class=w>   </span>├──<span class=w> </span>invoices
<a id=__codelineno-0-25 name=__codelineno-0-25 href=#__codelineno-0-25></a><span class=w>    </span>│<span class=w>   </span>├──<span class=w> </span>layouts
<a id=__codelineno-0-26 name=__codelineno-0-26 href=#__codelineno-0-26></a><span class=w>    </span>│<span class=w>   </span>├──<span class=w> </span>products
<a id=__codelineno-0-27 name=__codelineno-0-27 href=#__codelineno-0-27></a><span class=w>    </span>│<span class=w>   </span>├──<span class=w> </span>producttypes
<a id=__codelineno-0-28 name=__codelineno-0-28 href=#__codelineno-0-28></a><span class=w>    </span>│<span class=w>   </span>├──<span class=w> </span>register
<a id=__codelineno-0-29 name=__codelineno-0-29 href=#__codelineno-0-29></a><span class=w>    </span>│<span class=w>   </span>└──<span class=w> </span>session
<a id=__codelineno-0-30 name=__codelineno-0-30 href=#__codelineno-0-30></a><span class=w>    </span>└──<span class=w> </span>var
<a id=__codelineno-0-31 name=__codelineno-0-31 href=#__codelineno-0-31></a><span class=w>        </span>├──<span class=w> </span>cache
<a id=__codelineno-0-32 name=__codelineno-0-32 href=#__codelineno-0-32></a><span class=w>        </span>└──<span class=w> </span>logs
</code></pre></div> Since Phalcon does not impose a particular directory structure, the particular structure is just our implementation. You will need to set up your web server with instructions from the <a href=../webserver-setup/ >webserver setup</a> page. The entry point will be <code>public/index.php</code></p> <p>Once the application is set up, you can open it in your browser by navigating to the following URL <code>https://localhost/invo</code>. You will see a screen similar to the one below:</p> <p><img alt src=../assets/images/content/tutorial-invo-1.png></p> <p>The application is divided into two parts: a frontend and a backend. The front end is a public area where visitors can receive information about INVO and request contact information. The backend is an administrative area where registered users can manage their products and customers.</p> <h2 id=routing>Routing<a class=headerlink href=#routing title="Permanent link">&para;</a></h2> <p>INVO uses the standard route that is built-in with the <a href=../routing/ >Router</a> component. These routes match the following pattern:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a>/:controller/:action/:params
</code></pre></div> <p>The custom route <code>/session/register</code> executes the controller <code>SessionController</code> and its action <code>registerAction</code>.</p> <h2 id=configuration>Configuration<a class=headerlink href=#configuration title="Permanent link">&para;</a></h2> <h2 id=autoloader>Autoloader<a class=headerlink href=#autoloader title="Permanent link">&para;</a></h2> <p>For this application, we utilize the autoloader that comes with composer. You can easily adjust the code to use the autoloader provided by Phalcon if you wish:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a>
<a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a><span class=nv>$rootPath</span> <span class=o>=</span> <span class=nb>realpath</span><span class=p>(</span><span class=s1>&#39;..&#39;</span><span class=p>);</span>
<a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a><span class=k>require_once</span> <span class=nv>$rootPath</span> <span class=o>.</span> <span class=s1>&#39;/vendor/autoload.php&#39;</span><span class=p>;</span>
</code></pre></div> <h3 id=dotenv><code>DotEnv</code><a class=headerlink href=#dotenv title="Permanent link">&para;</a></h3> <p>INVO uses the <code>Dotenv\Dotenv</code> library to retrieve some configuration variables that are unique to each installation.</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a>
<a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a><span class=sd>/**</span>
<a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a><span class=sd> * Load ENV variables</span>
<a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a><span class=sd> */</span>
<a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a><span class=nx>Dotenv</span><span class=o>::</span><span class=na>createImmutable</span><span class=p>(</span><span class=nv>$rootPath</span><span class=p>)</span>
<a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a>      <span class=o>-&gt;</span><span class=na>load</span><span class=p>()</span>
<a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a><span class=p>;</span>
</code></pre></div> The above assumes that a <code>.env</code> file is present in your root directory. There is a <code>.env.example</code> file that you can use as a reference and copy/rename it.</p> <h3 id=providers>Providers<a class=headerlink href=#providers title="Permanent link">&para;</a></h3> <p>We will need to register all the services we need for the application in a DI container. The framework provides a variant of <a href=../di/ >Phalcon\Di\Di</a> called <a href=../di/#factory-default>Phalcon\Di\FactoryDefault</a>. This class has pre-registered services to suit a full-stack MVC application. We therefore create a new <code>Phalcon\Di\FactoryDefault</code> object and then call the provider classes to load the necessary services including the configuration of the application. They are all under the <code>Providers</code> folder.</p> <p>As an example, the <code>Providers\ConfigProvider.php</code> class loads the <code>config/config.php</code> file, which contains the configuration of the application:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a>
<a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a><span class=k>namespace</span> <span class=nx>Invo\Providers</span><span class=p>;</span>
<a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a>
<a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a><span class=k>use</span> <span class=nx>Exception</span><span class=p>;</span>
<a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a><span class=k>use</span> <span class=nx>Phalcon\Di\DiInterface</span><span class=p>;</span>
<a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a><span class=k>use</span> <span class=nx>Phalcon\Di\ServiceProviderInterface</span><span class=p>;</span>
<a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a>
<a id=__codelineno-4-9 name=__codelineno-4-9 href=#__codelineno-4-9></a><span class=sd>/**</span>
<a id=__codelineno-4-10 name=__codelineno-4-10 href=#__codelineno-4-10></a><span class=sd> * Read the configuration</span>
<a id=__codelineno-4-11 name=__codelineno-4-11 href=#__codelineno-4-11></a><span class=sd> */</span>
<a id=__codelineno-4-12 name=__codelineno-4-12 href=#__codelineno-4-12></a><span class=k>class</span> <span class=nc>ConfigProvider</span> <span class=k>implements</span> <span class=nx>ServiceProviderInterface</span>
<a id=__codelineno-4-13 name=__codelineno-4-13 href=#__codelineno-4-13></a><span class=p>{</span>
<a id=__codelineno-4-14 name=__codelineno-4-14 href=#__codelineno-4-14></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>register</span><span class=p>(</span><span class=nx>DiInterface</span> <span class=nv>$di</span><span class=p>)</span><span class=o>:</span> <span class=nx>void</span>
<a id=__codelineno-4-15 name=__codelineno-4-15 href=#__codelineno-4-15></a>    <span class=p>{</span>
<a id=__codelineno-4-16 name=__codelineno-4-16 href=#__codelineno-4-16></a>        <span class=nv>$configPath</span> <span class=o>=</span> <span class=nv>$di</span><span class=o>-&gt;</span><span class=na>offsetGet</span><span class=p>(</span><span class=s1>&#39;rootPath&#39;</span><span class=p>)</span> <span class=o>.</span> <span class=s1>&#39;/config/config.php&#39;</span><span class=p>;</span>
<a id=__codelineno-4-17 name=__codelineno-4-17 href=#__codelineno-4-17></a>        <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nb>file_exists</span><span class=p>(</span><span class=nv>$configPath</span><span class=p>)</span> <span class=o>||</span> <span class=o>!</span><span class=nb>is_readable</span><span class=p>(</span><span class=nv>$configPath</span><span class=p>))</span> <span class=p>{</span>
<a id=__codelineno-4-18 name=__codelineno-4-18 href=#__codelineno-4-18></a>            <span class=k>throw</span> <span class=k>new</span> <span class=nx>Exception</span><span class=p>(</span><span class=s1>&#39;Config file does not exist: &#39;</span> <span class=o>.</span> <span class=nv>$configPath</span><span class=p>);</span>
<a id=__codelineno-4-19 name=__codelineno-4-19 href=#__codelineno-4-19></a>        <span class=p>}</span>
<a id=__codelineno-4-20 name=__codelineno-4-20 href=#__codelineno-4-20></a>
<a id=__codelineno-4-21 name=__codelineno-4-21 href=#__codelineno-4-21></a>        <span class=nv>$di</span><span class=o>-&gt;</span><span class=na>setShared</span><span class=p>(</span><span class=s1>&#39;config&#39;</span><span class=p>,</span> <span class=k>function</span> <span class=p>()</span> <span class=k>use</span> <span class=p>(</span><span class=nv>$configPath</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-4-22 name=__codelineno-4-22 href=#__codelineno-4-22></a>            <span class=k>return</span> <span class=k>require_once</span> <span class=nv>$configPath</span><span class=p>;</span>
<a id=__codelineno-4-23 name=__codelineno-4-23 href=#__codelineno-4-23></a>        <span class=p>});</span>
<a id=__codelineno-4-24 name=__codelineno-4-24 href=#__codelineno-4-24></a>    <span class=p>}</span>
<a id=__codelineno-4-25 name=__codelineno-4-25 href=#__codelineno-4-25></a><span class=p>}</span>
</code></pre></div> <p><a href=../config/ >Phalcon\Config\Config</a> allows us to manipulate the file in an object-oriented way. The configuration file has the following settings:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a>
<a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a><span class=k>declare</span><span class=p>(</span><span class=nx>strict_types</span><span class=o>=</span><span class=mi>1</span><span class=p>);</span>
<a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a>
<a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a><span class=k>use</span> <span class=nx>Phalcon\Config\Config</span><span class=p>;</span>
<a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a>
<a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a><span class=k>return</span> <span class=k>new</span> <span class=nx>Config</span><span class=p>([</span>
<a id=__codelineno-5-8 name=__codelineno-5-8 href=#__codelineno-5-8></a>    <span class=s1>&#39;database&#39;</span> <span class=o>=&gt;</span> <span class=p>[</span>
<a id=__codelineno-5-9 name=__codelineno-5-9 href=#__codelineno-5-9></a>        <span class=s1>&#39;adapter&#39;</span>  <span class=o>=&gt;</span> <span class=nv>$_ENV</span><span class=p>[</span><span class=s1>&#39;DB_ADAPTER&#39;</span><span class=p>]</span> <span class=o>??</span> <span class=s1>&#39;Mysql&#39;</span><span class=p>,</span>
<a id=__codelineno-5-10 name=__codelineno-5-10 href=#__codelineno-5-10></a>        <span class=s1>&#39;host&#39;</span>     <span class=o>=&gt;</span> <span class=nv>$_ENV</span><span class=p>[</span><span class=s1>&#39;DB_HOST&#39;</span><span class=p>]</span> <span class=o>??</span> <span class=s1>&#39;locahost&#39;</span><span class=p>,</span>
<a id=__codelineno-5-11 name=__codelineno-5-11 href=#__codelineno-5-11></a>        <span class=s1>&#39;username&#39;</span> <span class=o>=&gt;</span> <span class=nv>$_ENV</span><span class=p>[</span><span class=s1>&#39;DB_USERNAME&#39;</span><span class=p>]</span> <span class=o>??</span> <span class=s1>&#39;phalcon&#39;</span><span class=p>,</span>
<a id=__codelineno-5-12 name=__codelineno-5-12 href=#__codelineno-5-12></a>        <span class=s1>&#39;password&#39;</span> <span class=o>=&gt;</span> <span class=nv>$_ENV</span><span class=p>[</span><span class=s1>&#39;DB_PASSWORD&#39;</span><span class=p>]</span> <span class=o>??</span> <span class=s1>&#39;secret&#39;</span><span class=p>,</span>
<a id=__codelineno-5-13 name=__codelineno-5-13 href=#__codelineno-5-13></a>        <span class=s1>&#39;dbname&#39;</span>   <span class=o>=&gt;</span> <span class=nv>$_ENV</span><span class=p>[</span><span class=s1>&#39;DB_DBNAME&#39;</span><span class=p>]</span> <span class=o>??</span> <span class=s1>&#39;phalcon_invo&#39;</span><span class=p>,</span>
<a id=__codelineno-5-14 name=__codelineno-5-14 href=#__codelineno-5-14></a>        <span class=s1>&#39;charset&#39;</span>  <span class=o>=&gt;</span> <span class=nv>$_ENV</span><span class=p>[</span><span class=s1>&#39;DB_CHARSET&#39;</span><span class=p>]</span> <span class=o>??</span> <span class=s1>&#39;utf8&#39;</span><span class=p>,</span>
<a id=__codelineno-5-15 name=__codelineno-5-15 href=#__codelineno-5-15></a>    <span class=p>],</span>
<a id=__codelineno-5-16 name=__codelineno-5-16 href=#__codelineno-5-16></a>    <span class=s1>&#39;application&#39;</span> <span class=o>=&gt;</span> <span class=p>[</span>
<a id=__codelineno-5-17 name=__codelineno-5-17 href=#__codelineno-5-17></a>        <span class=s1>&#39;viewsDir&#39;</span> <span class=o>=&gt;</span> <span class=nv>$_ENV</span><span class=p>[</span><span class=s1>&#39;VIEWS_DIR&#39;</span><span class=p>]</span> <span class=o>??</span> <span class=s1>&#39;themes/invo&#39;</span><span class=p>,</span>
<a id=__codelineno-5-18 name=__codelineno-5-18 href=#__codelineno-5-18></a>        <span class=s1>&#39;baseUri&#39;</span>  <span class=o>=&gt;</span> <span class=nv>$_ENV</span><span class=p>[</span><span class=s1>&#39;BASE_URI&#39;</span><span class=p>]</span> <span class=o>??</span> <span class=s1>&#39;/&#39;</span><span class=p>,</span>
<a id=__codelineno-5-19 name=__codelineno-5-19 href=#__codelineno-5-19></a>    <span class=p>],</span>
<a id=__codelineno-5-20 name=__codelineno-5-20 href=#__codelineno-5-20></a><span class=p>]);</span>
</code></pre></div> <p>Phalcon does not have a convention for defining settings. Sections help us to organize the options based on groups that make sense for our application. In our file, there are two sections that will be used later on: <code>application</code> and <code>database</code>.</p> <h2 id=request-handling>Request Handling<a class=headerlink href=#request-handling title="Permanent link">&para;</a></h2> <p>At the end of the file (<code>public/index.php</code>), the request is finally handled by <a href=../application/ >Phalcon\Mvc\Application</a>, which initializes all the services necessary for the application to run.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a>
<a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Application</span><span class=p>;</span>
<a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a>
<a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a><span class=c1>// ...</span>
<a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a>
<a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a><span class=sd>/**</span>
<a id=__codelineno-6-8 name=__codelineno-6-8 href=#__codelineno-6-8></a><span class=sd> * Init MVC Application and send output to the client</span>
<a id=__codelineno-6-9 name=__codelineno-6-9 href=#__codelineno-6-9></a><span class=sd> */</span>
<a id=__codelineno-6-10 name=__codelineno-6-10 href=#__codelineno-6-10></a><span class=p>(</span><span class=k>new</span> <span class=nx>Application</span><span class=p>(</span><span class=nv>$di</span><span class=p>))</span>
<a id=__codelineno-6-11 name=__codelineno-6-11 href=#__codelineno-6-11></a>    <span class=o>-&gt;</span><span class=na>handle</span><span class=p>(</span><span class=nv>$_SERVER</span><span class=p>[</span><span class=s1>&#39;REQUEST_URI&#39;</span><span class=p>])</span>
<a id=__codelineno-6-12 name=__codelineno-6-12 href=#__codelineno-6-12></a>    <span class=o>-&gt;</span><span class=na>send</span><span class=p>()</span>
<a id=__codelineno-6-13 name=__codelineno-6-13 href=#__codelineno-6-13></a><span class=p>;</span>
</code></pre></div> <h2 id=dependency-injection>Dependency Injection<a class=headerlink href=#dependency-injection title="Permanent link">&para;</a></h2> <p>In the first line of the code block above, the <a href=../application/ >Application</a> class constructor receives the variable <code>$container</code> as an argument.</p> <p>Since Phalcon is highly decoupled, we need the container to be able to access registered services from it in different parts of the application. The component in question is <a href=../di/ >Phalcon\Di\Di</a>. It is a service container, that also performs dependency injection and service location, instantiating all components as they are needed by the application.</p> <p>There are many ways available to register services in the container. In INVO, most services have been registered using anonymous functions/closures. Thanks to this, the objects are lazy loaded, reducing the resources required by the application to a bare minimum.</p> <p>For instance, in the following excerpt the <code>Providers\SessionProvider</code> service is registered. The anonymous function will only be called when the application requires access to the session data:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a>
<a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a><span class=k>use</span> <span class=nx>Phalcon\Session\Adapter\Stream</span> <span class=k>as</span> <span class=nx>SessionAdapter</span><span class=p>;</span>
<a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a><span class=k>use</span> <span class=nx>Phalcon\Session\Manager</span> <span class=k>as</span> <span class=nx>SessionManager</span><span class=p>;</span>
<a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a>
<a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a><span class=nv>$di</span><span class=o>-&gt;</span><span class=na>setShared</span><span class=p>(</span>
<a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a>    <span class=s1>&#39;session&#39;</span><span class=p>,</span> 
<a id=__codelineno-7-8 name=__codelineno-7-8 href=#__codelineno-7-8></a>    <span class=k>function</span> <span class=p>()</span> <span class=p>{</span>
<a id=__codelineno-7-9 name=__codelineno-7-9 href=#__codelineno-7-9></a>        <span class=nv>$session</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>SessionManager</span><span class=p>();</span>
<a id=__codelineno-7-10 name=__codelineno-7-10 href=#__codelineno-7-10></a>        <span class=nv>$files</span>   <span class=o>=</span> <span class=k>new</span> <span class=nx>SessionAdapter</span><span class=p>(</span>
<a id=__codelineno-7-11 name=__codelineno-7-11 href=#__codelineno-7-11></a>            <span class=p>[</span>
<a id=__codelineno-7-12 name=__codelineno-7-12 href=#__codelineno-7-12></a>                <span class=s1>&#39;savePath&#39;</span> <span class=o>=&gt;</span> <span class=nb>sys_get_temp_dir</span><span class=p>(),</span>
<a id=__codelineno-7-13 name=__codelineno-7-13 href=#__codelineno-7-13></a>            <span class=p>]</span>
<a id=__codelineno-7-14 name=__codelineno-7-14 href=#__codelineno-7-14></a>        <span class=p>);</span>
<a id=__codelineno-7-15 name=__codelineno-7-15 href=#__codelineno-7-15></a>        <span class=nv>$session</span><span class=o>-&gt;</span><span class=na>setAdapter</span><span class=p>(</span><span class=nv>$files</span><span class=p>);</span>
<a id=__codelineno-7-16 name=__codelineno-7-16 href=#__codelineno-7-16></a>        <span class=nv>$session</span><span class=o>-&gt;</span><span class=na>start</span><span class=p>();</span>
<a id=__codelineno-7-17 name=__codelineno-7-17 href=#__codelineno-7-17></a>
<a id=__codelineno-7-18 name=__codelineno-7-18 href=#__codelineno-7-18></a>        <span class=k>return</span> <span class=nv>$session</span><span class=p>;</span>
<a id=__codelineno-7-19 name=__codelineno-7-19 href=#__codelineno-7-19></a>    <span class=p>}</span>
<a id=__codelineno-7-20 name=__codelineno-7-20 href=#__codelineno-7-20></a><span class=p>);</span>
</code></pre></div> <p>Here, we have the freedom to change the adapter, perform additional initialization, and much more. Note that the service was registered using the name <code>session</code>. This is a convention that will allow the framework to identify the active service in the DI container.</p> <h2 id=log-in>Log in<a class=headerlink href=#log-in title="Permanent link">&para;</a></h2> <p>A <code>log in</code> page will allow us to work with the backend controllers. The separation between backend controllers and frontend ones is arbitrary. All controllers are located in the same directory (<code>src/Controllers/</code>).</p> <p><img alt src=../assets/images/content/tutorial-invo-2.png></p> <p>To enter the system, users must have a valid username and password. User data is stored in the table <code>users</code> in the database <code>invo</code>.</p> <p>Now we need to configure the connection to the database. A service called <code>db</code> is set up in the service container with the connection information. As with the autoloader, we are again taking parameters from the configuration file in order to configure the service:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a>
<a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a><span class=c1>// ...</span>
<a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a>
<a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a><span class=nv>$dbConfig</span> <span class=o>=</span> <span class=nv>$di</span><span class=o>-&gt;</span><span class=na>getShared</span><span class=p>(</span><span class=s1>&#39;config&#39;</span><span class=p>)</span>
<a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a>               <span class=o>-&gt;</span><span class=na>get</span><span class=p>(</span><span class=s1>&#39;database&#39;</span><span class=p>)</span>
<a id=__codelineno-8-7 name=__codelineno-8-7 href=#__codelineno-8-7></a>               <span class=o>-&gt;</span><span class=na>toArray</span><span class=p>()</span>
<a id=__codelineno-8-8 name=__codelineno-8-8 href=#__codelineno-8-8></a><span class=p>;</span>
<a id=__codelineno-8-9 name=__codelineno-8-9 href=#__codelineno-8-9></a><span class=nv>$di</span><span class=o>-&gt;</span><span class=na>setShared</span><span class=p>(</span><span class=s1>&#39;db&#39;</span><span class=p>,</span> <span class=k>function</span> <span class=p>()</span> <span class=k>use</span> <span class=p>(</span><span class=nv>$dbConfig</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-8-10 name=__codelineno-8-10 href=#__codelineno-8-10></a>    <span class=nv>$dbClass</span> <span class=o>=</span> <span class=s1>&#39;Phalcon\Db\Adapter\Pdo\\&#39;</span> <span class=o>.</span> <span class=nv>$dbConfig</span><span class=p>[</span><span class=s1>&#39;adapter&#39;</span><span class=p>];</span>
<a id=__codelineno-8-11 name=__codelineno-8-11 href=#__codelineno-8-11></a>    <span class=nb>unset</span><span class=p>(</span><span class=nv>$dbConfig</span><span class=p>[</span><span class=s1>&#39;adapter&#39;</span><span class=p>]);</span>
<a id=__codelineno-8-12 name=__codelineno-8-12 href=#__codelineno-8-12></a>
<a id=__codelineno-8-13 name=__codelineno-8-13 href=#__codelineno-8-13></a>    <span class=k>return</span> <span class=k>new</span> <span class=nv>$dbClass</span><span class=p>(</span><span class=nv>$dbConfig</span><span class=p>);</span>
<a id=__codelineno-8-14 name=__codelineno-8-14 href=#__codelineno-8-14></a><span class=p>});</span>
</code></pre></div> <p>Here, we return an instance of the MySQL connection adapter, because the <code>$dbConfig['adapter']</code> setting is <code>Mysql</code>. We can also add extra functionality, such as adding a [Logger][logger], a <a href=../db-models-events/#profiling-sql-statements>profiler</a> to measure query execution times or even change the adapter to a different RDBMS.</p> <p>The following simple form (<code>themes/invo/session/index.volt</code>) produces the necessary HTML so that users can submit login information. Some HTML code has been removed to improve readability:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=x>&lt;div&gt;</span>
<a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a><span class=x>    &lt;div&gt;</span>
<a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a><span class=x>        &lt;form action=&quot;/session/start&quot; role=&quot;form&quot; method=&quot;post&quot;&gt;</span>
<a id=__codelineno-9-4 name=__codelineno-9-4 href=#__codelineno-9-4></a><span class=x>            &lt;fieldset&gt;</span>
<a id=__codelineno-9-5 name=__codelineno-9-5 href=#__codelineno-9-5></a><span class=x>                &lt;div class=&quot;form-group&quot;&gt;</span>
<a id=__codelineno-9-6 name=__codelineno-9-6 href=#__codelineno-9-6></a><span class=x>                    &lt;label for=&quot;email&quot;&gt;Username/Email&lt;/label&gt;</span>
<a id=__codelineno-9-7 name=__codelineno-9-7 href=#__codelineno-9-7></a><span class=x>                    &lt;div class=&quot;controls&quot;&gt;</span>
<a id=__codelineno-9-8 name=__codelineno-9-8 href=#__codelineno-9-8></a><span class=x>                        </span><span class=cp>{{</span> <span class=nv>text_field</span><span class=o>(</span><span class=s1>&#39;email&#39;</span><span class=o>,</span> <span class=s1>&#39;class&#39;</span><span class=o>:</span> <span class=s2>&quot;form-control&quot;</span><span class=o>)</span> <span class=cp>}}</span>
<a id=__codelineno-9-9 name=__codelineno-9-9 href=#__codelineno-9-9></a><span class=x>                    &lt;/div&gt;</span>
<a id=__codelineno-9-10 name=__codelineno-9-10 href=#__codelineno-9-10></a><span class=x>                &lt;/div&gt;</span>
<a id=__codelineno-9-11 name=__codelineno-9-11 href=#__codelineno-9-11></a><span class=x>                &lt;div class=&quot;form-group&quot;&gt;</span>
<a id=__codelineno-9-12 name=__codelineno-9-12 href=#__codelineno-9-12></a><span class=x>                    &lt;label for=&quot;password&quot;&gt;Password&lt;/label&gt;</span>
<a id=__codelineno-9-13 name=__codelineno-9-13 href=#__codelineno-9-13></a><span class=x>                    &lt;div class=&quot;controls&quot;&gt;</span>
<a id=__codelineno-9-14 name=__codelineno-9-14 href=#__codelineno-9-14></a><span class=x>                        </span><span class=cp>{{</span> <span class=nv>password_field</span><span class=o>(</span><span class=s1>&#39;password&#39;</span><span class=o>,</span> <span class=s1>&#39;class&#39;</span><span class=o>:</span> <span class=s2>&quot;form-control&quot;</span><span class=o>)</span> <span class=cp>}}</span>
<a id=__codelineno-9-15 name=__codelineno-9-15 href=#__codelineno-9-15></a><span class=x>                    &lt;/div&gt;</span>
<a id=__codelineno-9-16 name=__codelineno-9-16 href=#__codelineno-9-16></a><span class=x>                &lt;/div&gt;</span>
<a id=__codelineno-9-17 name=__codelineno-9-17 href=#__codelineno-9-17></a><span class=x>                &lt;div class=&quot;form-group&quot;&gt;</span>
<a id=__codelineno-9-18 name=__codelineno-9-18 href=#__codelineno-9-18></a><span class=x>                    </span><span class=cp>{{</span> <span class=nv>submit_button</span><span class=o>(</span><span class=s1>&#39;Login&#39;</span><span class=o>,</span> <span class=s1>&#39;class&#39;</span><span class=o>:</span> <span class=s1>&#39;btn btn-primary btn-large&#39;</span><span class=o>)</span> <span class=cp>}}</span>
<a id=__codelineno-9-19 name=__codelineno-9-19 href=#__codelineno-9-19></a><span class=x>                &lt;/div&gt;</span>
<a id=__codelineno-9-20 name=__codelineno-9-20 href=#__codelineno-9-20></a><span class=x>            &lt;/fieldset&gt;</span>
<a id=__codelineno-9-21 name=__codelineno-9-21 href=#__codelineno-9-21></a><span class=x>        &lt;/form&gt;</span>
<a id=__codelineno-9-22 name=__codelineno-9-22 href=#__codelineno-9-22></a><span class=x>    &lt;/div&gt;</span>
<a id=__codelineno-9-23 name=__codelineno-9-23 href=#__codelineno-9-23></a>
<a id=__codelineno-9-24 name=__codelineno-9-24 href=#__codelineno-9-24></a><span class=x>    &lt;div class=&quot;col-md-6&quot;&gt;</span>
<a id=__codelineno-9-25 name=__codelineno-9-25 href=#__codelineno-9-25></a><span class=x>        &lt;div class=&quot;clearfix center&quot;&gt;</span>
<a id=__codelineno-9-26 name=__codelineno-9-26 href=#__codelineno-9-26></a><span class=x>            </span><span class=cp>{{</span> <span class=nv>link_to</span><span class=o>(</span><span class=s1>&#39;register&#39;</span><span class=o>,</span> <span class=s1>&#39;Sign Up&#39;</span><span class=o>,</span> <span class=s1>&#39;class&#39;</span><span class=o>:</span> <span class=s1>&#39;btn btn-primary btn-large btn-success&#39;</span><span class=o>)</span> <span class=cp>}}</span>
<a id=__codelineno-9-27 name=__codelineno-9-27 href=#__codelineno-9-27></a><span class=x>        &lt;/div&gt;</span>
<a id=__codelineno-9-28 name=__codelineno-9-28 href=#__codelineno-9-28></a><span class=x>    &lt;/div&gt;</span>
<a id=__codelineno-9-29 name=__codelineno-9-29 href=#__codelineno-9-29></a><span class=x>&lt;/div&gt;</span>
</code></pre></div> <p>We are using <a href=../volt/ >Volt</a> as our template engine instead of PHP. This is a built-in template engine inspired by <a href=https://jinja.palletsprojects.com/en/2.10.x/ >Jinja</a> providing a simple and user-friendly syntax to create templates. If you have worked with <a href=https://jinja.palletsprojects.com/en/2.10.x/ >Jinja</a> or <a href=https://twig.symfony.com/ >Twig</a> in the past, you will see many similarities.</p> <p>The <code>SessionController::startAction</code> function (<code>src/Controllers/SessionController.php</code>) validates the data submitted from the form, and also checks for a valid user in the database:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a>
<a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a><span class=k>use</span> <span class=nx>Invo\Models\Users</span><span class=p>;</span>
<a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a>
<a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a><span class=k>class</span> <span class=nc>SessionController</span> <span class=k>extends</span> <span class=nx>ControllerBase</span>
<a id=__codelineno-10-6 name=__codelineno-10-6 href=#__codelineno-10-6></a><span class=p>{</span>
<a id=__codelineno-10-7 name=__codelineno-10-7 href=#__codelineno-10-7></a>    <span class=c1>// ...</span>
<a id=__codelineno-10-8 name=__codelineno-10-8 href=#__codelineno-10-8></a>
<a id=__codelineno-10-9 name=__codelineno-10-9 href=#__codelineno-10-9></a>    <span class=sd>/**</span>
<a id=__codelineno-10-10 name=__codelineno-10-10 href=#__codelineno-10-10></a><span class=sd>     * This action authenticate and logs a user into the application</span>
<a id=__codelineno-10-11 name=__codelineno-10-11 href=#__codelineno-10-11></a><span class=sd>     */</span>
<a id=__codelineno-10-12 name=__codelineno-10-12 href=#__codelineno-10-12></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>startAction</span><span class=p>()</span><span class=o>:</span> <span class=nx>void</span>
<a id=__codelineno-10-13 name=__codelineno-10-13 href=#__codelineno-10-13></a>    <span class=p>{</span>
<a id=__codelineno-10-14 name=__codelineno-10-14 href=#__codelineno-10-14></a>        <span class=k>if</span> <span class=p>(</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>request</span><span class=o>-&gt;</span><span class=na>isPost</span><span class=p>())</span> <span class=p>{</span>
<a id=__codelineno-10-15 name=__codelineno-10-15 href=#__codelineno-10-15></a>            <span class=nv>$email</span>    <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>request</span><span class=o>-&gt;</span><span class=na>getPost</span><span class=p>(</span><span class=s1>&#39;email&#39;</span><span class=p>);</span>
<a id=__codelineno-10-16 name=__codelineno-10-16 href=#__codelineno-10-16></a>            <span class=nv>$password</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>request</span><span class=o>-&gt;</span><span class=na>getPost</span><span class=p>(</span><span class=s1>&#39;password&#39;</span><span class=p>);</span>
<a id=__codelineno-10-17 name=__codelineno-10-17 href=#__codelineno-10-17></a>
<a id=__codelineno-10-18 name=__codelineno-10-18 href=#__codelineno-10-18></a>            <span class=sd>/** @var Users|null $user */</span>
<a id=__codelineno-10-19 name=__codelineno-10-19 href=#__codelineno-10-19></a>            <span class=nv>$user</span> <span class=o>=</span> <span class=nx>Users</span><span class=o>::</span><span class=na>findFirst</span><span class=p>([</span>
<a id=__codelineno-10-20 name=__codelineno-10-20 href=#__codelineno-10-20></a>                <span class=s2>&quot;(email = :email: OR username = :email:) AND &quot;</span>
<a id=__codelineno-10-21 name=__codelineno-10-21 href=#__codelineno-10-21></a>                <span class=o>.</span> <span class=s2>&quot;password = :password: AND active = &#39;Y&#39;&quot;</span><span class=p>,</span>
<a id=__codelineno-10-22 name=__codelineno-10-22 href=#__codelineno-10-22></a>                <span class=s1>&#39;bind&#39;</span> <span class=o>=&gt;</span> <span class=p>[</span>
<a id=__codelineno-10-23 name=__codelineno-10-23 href=#__codelineno-10-23></a>                    <span class=s1>&#39;email&#39;</span>    <span class=o>=&gt;</span> <span class=nv>$email</span><span class=p>,</span>
<a id=__codelineno-10-24 name=__codelineno-10-24 href=#__codelineno-10-24></a>                    <span class=s1>&#39;password&#39;</span> <span class=o>=&gt;</span> <span class=nb>sha1</span><span class=p>(</span><span class=nv>$password</span><span class=p>),</span>
<a id=__codelineno-10-25 name=__codelineno-10-25 href=#__codelineno-10-25></a>                <span class=p>],</span>
<a id=__codelineno-10-26 name=__codelineno-10-26 href=#__codelineno-10-26></a>            <span class=p>]);</span>
<a id=__codelineno-10-27 name=__codelineno-10-27 href=#__codelineno-10-27></a>
<a id=__codelineno-10-28 name=__codelineno-10-28 href=#__codelineno-10-28></a>            <span class=k>if</span> <span class=p>(</span><span class=nv>$user</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-10-29 name=__codelineno-10-29 href=#__codelineno-10-29></a>                <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>registerSession</span><span class=p>(</span><span class=nv>$user</span><span class=p>);</span>
<a id=__codelineno-10-30 name=__codelineno-10-30 href=#__codelineno-10-30></a>                <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>flash</span><span class=o>-&gt;</span><span class=na>success</span><span class=p>(</span><span class=s1>&#39;Welcome &#39;</span> <span class=o>.</span> <span class=nv>$user</span><span class=o>-&gt;</span><span class=na>name</span><span class=p>);</span>
<a id=__codelineno-10-31 name=__codelineno-10-31 href=#__codelineno-10-31></a>
<a id=__codelineno-10-32 name=__codelineno-10-32 href=#__codelineno-10-32></a>                <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>dispatcher</span><span class=o>-&gt;</span><span class=na>forward</span><span class=p>(</span>
<a id=__codelineno-10-33 name=__codelineno-10-33 href=#__codelineno-10-33></a>                    <span class=p>[</span>
<a id=__codelineno-10-34 name=__codelineno-10-34 href=#__codelineno-10-34></a>                        <span class=s1>&#39;controller&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;invoices&#39;</span><span class=p>,</span>
<a id=__codelineno-10-35 name=__codelineno-10-35 href=#__codelineno-10-35></a>                        <span class=s1>&#39;action&#39;</span>     <span class=o>=&gt;</span> <span class=s1>&#39;index&#39;</span><span class=p>,</span>
<a id=__codelineno-10-36 name=__codelineno-10-36 href=#__codelineno-10-36></a>                    <span class=p>]</span>
<a id=__codelineno-10-37 name=__codelineno-10-37 href=#__codelineno-10-37></a>                <span class=p>);</span>
<a id=__codelineno-10-38 name=__codelineno-10-38 href=#__codelineno-10-38></a>
<a id=__codelineno-10-39 name=__codelineno-10-39 href=#__codelineno-10-39></a>                <span class=k>return</span><span class=p>;</span>
<a id=__codelineno-10-40 name=__codelineno-10-40 href=#__codelineno-10-40></a>            <span class=p>}</span>
<a id=__codelineno-10-41 name=__codelineno-10-41 href=#__codelineno-10-41></a>
<a id=__codelineno-10-42 name=__codelineno-10-42 href=#__codelineno-10-42></a>            <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>flash</span><span class=o>-&gt;</span><span class=na>error</span><span class=p>(</span><span class=s1>&#39;Wrong email/password&#39;</span><span class=p>);</span>
<a id=__codelineno-10-43 name=__codelineno-10-43 href=#__codelineno-10-43></a>        <span class=p>}</span>
<a id=__codelineno-10-44 name=__codelineno-10-44 href=#__codelineno-10-44></a>
<a id=__codelineno-10-45 name=__codelineno-10-45 href=#__codelineno-10-45></a>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>dispatcher</span><span class=o>-&gt;</span><span class=na>forward</span><span class=p>(</span>
<a id=__codelineno-10-46 name=__codelineno-10-46 href=#__codelineno-10-46></a>            <span class=p>[</span>
<a id=__codelineno-10-47 name=__codelineno-10-47 href=#__codelineno-10-47></a>                <span class=s1>&#39;controller&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;session&#39;</span><span class=p>,</span>
<a id=__codelineno-10-48 name=__codelineno-10-48 href=#__codelineno-10-48></a>                <span class=s1>&#39;action&#39;</span>     <span class=o>=&gt;</span> <span class=s1>&#39;index&#39;</span><span class=p>,</span>
<a id=__codelineno-10-49 name=__codelineno-10-49 href=#__codelineno-10-49></a>            <span class=p>]</span>
<a id=__codelineno-10-50 name=__codelineno-10-50 href=#__codelineno-10-50></a>        <span class=p>);</span>
<a id=__codelineno-10-51 name=__codelineno-10-51 href=#__codelineno-10-51></a>    <span class=p>}</span>
<a id=__codelineno-10-52 name=__codelineno-10-52 href=#__codelineno-10-52></a>
<a id=__codelineno-10-53 name=__codelineno-10-53 href=#__codelineno-10-53></a>    <span class=sd>/**</span>
<a id=__codelineno-10-54 name=__codelineno-10-54 href=#__codelineno-10-54></a><span class=sd>     * Register an authenticated user into session data</span>
<a id=__codelineno-10-55 name=__codelineno-10-55 href=#__codelineno-10-55></a><span class=sd>     *</span>
<a id=__codelineno-10-56 name=__codelineno-10-56 href=#__codelineno-10-56></a><span class=sd>     * @param Users $user</span>
<a id=__codelineno-10-57 name=__codelineno-10-57 href=#__codelineno-10-57></a><span class=sd>     */</span>
<a id=__codelineno-10-58 name=__codelineno-10-58 href=#__codelineno-10-58></a>    <span class=k>private</span> <span class=k>function</span> <span class=nf>registerSession</span><span class=p>(</span><span class=nx>Users</span> <span class=nv>$user</span><span class=p>)</span><span class=o>:</span> <span class=nx>void</span>
<a id=__codelineno-10-59 name=__codelineno-10-59 href=#__codelineno-10-59></a>    <span class=p>{</span>
<a id=__codelineno-10-60 name=__codelineno-10-60 href=#__codelineno-10-60></a>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>session</span><span class=o>-&gt;</span><span class=na>set</span><span class=p>(</span>
<a id=__codelineno-10-61 name=__codelineno-10-61 href=#__codelineno-10-61></a>            <span class=s1>&#39;auth&#39;</span><span class=p>,</span> 
<a id=__codelineno-10-62 name=__codelineno-10-62 href=#__codelineno-10-62></a>            <span class=p>[</span>
<a id=__codelineno-10-63 name=__codelineno-10-63 href=#__codelineno-10-63></a>                <span class=s1>&#39;id&#39;</span>   <span class=o>=&gt;</span> <span class=nv>$user</span><span class=o>-&gt;</span><span class=na>id</span><span class=p>,</span>
<a id=__codelineno-10-64 name=__codelineno-10-64 href=#__codelineno-10-64></a>                <span class=s1>&#39;name&#39;</span> <span class=o>=&gt;</span> <span class=nv>$user</span><span class=o>-&gt;</span><span class=na>name</span><span class=p>,</span>
<a id=__codelineno-10-65 name=__codelineno-10-65 href=#__codelineno-10-65></a>            <span class=p>]</span>
<a id=__codelineno-10-66 name=__codelineno-10-66 href=#__codelineno-10-66></a>        <span class=p>);</span>
<a id=__codelineno-10-67 name=__codelineno-10-67 href=#__codelineno-10-67></a>    <span class=p>}</span>
<a id=__codelineno-10-68 name=__codelineno-10-68 href=#__codelineno-10-68></a><span class=p>}</span>
</code></pre></div> <p>At first inspection of the code, you will note that several public properties are accessed in the controller, such as <code>$this-&gt;flash</code>, <code>$this-&gt;request</code>, or <code>$this-&gt;session</code>. <a href=../controllers/ >Controllers</a> in Phalcon are automatically tied to the <a href=../di/ >Phalcon\Di\Di</a> container and as a result, all the services registered in the container are present in each controller as properties with the same name as the name of each service. If the service is accessed for the first time, it will be automatically instantiated and returned to the caller. Additionally, these services are set as <em>shared</em> so the same instance will be returned, no matter how many times we access the property/service in the same request. These are services defined in the services container from earlier (<code>Providers</code> folder) and you can of course change this behavior when setting up these services.</p> <p>For instance, here we invoke the <code>session</code> service, and then we store the user identity in the variable <code>auth</code>:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a>
<a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>session</span><span class=o>-&gt;</span><span class=na>set</span><span class=p>(</span>
<a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a>    <span class=s1>&#39;auth&#39;</span><span class=p>,</span>
<a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a>    <span class=p>[</span>
<a id=__codelineno-11-6 name=__codelineno-11-6 href=#__codelineno-11-6></a>        <span class=s1>&#39;id&#39;</span>   <span class=o>=&gt;</span> <span class=nv>$user</span><span class=o>-&gt;</span><span class=na>id</span><span class=p>,</span>
<a id=__codelineno-11-7 name=__codelineno-11-7 href=#__codelineno-11-7></a>        <span class=s1>&#39;name&#39;</span> <span class=o>=&gt;</span> <span class=nv>$user</span><span class=o>-&gt;</span><span class=na>name</span><span class=p>,</span>
<a id=__codelineno-11-8 name=__codelineno-11-8 href=#__codelineno-11-8></a>    <span class=p>]</span>
<a id=__codelineno-11-9 name=__codelineno-11-9 href=#__codelineno-11-9></a><span class=p>);</span>
</code></pre></div> <div class="admonition info"> <p class=admonition-title>NOTE</p> <p>For more information about Di services, please check the <a href=../di/ >Dependency Injection</a> document.</p> </div> <p>The <code>startAction</code> first checks if data has been submitted using a <code>POST</code>. If not, the user will be redirected again to the same form. We are checking if the form has been submitted via <code>POST</code> using the <code>isPost()</code> method on the request object.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a>
<a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a><span class=k>if</span> <span class=p>(</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>request</span><span class=o>-&gt;</span><span class=na>isPost</span><span class=p>())</span> <span class=p>{</span>
<a id=__codelineno-12-4 name=__codelineno-12-4 href=#__codelineno-12-4></a>    <span class=c1>// ...</span>
<a id=__codelineno-12-5 name=__codelineno-12-5 href=#__codelineno-12-5></a><span class=p>}</span>
</code></pre></div> <p>We then retrieve posted data from the request. These are the text boxes that are used to submit the form when the user clicks <code>Log In</code>. We use the <code>request</code> object and <code>getPost()</code> method.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a>
<a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a><span class=nv>$email</span>    <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>request</span><span class=o>-&gt;</span><span class=na>getPost</span><span class=p>(</span><span class=s1>&#39;email&#39;</span><span class=p>);</span>
<a id=__codelineno-13-4 name=__codelineno-13-4 href=#__codelineno-13-4></a><span class=nv>$password</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>request</span><span class=o>-&gt;</span><span class=na>getPost</span><span class=p>(</span><span class=s1>&#39;password&#39;</span><span class=p>);</span>
</code></pre></div> <p>Now, we have to check if we have an active user with the submitted email and password:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a>
<a id=__codelineno-14-3 name=__codelineno-14-3 href=#__codelineno-14-3></a><span class=nv>$user</span> <span class=o>=</span> <span class=nx>Users</span><span class=o>::</span><span class=na>findFirst</span><span class=p>(</span>
<a id=__codelineno-14-4 name=__codelineno-14-4 href=#__codelineno-14-4></a>    <span class=p>[</span>
<a id=__codelineno-14-5 name=__codelineno-14-5 href=#__codelineno-14-5></a>        <span class=s2>&quot;(email = :email: OR username = :email:) &quot;</span> <span class=o>.</span>
<a id=__codelineno-14-6 name=__codelineno-14-6 href=#__codelineno-14-6></a>        <span class=s2>&quot;AND password = :password: &quot;</span> <span class=o>.</span>
<a id=__codelineno-14-7 name=__codelineno-14-7 href=#__codelineno-14-7></a>        <span class=s2>&quot;AND active = &#39;Y&#39;&quot;</span><span class=p>,</span>
<a id=__codelineno-14-8 name=__codelineno-14-8 href=#__codelineno-14-8></a>        <span class=s1>&#39;bind&#39;</span> <span class=o>=&gt;</span> <span class=p>[</span>
<a id=__codelineno-14-9 name=__codelineno-14-9 href=#__codelineno-14-9></a>            <span class=s1>&#39;email&#39;</span>    <span class=o>=&gt;</span> <span class=nv>$email</span><span class=p>,</span>
<a id=__codelineno-14-10 name=__codelineno-14-10 href=#__codelineno-14-10></a>            <span class=s1>&#39;password&#39;</span> <span class=o>=&gt;</span> <span class=nb>sha1</span><span class=p>(</span><span class=nv>$password</span><span class=p>),</span>
<a id=__codelineno-14-11 name=__codelineno-14-11 href=#__codelineno-14-11></a>        <span class=p>]</span>
<a id=__codelineno-14-12 name=__codelineno-14-12 href=#__codelineno-14-12></a>    <span class=p>]</span>
<a id=__codelineno-14-13 name=__codelineno-14-13 href=#__codelineno-14-13></a><span class=p>);</span>
</code></pre></div> <div class="admonition info"> <p class=admonition-title>NOTE</p> <p>Note, the use of 'bound parameters', placeholders <code>:email:</code> and <code>:password:</code> are placed where values should be, then the values are <em>bound</em> using the parameter <code>bind</code>. This safely replaces the values for those columns without the risk of a SQL injection.</p> </div> <p>When searching for the user in the database, we are not searching for the password directly using clear text. The application stores passwords as hashes, using the <a href=https://php.net/manual/en/function.sha1.php>sha1</a> method. Although this methodology is adequate for a tutorial, you might want to consider using a different algorithm for a production application. The <a href=../encryption-security/ >Phalcon\Encryption\Security</a> component offers convenience methods to strengthen the algorithm used for your hashes.</p> <p>If the user is found, then we register the user in the session (log the user in) and forward them to the dashboard (<code>Invoices</code> controller, <code>index</code> action) showing a welcome message.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-15-2 name=__codelineno-15-2 href=#__codelineno-15-2></a>
<a id=__codelineno-15-3 name=__codelineno-15-3 href=#__codelineno-15-3></a><span class=k>if</span> <span class=p>(</span><span class=nv>$user</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-15-4 name=__codelineno-15-4 href=#__codelineno-15-4></a>    <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>registerSession</span><span class=p>(</span><span class=nv>$user</span><span class=p>);</span>
<a id=__codelineno-15-5 name=__codelineno-15-5 href=#__codelineno-15-5></a>    <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>flash</span><span class=o>-&gt;</span><span class=na>success</span><span class=p>(</span><span class=s1>&#39;Welcome &#39;</span> <span class=o>.</span> <span class=nv>$user</span><span class=o>-&gt;</span><span class=na>name</span><span class=p>);</span>
<a id=__codelineno-15-6 name=__codelineno-15-6 href=#__codelineno-15-6></a>
<a id=__codelineno-15-7 name=__codelineno-15-7 href=#__codelineno-15-7></a>    <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>dispatcher</span><span class=o>-&gt;</span><span class=na>forward</span><span class=p>([</span>
<a id=__codelineno-15-8 name=__codelineno-15-8 href=#__codelineno-15-8></a>        <span class=s1>&#39;controller&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;invoices&#39;</span><span class=p>,</span>
<a id=__codelineno-15-9 name=__codelineno-15-9 href=#__codelineno-15-9></a>        <span class=s1>&#39;action&#39;</span>     <span class=o>=&gt;</span> <span class=s1>&#39;index&#39;</span><span class=p>,</span>
<a id=__codelineno-15-10 name=__codelineno-15-10 href=#__codelineno-15-10></a>    <span class=p>]);</span>
<a id=__codelineno-15-11 name=__codelineno-15-11 href=#__codelineno-15-11></a>
<a id=__codelineno-15-12 name=__codelineno-15-12 href=#__codelineno-15-12></a>    <span class=k>return</span><span class=p>;</span>
<a id=__codelineno-15-13 name=__codelineno-15-13 href=#__codelineno-15-13></a><span class=p>}</span>
</code></pre></div> <p>If the user is not found, we forward them to the login page with a <code>Wrong email/password</code> message on the screen.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-16-2 name=__codelineno-16-2 href=#__codelineno-16-2></a>
<a id=__codelineno-16-3 name=__codelineno-16-3 href=#__codelineno-16-3></a><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>dispatcher</span><span class=o>-&gt;</span><span class=na>forward</span><span class=p>(</span>
<a id=__codelineno-16-4 name=__codelineno-16-4 href=#__codelineno-16-4></a>    <span class=p>[</span>
<a id=__codelineno-16-5 name=__codelineno-16-5 href=#__codelineno-16-5></a>        <span class=s1>&#39;controller&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;session&#39;</span><span class=p>,</span>
<a id=__codelineno-16-6 name=__codelineno-16-6 href=#__codelineno-16-6></a>        <span class=s1>&#39;action&#39;</span>     <span class=o>=&gt;</span> <span class=s1>&#39;index&#39;</span><span class=p>,</span>
<a id=__codelineno-16-7 name=__codelineno-16-7 href=#__codelineno-16-7></a>    <span class=p>]</span>
<a id=__codelineno-16-8 name=__codelineno-16-8 href=#__codelineno-16-8></a><span class=p>);</span>
</code></pre></div> <h2 id=backend-security>Backend Security<a class=headerlink href=#backend-security title="Permanent link">&para;</a></h2> <p>The backend is a private area where only registered users have access. Therefore, it is necessary to check that only registered users have access to these controllers. If you are not logged in and try to access a <em>private</em> area you will see a message like the one below:</p> <p>Every time a user attempts to access any controller/action, the application verifies that the current role (stored in the session) has access to it, otherwise it displays a message as shown above and forwards the flow to the home page.</p> <p>In order to accomplish this, we need to use the <a href=../dispatcher/ >Dispatcher</a> component. When the user requests a page or URL, the application first identifies the page requested using the <a href=../routing/ >Route</a> component. Once the route has been identified and matched to a valid controller and action, this information is delegated to the <a href=../dispatcher/ >Dispatcher</a> which then loads the controller and executes the action.</p> <p>Normally, the framework creates the Dispatcher automatically. In our case, we need to verify that the user is logged in before the route is dispatched. As such we need to replace the default component in the DI container and set a new one in (<code>Providers\DispatchProvider.php</code>). We do this when bootstrapping the application:</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-17-2 name=__codelineno-17-2 href=#__codelineno-17-2></a>
<a id=__codelineno-17-3 name=__codelineno-17-3 href=#__codelineno-17-3></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Dispatcher</span><span class=p>;</span>
<a id=__codelineno-17-4 name=__codelineno-17-4 href=#__codelineno-17-4></a>
<a id=__codelineno-17-5 name=__codelineno-17-5 href=#__codelineno-17-5></a><span class=c1>// ...</span>
<a id=__codelineno-17-6 name=__codelineno-17-6 href=#__codelineno-17-6></a><span class=nv>$di</span><span class=o>-&gt;</span><span class=na>setShared</span><span class=p>(</span>
<a id=__codelineno-17-7 name=__codelineno-17-7 href=#__codelineno-17-7></a>    <span class=s1>&#39;dispatcher&#39;</span><span class=p>,</span> 
<a id=__codelineno-17-8 name=__codelineno-17-8 href=#__codelineno-17-8></a>    <span class=k>function</span> <span class=p>()</span> <span class=p>{</span>
<a id=__codelineno-17-9 name=__codelineno-17-9 href=#__codelineno-17-9></a>        <span class=c1>// ...</span>
<a id=__codelineno-17-10 name=__codelineno-17-10 href=#__codelineno-17-10></a>        <span class=nv>$dispatcher</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Dispatcher</span><span class=p>();</span>
<a id=__codelineno-17-11 name=__codelineno-17-11 href=#__codelineno-17-11></a>        <span class=nv>$dispatcher</span><span class=o>-&gt;</span><span class=na>setDefaultNamespace</span><span class=p>(</span><span class=s1>&#39;Invo\Controllers&#39;</span><span class=p>);</span>
<a id=__codelineno-17-12 name=__codelineno-17-12 href=#__codelineno-17-12></a>        <span class=c1>// ...</span>
<a id=__codelineno-17-13 name=__codelineno-17-13 href=#__codelineno-17-13></a>
<a id=__codelineno-17-14 name=__codelineno-17-14 href=#__codelineno-17-14></a>        <span class=k>return</span> <span class=nv>$dispatcher</span><span class=p>;</span>
<a id=__codelineno-17-15 name=__codelineno-17-15 href=#__codelineno-17-15></a>    <span class=p>}</span>
<a id=__codelineno-17-16 name=__codelineno-17-16 href=#__codelineno-17-16></a><span class=p>);</span>
</code></pre></div> Now that the dispatcher is registered, we need to take advantage of a <em>hook</em> available to intercept the flow of execution and perform our verification checks. Hooks are called Events in Phalcon and in order to access or enable them, we need to register an [Events Manager][events] component in our application so that it can <em>fire</em> those events in our application.</p> <p>By creating an [Events Manager][events] and attaching specific code to the <code>dispatcher</code> events, we now have a lot more flexibility and can attach our code to the dispatch loop or operation.</p> <h3 id=events>Events<a class=headerlink href=#events title="Permanent link">&para;</a></h3> <p>The [Events Manager][events] allows us to attach listeners to a particular type of event. The event type that we are attaching to is <code>dispatch</code>. The code below attaches listeners to the <code>beforeExecuteRoute</code> and <code>beforeException</code> events. We utilize these events to check for 404 pages and also perform allowed access checks in our application.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-18-2 name=__codelineno-18-2 href=#__codelineno-18-2></a>
<a id=__codelineno-18-3 name=__codelineno-18-3 href=#__codelineno-18-3></a><span class=k>use</span> <span class=nx>Invo\Plugins\NotFoundPlugin</span><span class=p>;</span>
<a id=__codelineno-18-4 name=__codelineno-18-4 href=#__codelineno-18-4></a><span class=k>use</span> <span class=nx>Invo\Plugins\SecurityPlugin</span><span class=p>;</span>
<a id=__codelineno-18-5 name=__codelineno-18-5 href=#__codelineno-18-5></a><span class=k>use</span> <span class=nx>Phalcon\Events\Manager</span> <span class=k>as</span> <span class=nx>EventsManager</span><span class=p>;</span>
<a id=__codelineno-18-6 name=__codelineno-18-6 href=#__codelineno-18-6></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Dispatcher</span><span class=p>;</span>
<a id=__codelineno-18-7 name=__codelineno-18-7 href=#__codelineno-18-7></a>
<a id=__codelineno-18-8 name=__codelineno-18-8 href=#__codelineno-18-8></a><span class=nv>$di</span><span class=o>-&gt;</span><span class=na>setShared</span><span class=p>(</span>
<a id=__codelineno-18-9 name=__codelineno-18-9 href=#__codelineno-18-9></a>    <span class=s1>&#39;dispatcher&#39;</span><span class=p>,</span> 
<a id=__codelineno-18-10 name=__codelineno-18-10 href=#__codelineno-18-10></a>    <span class=k>function</span> <span class=p>()</span> <span class=p>{</span>
<a id=__codelineno-18-11 name=__codelineno-18-11 href=#__codelineno-18-11></a>        <span class=nv>$eventsManager</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>EventsManager</span><span class=p>();</span>
<a id=__codelineno-18-12 name=__codelineno-18-12 href=#__codelineno-18-12></a>
<a id=__codelineno-18-13 name=__codelineno-18-13 href=#__codelineno-18-13></a>        <span class=sd>/**</span>
<a id=__codelineno-18-14 name=__codelineno-18-14 href=#__codelineno-18-14></a><span class=sd>         * Check if the user is allowed to access certain actions using </span>
<a id=__codelineno-18-15 name=__codelineno-18-15 href=#__codelineno-18-15></a><span class=sd>         * the SecurityPlugin</span>
<a id=__codelineno-18-16 name=__codelineno-18-16 href=#__codelineno-18-16></a><span class=sd>         */</span>
<a id=__codelineno-18-17 name=__codelineno-18-17 href=#__codelineno-18-17></a>        <span class=nv>$eventsManager</span><span class=o>-&gt;</span><span class=na>attach</span><span class=p>(</span>
<a id=__codelineno-18-18 name=__codelineno-18-18 href=#__codelineno-18-18></a>            <span class=s1>&#39;dispatch:beforeExecuteRoute&#39;</span><span class=p>,</span> 
<a id=__codelineno-18-19 name=__codelineno-18-19 href=#__codelineno-18-19></a>            <span class=k>new</span> <span class=nx>SecurityPlugin</span><span class=p>()</span>
<a id=__codelineno-18-20 name=__codelineno-18-20 href=#__codelineno-18-20></a>        <span class=p>);</span>
<a id=__codelineno-18-21 name=__codelineno-18-21 href=#__codelineno-18-21></a>
<a id=__codelineno-18-22 name=__codelineno-18-22 href=#__codelineno-18-22></a>        <span class=sd>/**</span>
<a id=__codelineno-18-23 name=__codelineno-18-23 href=#__codelineno-18-23></a><span class=sd>         * Handle exceptions and not-found exceptions using NotFoundPlugin</span>
<a id=__codelineno-18-24 name=__codelineno-18-24 href=#__codelineno-18-24></a><span class=sd>         */</span>
<a id=__codelineno-18-25 name=__codelineno-18-25 href=#__codelineno-18-25></a>        <span class=nv>$eventsManager</span><span class=o>-&gt;</span><span class=na>attach</span><span class=p>(</span>
<a id=__codelineno-18-26 name=__codelineno-18-26 href=#__codelineno-18-26></a>            <span class=s1>&#39;dispatch:beforeException&#39;</span><span class=p>,</span> 
<a id=__codelineno-18-27 name=__codelineno-18-27 href=#__codelineno-18-27></a>            <span class=k>new</span> <span class=nx>NotFoundPlugin</span><span class=p>()</span>
<a id=__codelineno-18-28 name=__codelineno-18-28 href=#__codelineno-18-28></a>        <span class=p>);</span>
<a id=__codelineno-18-29 name=__codelineno-18-29 href=#__codelineno-18-29></a>
<a id=__codelineno-18-30 name=__codelineno-18-30 href=#__codelineno-18-30></a>        <span class=nv>$dispatcher</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Dispatcher</span><span class=p>();</span>
<a id=__codelineno-18-31 name=__codelineno-18-31 href=#__codelineno-18-31></a>        <span class=nv>$dispatcher</span><span class=o>-&gt;</span><span class=na>setDefaultNamespace</span><span class=p>(</span><span class=s1>&#39;Invo\Controllers&#39;</span><span class=p>);</span>
<a id=__codelineno-18-32 name=__codelineno-18-32 href=#__codelineno-18-32></a>        <span class=nv>$dispatcher</span><span class=o>-&gt;</span><span class=na>setEventsManager</span><span class=p>(</span><span class=nv>$eventsManager</span><span class=p>);</span>
<a id=__codelineno-18-33 name=__codelineno-18-33 href=#__codelineno-18-33></a>
<a id=__codelineno-18-34 name=__codelineno-18-34 href=#__codelineno-18-34></a>        <span class=k>return</span> <span class=nv>$dispatcher</span><span class=p>;</span>
<a id=__codelineno-18-35 name=__codelineno-18-35 href=#__codelineno-18-35></a>    <span class=p>}</span>
<a id=__codelineno-18-36 name=__codelineno-18-36 href=#__codelineno-18-36></a><span class=p>);</span>
</code></pre></div> <p>When an event called <code>beforeExecuteRoute</code> is triggered the <code>SecurityPlugin</code> plugin will be notified:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-19-2 name=__codelineno-19-2 href=#__codelineno-19-2></a>
<a id=__codelineno-19-3 name=__codelineno-19-3 href=#__codelineno-19-3></a><span class=nv>$eventsManager</span><span class=o>-&gt;</span><span class=na>attach</span><span class=p>(</span>
<a id=__codelineno-19-4 name=__codelineno-19-4 href=#__codelineno-19-4></a>    <span class=s1>&#39;dispatch:beforeExecuteRoute&#39;</span><span class=p>,</span>
<a id=__codelineno-19-5 name=__codelineno-19-5 href=#__codelineno-19-5></a>    <span class=k>new</span> <span class=nx>SecurityPlugin</span><span class=p>()</span>
<a id=__codelineno-19-6 name=__codelineno-19-6 href=#__codelineno-19-6></a><span class=p>);</span>
</code></pre></div> <p>When a <code>beforeException</code> is triggered then the <code>NotFoundPlugin</code> is notified:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-20-1 name=__codelineno-20-1 href=#__codelineno-20-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-20-2 name=__codelineno-20-2 href=#__codelineno-20-2></a>
<a id=__codelineno-20-3 name=__codelineno-20-3 href=#__codelineno-20-3></a><span class=nv>$eventsManager</span><span class=o>-&gt;</span><span class=na>attach</span><span class=p>(</span>
<a id=__codelineno-20-4 name=__codelineno-20-4 href=#__codelineno-20-4></a>    <span class=s1>&#39;dispatch:beforeException&#39;</span><span class=p>,</span>
<a id=__codelineno-20-5 name=__codelineno-20-5 href=#__codelineno-20-5></a>    <span class=k>new</span> <span class=nx>NotFoundPlugin</span><span class=p>()</span>
<a id=__codelineno-20-6 name=__codelineno-20-6 href=#__codelineno-20-6></a><span class=p>);</span>
</code></pre></div> <p><code>SecurityPlugin</code> is a class located in the <code>Plugins</code> directory (<code>src/Plugins/SecurityPlugin.php</code>). This class implements the method <code>beforeExecuteRoute</code>. This is the same name as one of the events produced in the Dispatcher:</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-21-1 name=__codelineno-21-1 href=#__codelineno-21-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-21-2 name=__codelineno-21-2 href=#__codelineno-21-2></a>
<a id=__codelineno-21-3 name=__codelineno-21-3 href=#__codelineno-21-3></a><span class=k>use</span> <span class=nx>Phalcon\Di\Injectable</span><span class=p>;</span>
<a id=__codelineno-21-4 name=__codelineno-21-4 href=#__codelineno-21-4></a><span class=k>use</span> <span class=nx>Phalcon\Events\Event</span><span class=p>;</span>
<a id=__codelineno-21-5 name=__codelineno-21-5 href=#__codelineno-21-5></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Dispatcher</span><span class=p>;</span>
<a id=__codelineno-21-6 name=__codelineno-21-6 href=#__codelineno-21-6></a>
<a id=__codelineno-21-7 name=__codelineno-21-7 href=#__codelineno-21-7></a><span class=k>class</span> <span class=nc>SecurityPlugin</span> <span class=k>extends</span> <span class=nx>Injectable</span>
<a id=__codelineno-21-8 name=__codelineno-21-8 href=#__codelineno-21-8></a><span class=p>{</span>
<a id=__codelineno-21-9 name=__codelineno-21-9 href=#__codelineno-21-9></a>    <span class=c1>// ...</span>
<a id=__codelineno-21-10 name=__codelineno-21-10 href=#__codelineno-21-10></a>
<a id=__codelineno-21-11 name=__codelineno-21-11 href=#__codelineno-21-11></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>beforeExecuteRoute</span><span class=p>(</span>
<a id=__codelineno-21-12 name=__codelineno-21-12 href=#__codelineno-21-12></a>        <span class=nx>Event</span> <span class=nv>$event</span><span class=p>,</span> 
<a id=__codelineno-21-13 name=__codelineno-21-13 href=#__codelineno-21-13></a>        <span class=nx>Dispatcher</span> <span class=nv>$containerspatcher</span>
<a id=__codelineno-21-14 name=__codelineno-21-14 href=#__codelineno-21-14></a>    <span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-21-15 name=__codelineno-21-15 href=#__codelineno-21-15></a>        <span class=c1>// ...</span>
<a id=__codelineno-21-16 name=__codelineno-21-16 href=#__codelineno-21-16></a>    <span class=p>}</span>
<a id=__codelineno-21-17 name=__codelineno-21-17 href=#__codelineno-21-17></a><span class=p>}</span>
</code></pre></div> The event methods always receive the actual event as the first parameter. This is a <a href=../api/phalcon_events/#eventsevent->Phalcon\Events\Event</a> object which will contain information regarding the event such as its type and other related information. For this particular event, the second parameter will be the object that produced the event itself (<code>$containerspatcher</code>). It is not mandatory that plugin classes extend the class <a href=../api/phalcon_di/#diinjectable-->Phalcon\Di\Injectable</a>, but by doing this they gain easier access to the services available in the application.</p> <p>We now have the structure to start verifying the role in the current session. We can check if the user has access to the [ACL][acl]. If the user does not have access, we will redirect them to the home screen.</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-22-1 name=__codelineno-22-1 href=#__codelineno-22-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-22-2 name=__codelineno-22-2 href=#__codelineno-22-2></a>
<a id=__codelineno-22-3 name=__codelineno-22-3 href=#__codelineno-22-3></a><span class=k>use</span> <span class=nx>Phalcon\Di\Injectable</span><span class=p>;</span>
<a id=__codelineno-22-4 name=__codelineno-22-4 href=#__codelineno-22-4></a><span class=k>use</span> <span class=nx>Phalcon\Events\Event</span><span class=p>;</span>
<a id=__codelineno-22-5 name=__codelineno-22-5 href=#__codelineno-22-5></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Dispatcher</span><span class=p>;</span>
<a id=__codelineno-22-6 name=__codelineno-22-6 href=#__codelineno-22-6></a>
<a id=__codelineno-22-7 name=__codelineno-22-7 href=#__codelineno-22-7></a><span class=k>class</span> <span class=nc>SecurityPlugin</span> <span class=k>extends</span> <span class=nx>Plugin</span>
<a id=__codelineno-22-8 name=__codelineno-22-8 href=#__codelineno-22-8></a><span class=p>{</span>
<a id=__codelineno-22-9 name=__codelineno-22-9 href=#__codelineno-22-9></a>    <span class=c1>// ...</span>
<a id=__codelineno-22-10 name=__codelineno-22-10 href=#__codelineno-22-10></a>
<a id=__codelineno-22-11 name=__codelineno-22-11 href=#__codelineno-22-11></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>beforeExecuteRoute</span><span class=p>(</span>
<a id=__codelineno-22-12 name=__codelineno-22-12 href=#__codelineno-22-12></a>        <span class=nx>Event</span> <span class=nv>$event</span><span class=p>,</span> 
<a id=__codelineno-22-13 name=__codelineno-22-13 href=#__codelineno-22-13></a>        <span class=nx>Dispatcher</span> <span class=nv>$containerspatcher</span>
<a id=__codelineno-22-14 name=__codelineno-22-14 href=#__codelineno-22-14></a>    <span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-22-15 name=__codelineno-22-15 href=#__codelineno-22-15></a>        <span class=nv>$auth</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>session</span><span class=o>-&gt;</span><span class=na>get</span><span class=p>(</span><span class=s1>&#39;auth&#39;</span><span class=p>);</span>
<a id=__codelineno-22-16 name=__codelineno-22-16 href=#__codelineno-22-16></a>        <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nv>$auth</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-22-17 name=__codelineno-22-17 href=#__codelineno-22-17></a>            <span class=nv>$role</span> <span class=o>=</span> <span class=s1>&#39;Guests&#39;</span><span class=p>;</span>
<a id=__codelineno-22-18 name=__codelineno-22-18 href=#__codelineno-22-18></a>        <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
<a id=__codelineno-22-19 name=__codelineno-22-19 href=#__codelineno-22-19></a>            <span class=nv>$role</span> <span class=o>=</span> <span class=s1>&#39;Users&#39;</span><span class=p>;</span>
<a id=__codelineno-22-20 name=__codelineno-22-20 href=#__codelineno-22-20></a>        <span class=p>}</span>
<a id=__codelineno-22-21 name=__codelineno-22-21 href=#__codelineno-22-21></a>
<a id=__codelineno-22-22 name=__codelineno-22-22 href=#__codelineno-22-22></a>        <span class=nv>$controller</span> <span class=o>=</span> <span class=nv>$dispatcher</span><span class=o>-&gt;</span><span class=na>getControllerName</span><span class=p>();</span>
<a id=__codelineno-22-23 name=__codelineno-22-23 href=#__codelineno-22-23></a>        <span class=nv>$action</span>     <span class=o>=</span> <span class=nv>$dispatcher</span><span class=o>-&gt;</span><span class=na>getActionName</span><span class=p>();</span>
<a id=__codelineno-22-24 name=__codelineno-22-24 href=#__codelineno-22-24></a>
<a id=__codelineno-22-25 name=__codelineno-22-25 href=#__codelineno-22-25></a>        <span class=nv>$acl</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>getAcl</span><span class=p>();</span>
<a id=__codelineno-22-26 name=__codelineno-22-26 href=#__codelineno-22-26></a>
<a id=__codelineno-22-27 name=__codelineno-22-27 href=#__codelineno-22-27></a>        <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nv>$acl</span><span class=o>-&gt;</span><span class=na>isComponent</span><span class=p>(</span><span class=nv>$controller</span><span class=p>))</span> <span class=p>{</span>
<a id=__codelineno-22-28 name=__codelineno-22-28 href=#__codelineno-22-28></a>            <span class=nv>$dispatcher</span><span class=o>-&gt;</span><span class=na>forward</span><span class=p>(</span>
<a id=__codelineno-22-29 name=__codelineno-22-29 href=#__codelineno-22-29></a>                <span class=p>[</span>
<a id=__codelineno-22-30 name=__codelineno-22-30 href=#__codelineno-22-30></a>                    <span class=s1>&#39;controller&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;errors&#39;</span><span class=p>,</span>
<a id=__codelineno-22-31 name=__codelineno-22-31 href=#__codelineno-22-31></a>                    <span class=s1>&#39;action&#39;</span>     <span class=o>=&gt;</span> <span class=s1>&#39;show404&#39;</span><span class=p>,</span>
<a id=__codelineno-22-32 name=__codelineno-22-32 href=#__codelineno-22-32></a>                <span class=p>]</span>
<a id=__codelineno-22-33 name=__codelineno-22-33 href=#__codelineno-22-33></a>            <span class=p>);</span>
<a id=__codelineno-22-34 name=__codelineno-22-34 href=#__codelineno-22-34></a>
<a id=__codelineno-22-35 name=__codelineno-22-35 href=#__codelineno-22-35></a>            <span class=k>return</span> <span class=k>false</span><span class=p>;</span>
<a id=__codelineno-22-36 name=__codelineno-22-36 href=#__codelineno-22-36></a>        <span class=p>}</span>
<a id=__codelineno-22-37 name=__codelineno-22-37 href=#__codelineno-22-37></a>
<a id=__codelineno-22-38 name=__codelineno-22-38 href=#__codelineno-22-38></a>        <span class=nv>$allowed</span> <span class=o>=</span> <span class=nv>$acl</span><span class=o>-&gt;</span><span class=na>isAllowed</span><span class=p>(</span><span class=nv>$role</span><span class=p>,</span> <span class=nv>$controller</span><span class=p>,</span> <span class=nv>$action</span><span class=p>);</span>
<a id=__codelineno-22-39 name=__codelineno-22-39 href=#__codelineno-22-39></a>        <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nv>$allowed</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-22-40 name=__codelineno-22-40 href=#__codelineno-22-40></a>            <span class=nv>$dispatcher</span><span class=o>-&gt;</span><span class=na>forward</span><span class=p>(</span>
<a id=__codelineno-22-41 name=__codelineno-22-41 href=#__codelineno-22-41></a>                <span class=p>[</span>
<a id=__codelineno-22-42 name=__codelineno-22-42 href=#__codelineno-22-42></a>                    <span class=s1>&#39;controller&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;errors&#39;</span><span class=p>,</span>
<a id=__codelineno-22-43 name=__codelineno-22-43 href=#__codelineno-22-43></a>                    <span class=s1>&#39;action&#39;</span>     <span class=o>=&gt;</span> <span class=s1>&#39;show401&#39;</span><span class=p>,</span>
<a id=__codelineno-22-44 name=__codelineno-22-44 href=#__codelineno-22-44></a>                <span class=p>]</span>
<a id=__codelineno-22-45 name=__codelineno-22-45 href=#__codelineno-22-45></a>            <span class=p>);</span>
<a id=__codelineno-22-46 name=__codelineno-22-46 href=#__codelineno-22-46></a>
<a id=__codelineno-22-47 name=__codelineno-22-47 href=#__codelineno-22-47></a>            <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>session</span><span class=o>-&gt;</span><span class=na>destroy</span><span class=p>();</span>
<a id=__codelineno-22-48 name=__codelineno-22-48 href=#__codelineno-22-48></a>
<a id=__codelineno-22-49 name=__codelineno-22-49 href=#__codelineno-22-49></a>            <span class=k>return</span> <span class=k>false</span><span class=p>;</span>
<a id=__codelineno-22-50 name=__codelineno-22-50 href=#__codelineno-22-50></a>        <span class=p>}</span>
<a id=__codelineno-22-51 name=__codelineno-22-51 href=#__codelineno-22-51></a>
<a id=__codelineno-22-52 name=__codelineno-22-52 href=#__codelineno-22-52></a>        <span class=k>return</span> <span class=k>true</span><span class=p>;</span>
<a id=__codelineno-22-53 name=__codelineno-22-53 href=#__codelineno-22-53></a>    <span class=p>}</span>
<a id=__codelineno-22-54 name=__codelineno-22-54 href=#__codelineno-22-54></a><span class=p>}</span>
</code></pre></div> We first get the <code>auth</code> value from the <code>session</code> service. If we are logged in, then this has been already set for us during the login process. If not, we are just a guest.</p> <p>Following that, we get the name of the controller and the action, and also retrieve the Access Control List (ACL). We check if the user <code>isAllowed</code> using the combination <code>role</code> - <code>controller</code> - <code>action</code>. If yes, the method will finish processing.</p> <p>If we do not have access, then the method will return <code>false</code> stopping the execution, right after we forward the user to the home page.</p> <h3 id=acl>ACL<a class=headerlink href=#acl title="Permanent link">&para;</a></h3> <p>In the above example, we have obtained the ACL using the method <code>$this-&gt;getAcl()</code>. To build the ACL we need to do the following:</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-23-1 name=__codelineno-23-1 href=#__codelineno-23-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-23-2 name=__codelineno-23-2 href=#__codelineno-23-2></a>
<a id=__codelineno-23-3 name=__codelineno-23-3 href=#__codelineno-23-3></a><span class=k>use</span> <span class=nx>Phalcon\Acl\Enum</span><span class=p>;</span>
<a id=__codelineno-23-4 name=__codelineno-23-4 href=#__codelineno-23-4></a><span class=k>use</span> <span class=nx>Phalcon\Acl\Role</span><span class=p>;</span>
<a id=__codelineno-23-5 name=__codelineno-23-5 href=#__codelineno-23-5></a><span class=k>use</span> <span class=nx>Phalcon\Acl\Adapter\Memory</span> <span class=k>as</span> <span class=nx>AclList</span><span class=p>;</span>
<a id=__codelineno-23-6 name=__codelineno-23-6 href=#__codelineno-23-6></a>
<a id=__codelineno-23-7 name=__codelineno-23-7 href=#__codelineno-23-7></a><span class=nv>$acl</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>AclList</span><span class=p>();</span>
<a id=__codelineno-23-8 name=__codelineno-23-8 href=#__codelineno-23-8></a>
<a id=__codelineno-23-9 name=__codelineno-23-9 href=#__codelineno-23-9></a><span class=nv>$acl</span><span class=o>-&gt;</span><span class=na>setDefaultAction</span><span class=p>(</span><span class=nx>Enum</span><span class=o>::</span><span class=na>DENY</span><span class=p>);</span>
<a id=__codelineno-23-10 name=__codelineno-23-10 href=#__codelineno-23-10></a>
<a id=__codelineno-23-11 name=__codelineno-23-11 href=#__codelineno-23-11></a><span class=nv>$roles</span> <span class=o>=</span> <span class=p>[</span>
<a id=__codelineno-23-12 name=__codelineno-23-12 href=#__codelineno-23-12></a>    <span class=s1>&#39;users&#39;</span>  <span class=o>=&gt;</span> <span class=k>new</span> <span class=nx>Role</span><span class=p>(</span>
<a id=__codelineno-23-13 name=__codelineno-23-13 href=#__codelineno-23-13></a>        <span class=s1>&#39;Users&#39;</span><span class=p>,</span>
<a id=__codelineno-23-14 name=__codelineno-23-14 href=#__codelineno-23-14></a>        <span class=s1>&#39;Member privileges, granted after sign-in.&#39;</span>
<a id=__codelineno-23-15 name=__codelineno-23-15 href=#__codelineno-23-15></a>    <span class=p>),</span>
<a id=__codelineno-23-16 name=__codelineno-23-16 href=#__codelineno-23-16></a>    <span class=s1>&#39;guests&#39;</span> <span class=o>=&gt;</span> <span class=k>new</span> <span class=nx>Role</span><span class=p>(</span>
<a id=__codelineno-23-17 name=__codelineno-23-17 href=#__codelineno-23-17></a>        <span class=s1>&#39;Guests&#39;</span><span class=p>,</span>
<a id=__codelineno-23-18 name=__codelineno-23-18 href=#__codelineno-23-18></a>        <span class=s1>&#39;Anyone browsing the site who is not signed in is considered to be a &quot;Guest&quot;.&#39;</span>
<a id=__codelineno-23-19 name=__codelineno-23-19 href=#__codelineno-23-19></a>    <span class=p>)</span>
<a id=__codelineno-23-20 name=__codelineno-23-20 href=#__codelineno-23-20></a><span class=p>];</span>
<a id=__codelineno-23-21 name=__codelineno-23-21 href=#__codelineno-23-21></a>
<a id=__codelineno-23-22 name=__codelineno-23-22 href=#__codelineno-23-22></a><span class=k>foreach</span> <span class=p>(</span><span class=nv>$roles</span> <span class=k>as</span> <span class=nv>$role</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-23-23 name=__codelineno-23-23 href=#__codelineno-23-23></a>    <span class=nv>$acl</span><span class=o>-&gt;</span><span class=na>addRole</span><span class=p>(</span><span class=nv>$role</span><span class=p>);</span>
<a id=__codelineno-23-24 name=__codelineno-23-24 href=#__codelineno-23-24></a><span class=p>}</span>
</code></pre></div> First, we create a new <code>Phalcon\Acl\Adapter\Memory</code> object. Although the default access is <code>DENY</code> we still set it in our list by using <code>setDefaultAction()</code>. After that, we need to set up our roles. For INVO we have <code>guests</code> (users that have not been logged in) and <code>users</code>. We register those roles by using <code>addRole</code> on the list.</p> <p>Now that the roles are set, we need to set the components for the list. ACL components map to the areas of our application (controller/action). Doing so we can control which role can access which component.</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-24-1 name=__codelineno-24-1 href=#__codelineno-24-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-24-2 name=__codelineno-24-2 href=#__codelineno-24-2></a>
<a id=__codelineno-24-3 name=__codelineno-24-3 href=#__codelineno-24-3></a><span class=k>use</span> <span class=nx>Phalcon\Acl\Component</span><span class=p>;</span>
<a id=__codelineno-24-4 name=__codelineno-24-4 href=#__codelineno-24-4></a>
<a id=__codelineno-24-5 name=__codelineno-24-5 href=#__codelineno-24-5></a><span class=c1>// ...</span>
<a id=__codelineno-24-6 name=__codelineno-24-6 href=#__codelineno-24-6></a>
<a id=__codelineno-24-7 name=__codelineno-24-7 href=#__codelineno-24-7></a><span class=nv>$privateComponents</span> <span class=o>=</span> <span class=p>[</span>
<a id=__codelineno-24-8 name=__codelineno-24-8 href=#__codelineno-24-8></a>    <span class=s1>&#39;companies&#39;</span>    <span class=o>=&gt;</span> <span class=p>[</span>
<a id=__codelineno-24-9 name=__codelineno-24-9 href=#__codelineno-24-9></a>        <span class=s1>&#39;index&#39;</span><span class=p>,</span> 
<a id=__codelineno-24-10 name=__codelineno-24-10 href=#__codelineno-24-10></a>        <span class=s1>&#39;search&#39;</span><span class=p>,</span> 
<a id=__codelineno-24-11 name=__codelineno-24-11 href=#__codelineno-24-11></a>        <span class=s1>&#39;new&#39;</span><span class=p>,</span> 
<a id=__codelineno-24-12 name=__codelineno-24-12 href=#__codelineno-24-12></a>        <span class=s1>&#39;edit&#39;</span><span class=p>,</span> 
<a id=__codelineno-24-13 name=__codelineno-24-13 href=#__codelineno-24-13></a>        <span class=s1>&#39;save&#39;</span><span class=p>,</span> 
<a id=__codelineno-24-14 name=__codelineno-24-14 href=#__codelineno-24-14></a>        <span class=s1>&#39;create&#39;</span><span class=p>,</span> 
<a id=__codelineno-24-15 name=__codelineno-24-15 href=#__codelineno-24-15></a>        <span class=s1>&#39;delete&#39;</span><span class=p>,</span>
<a id=__codelineno-24-16 name=__codelineno-24-16 href=#__codelineno-24-16></a>    <span class=p>],</span>
<a id=__codelineno-24-17 name=__codelineno-24-17 href=#__codelineno-24-17></a>    <span class=s1>&#39;products&#39;</span>     <span class=o>=&gt;</span> <span class=p>[</span>
<a id=__codelineno-24-18 name=__codelineno-24-18 href=#__codelineno-24-18></a>        <span class=s1>&#39;index&#39;</span><span class=p>,</span> 
<a id=__codelineno-24-19 name=__codelineno-24-19 href=#__codelineno-24-19></a>        <span class=s1>&#39;search&#39;</span><span class=p>,</span> 
<a id=__codelineno-24-20 name=__codelineno-24-20 href=#__codelineno-24-20></a>        <span class=s1>&#39;new&#39;</span><span class=p>,</span> 
<a id=__codelineno-24-21 name=__codelineno-24-21 href=#__codelineno-24-21></a>        <span class=s1>&#39;edit&#39;</span><span class=p>,</span> 
<a id=__codelineno-24-22 name=__codelineno-24-22 href=#__codelineno-24-22></a>        <span class=s1>&#39;save&#39;</span><span class=p>,</span> 
<a id=__codelineno-24-23 name=__codelineno-24-23 href=#__codelineno-24-23></a>        <span class=s1>&#39;create&#39;</span><span class=p>,</span> 
<a id=__codelineno-24-24 name=__codelineno-24-24 href=#__codelineno-24-24></a>        <span class=s1>&#39;delete&#39;</span><span class=p>,</span>
<a id=__codelineno-24-25 name=__codelineno-24-25 href=#__codelineno-24-25></a>    <span class=p>],</span>
<a id=__codelineno-24-26 name=__codelineno-24-26 href=#__codelineno-24-26></a>    <span class=s1>&#39;producttypes&#39;</span> <span class=o>=&gt;</span> <span class=p>[</span>
<a id=__codelineno-24-27 name=__codelineno-24-27 href=#__codelineno-24-27></a>        <span class=s1>&#39;index&#39;</span><span class=p>,</span> 
<a id=__codelineno-24-28 name=__codelineno-24-28 href=#__codelineno-24-28></a>        <span class=s1>&#39;search&#39;</span><span class=p>,</span> 
<a id=__codelineno-24-29 name=__codelineno-24-29 href=#__codelineno-24-29></a>        <span class=s1>&#39;new&#39;</span><span class=p>,</span> 
<a id=__codelineno-24-30 name=__codelineno-24-30 href=#__codelineno-24-30></a>        <span class=s1>&#39;edit&#39;</span><span class=p>,</span> 
<a id=__codelineno-24-31 name=__codelineno-24-31 href=#__codelineno-24-31></a>        <span class=s1>&#39;save&#39;</span><span class=p>,</span> 
<a id=__codelineno-24-32 name=__codelineno-24-32 href=#__codelineno-24-32></a>        <span class=s1>&#39;create&#39;</span><span class=p>,</span> 
<a id=__codelineno-24-33 name=__codelineno-24-33 href=#__codelineno-24-33></a>        <span class=s1>&#39;delete&#39;</span><span class=p>,</span>
<a id=__codelineno-24-34 name=__codelineno-24-34 href=#__codelineno-24-34></a>    <span class=p>],</span>
<a id=__codelineno-24-35 name=__codelineno-24-35 href=#__codelineno-24-35></a>    <span class=s1>&#39;invoices&#39;</span>     <span class=o>=&gt;</span> <span class=p>[</span>
<a id=__codelineno-24-36 name=__codelineno-24-36 href=#__codelineno-24-36></a>        <span class=s1>&#39;index&#39;</span><span class=p>,</span> 
<a id=__codelineno-24-37 name=__codelineno-24-37 href=#__codelineno-24-37></a>        <span class=s1>&#39;profile&#39;</span><span class=p>,</span>
<a id=__codelineno-24-38 name=__codelineno-24-38 href=#__codelineno-24-38></a>    <span class=p>],</span>
<a id=__codelineno-24-39 name=__codelineno-24-39 href=#__codelineno-24-39></a><span class=p>];</span>
<a id=__codelineno-24-40 name=__codelineno-24-40 href=#__codelineno-24-40></a>
<a id=__codelineno-24-41 name=__codelineno-24-41 href=#__codelineno-24-41></a><span class=k>foreach</span> <span class=p>(</span><span class=nv>$privateComponents</span> <span class=k>as</span> <span class=nv>$componentName</span> <span class=o>=&gt;</span> <span class=nv>$actions</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-24-42 name=__codelineno-24-42 href=#__codelineno-24-42></a>    <span class=nv>$acl</span><span class=o>-&gt;</span><span class=na>addComponent</span><span class=p>(</span>
<a id=__codelineno-24-43 name=__codelineno-24-43 href=#__codelineno-24-43></a>        <span class=k>new</span> <span class=nx>Component</span><span class=p>(</span><span class=nv>$componentName</span><span class=p>),</span>
<a id=__codelineno-24-44 name=__codelineno-24-44 href=#__codelineno-24-44></a>        <span class=nv>$actions</span>
<a id=__codelineno-24-45 name=__codelineno-24-45 href=#__codelineno-24-45></a>    <span class=p>);</span>
<a id=__codelineno-24-46 name=__codelineno-24-46 href=#__codelineno-24-46></a><span class=p>}</span>
<a id=__codelineno-24-47 name=__codelineno-24-47 href=#__codelineno-24-47></a>
<a id=__codelineno-24-48 name=__codelineno-24-48 href=#__codelineno-24-48></a><span class=nv>$publicComponents</span> <span class=o>=</span> <span class=p>[</span>
<a id=__codelineno-24-49 name=__codelineno-24-49 href=#__codelineno-24-49></a>    <span class=s1>&#39;index&#39;</span>    <span class=o>=&gt;</span> <span class=p>[</span>
<a id=__codelineno-24-50 name=__codelineno-24-50 href=#__codelineno-24-50></a>        <span class=s1>&#39;index&#39;</span><span class=p>,</span>
<a id=__codelineno-24-51 name=__codelineno-24-51 href=#__codelineno-24-51></a>        <span class=p>],</span>
<a id=__codelineno-24-52 name=__codelineno-24-52 href=#__codelineno-24-52></a>    <span class=s1>&#39;about&#39;</span>    <span class=o>=&gt;</span> <span class=p>[</span>
<a id=__codelineno-24-53 name=__codelineno-24-53 href=#__codelineno-24-53></a>        <span class=s1>&#39;index&#39;</span><span class=p>,</span>
<a id=__codelineno-24-54 name=__codelineno-24-54 href=#__codelineno-24-54></a>        <span class=p>],</span>
<a id=__codelineno-24-55 name=__codelineno-24-55 href=#__codelineno-24-55></a>    <span class=s1>&#39;register&#39;</span> <span class=o>=&gt;</span> <span class=p>[</span>
<a id=__codelineno-24-56 name=__codelineno-24-56 href=#__codelineno-24-56></a>        <span class=s1>&#39;index&#39;</span><span class=p>,</span>
<a id=__codelineno-24-57 name=__codelineno-24-57 href=#__codelineno-24-57></a>        <span class=p>],</span>
<a id=__codelineno-24-58 name=__codelineno-24-58 href=#__codelineno-24-58></a>    <span class=s1>&#39;errors&#39;</span>   <span class=o>=&gt;</span> <span class=p>[</span>
<a id=__codelineno-24-59 name=__codelineno-24-59 href=#__codelineno-24-59></a>        <span class=s1>&#39;show404&#39;</span><span class=p>,</span> 
<a id=__codelineno-24-60 name=__codelineno-24-60 href=#__codelineno-24-60></a>        <span class=s1>&#39;show500&#39;</span><span class=p>,</span>
<a id=__codelineno-24-61 name=__codelineno-24-61 href=#__codelineno-24-61></a>    <span class=p>],</span>
<a id=__codelineno-24-62 name=__codelineno-24-62 href=#__codelineno-24-62></a>    <span class=s1>&#39;session&#39;</span>  <span class=o>=&gt;</span> <span class=p>[</span>
<a id=__codelineno-24-63 name=__codelineno-24-63 href=#__codelineno-24-63></a>        <span class=s1>&#39;index&#39;</span><span class=p>,</span> 
<a id=__codelineno-24-64 name=__codelineno-24-64 href=#__codelineno-24-64></a>        <span class=s1>&#39;register&#39;</span><span class=p>,</span> 
<a id=__codelineno-24-65 name=__codelineno-24-65 href=#__codelineno-24-65></a>        <span class=s1>&#39;start&#39;</span><span class=p>,</span> 
<a id=__codelineno-24-66 name=__codelineno-24-66 href=#__codelineno-24-66></a>        <span class=s1>&#39;end&#39;</span><span class=p>,</span>
<a id=__codelineno-24-67 name=__codelineno-24-67 href=#__codelineno-24-67></a>    <span class=p>],</span>
<a id=__codelineno-24-68 name=__codelineno-24-68 href=#__codelineno-24-68></a>    <span class=s1>&#39;contact&#39;</span>  <span class=o>=&gt;</span> <span class=p>[</span>
<a id=__codelineno-24-69 name=__codelineno-24-69 href=#__codelineno-24-69></a>        <span class=s1>&#39;index&#39;</span><span class=p>,</span> 
<a id=__codelineno-24-70 name=__codelineno-24-70 href=#__codelineno-24-70></a>        <span class=s1>&#39;send&#39;</span><span class=p>,</span>
<a id=__codelineno-24-71 name=__codelineno-24-71 href=#__codelineno-24-71></a>    <span class=p>],</span>
<a id=__codelineno-24-72 name=__codelineno-24-72 href=#__codelineno-24-72></a><span class=p>];</span>
<a id=__codelineno-24-73 name=__codelineno-24-73 href=#__codelineno-24-73></a>
<a id=__codelineno-24-74 name=__codelineno-24-74 href=#__codelineno-24-74></a><span class=k>foreach</span> <span class=p>(</span><span class=nv>$publicComponents</span> <span class=k>as</span> <span class=nv>$componentName</span> <span class=o>=&gt;</span> <span class=nv>$actions</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-24-75 name=__codelineno-24-75 href=#__codelineno-24-75></a>    <span class=nv>$acl</span><span class=o>-&gt;</span><span class=na>addComponent</span><span class=p>(</span>
<a id=__codelineno-24-76 name=__codelineno-24-76 href=#__codelineno-24-76></a>        <span class=k>new</span> <span class=nx>Component</span><span class=p>(</span><span class=nv>$componentName</span><span class=p>),</span>
<a id=__codelineno-24-77 name=__codelineno-24-77 href=#__codelineno-24-77></a>        <span class=nv>$actions</span>
<a id=__codelineno-24-78 name=__codelineno-24-78 href=#__codelineno-24-78></a>    <span class=p>);</span>
<a id=__codelineno-24-79 name=__codelineno-24-79 href=#__codelineno-24-79></a><span class=p>}</span>
</code></pre></div> As seen above, we first register the private areas of our application (backend) and then the public ones (frontend). The arrays created have the key as the controller name while the values are the relevant actions. We do the same thing with the public components.</p> <p>Now that roles and components are registered, we need to link the two so that the ACL is complete. The <code>Users</code> role has access to public (frontend) and private (backend) components, while <code>Guests</code> only have access to the public (frontend) components.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-25-1 name=__codelineno-25-1 href=#__codelineno-25-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-25-2 name=__codelineno-25-2 href=#__codelineno-25-2></a>
<a id=__codelineno-25-3 name=__codelineno-25-3 href=#__codelineno-25-3></a><span class=c1>// Grant access to public areas to both users and guests</span>
<a id=__codelineno-25-4 name=__codelineno-25-4 href=#__codelineno-25-4></a><span class=k>foreach</span> <span class=p>(</span><span class=nv>$roles</span> <span class=k>as</span> <span class=nv>$role</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-25-5 name=__codelineno-25-5 href=#__codelineno-25-5></a>    <span class=k>foreach</span> <span class=p>(</span><span class=nv>$publicResources</span> <span class=k>as</span> <span class=nv>$resource</span> <span class=o>=&gt;</span> <span class=nv>$actions</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-25-6 name=__codelineno-25-6 href=#__codelineno-25-6></a>        <span class=k>foreach</span> <span class=p>(</span><span class=nv>$actions</span> <span class=k>as</span> <span class=nv>$action</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-25-7 name=__codelineno-25-7 href=#__codelineno-25-7></a>            <span class=nv>$acl</span><span class=o>-&gt;</span><span class=na>allow</span><span class=p>(</span><span class=nv>$role</span><span class=o>-&gt;</span><span class=na>getName</span><span class=p>(),</span> <span class=nv>$resource</span><span class=p>,</span> <span class=nv>$action</span><span class=p>);</span>
<a id=__codelineno-25-8 name=__codelineno-25-8 href=#__codelineno-25-8></a>        <span class=p>}</span>
<a id=__codelineno-25-9 name=__codelineno-25-9 href=#__codelineno-25-9></a>    <span class=p>}</span>
<a id=__codelineno-25-10 name=__codelineno-25-10 href=#__codelineno-25-10></a><span class=p>}</span>
<a id=__codelineno-25-11 name=__codelineno-25-11 href=#__codelineno-25-11></a>
<a id=__codelineno-25-12 name=__codelineno-25-12 href=#__codelineno-25-12></a><span class=c1>// Grant access to private area to role Users</span>
<a id=__codelineno-25-13 name=__codelineno-25-13 href=#__codelineno-25-13></a><span class=k>foreach</span> <span class=p>(</span><span class=nv>$privateResources</span> <span class=k>as</span> <span class=nv>$resource</span> <span class=o>=&gt;</span> <span class=nv>$actions</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-25-14 name=__codelineno-25-14 href=#__codelineno-25-14></a>    <span class=k>foreach</span> <span class=p>(</span><span class=nv>$actions</span> <span class=k>as</span> <span class=nv>$action</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-25-15 name=__codelineno-25-15 href=#__codelineno-25-15></a>        <span class=nv>$acl</span><span class=o>-&gt;</span><span class=na>allow</span><span class=p>(</span><span class=s1>&#39;Users&#39;</span><span class=p>,</span> <span class=nv>$resource</span><span class=p>,</span> <span class=nv>$action</span><span class=p>);</span>
<a id=__codelineno-25-16 name=__codelineno-25-16 href=#__codelineno-25-16></a>    <span class=p>}</span>
<a id=__codelineno-25-17 name=__codelineno-25-17 href=#__codelineno-25-17></a><span class=p>}</span>
</code></pre></div> <h2 id=crud>CRUD<a class=headerlink href=#crud title="Permanent link">&para;</a></h2> <p>A backend portion of an application is the code that provides forms and logic, allowing users to manipulate data i.e. perform CRUD operations. We will explore how INVO handles this task and also demonstrate the use of forms, validators, paginators, and more.</p> <p>We have a simple <a href=https://en.wikipedia.org/wiki/Create,_read,_update_and_delete>CRUD</a> (Create, Read, Update, and Delete) implementation in INVO, to manipulate data (companies, products, types of products). For products the following files are used:</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-26-1 name=__codelineno-26-1 href=#__codelineno-26-1></a>└──<span class=w> </span>invo
<a id=__codelineno-26-2 name=__codelineno-26-2 href=#__codelineno-26-2></a><span class=w>    </span>└──<span class=w> </span>src
<a id=__codelineno-26-3 name=__codelineno-26-3 href=#__codelineno-26-3></a><span class=w>        </span>├──<span class=w> </span>Controllers
<a id=__codelineno-26-4 name=__codelineno-26-4 href=#__codelineno-26-4></a><span class=w>        </span>│<span class=w>   </span>└──<span class=w> </span>ProductsController.php
<a id=__codelineno-26-5 name=__codelineno-26-5 href=#__codelineno-26-5></a><span class=w>        </span>├──<span class=w> </span>Forms
<a id=__codelineno-26-6 name=__codelineno-26-6 href=#__codelineno-26-6></a><span class=w>        </span>│<span class=w>   </span>└──<span class=w> </span>ProductsForm.php
<a id=__codelineno-26-7 name=__codelineno-26-7 href=#__codelineno-26-7></a><span class=w>        </span>├──<span class=w> </span>Models
<a id=__codelineno-26-8 name=__codelineno-26-8 href=#__codelineno-26-8></a><span class=w>        </span>│<span class=w>   </span>└──<span class=w> </span>Products.php
<a id=__codelineno-26-9 name=__codelineno-26-9 href=#__codelineno-26-9></a><span class=w>        </span>└──<span class=w> </span>themes
<a id=__codelineno-26-10 name=__codelineno-26-10 href=#__codelineno-26-10></a><span class=w>            </span>└──<span class=w> </span>invo
<a id=__codelineno-26-11 name=__codelineno-26-11 href=#__codelineno-26-11></a><span class=w>                </span>└──<span class=w> </span>products
<a id=__codelineno-26-12 name=__codelineno-26-12 href=#__codelineno-26-12></a><span class=w>                    </span>├──<span class=w> </span>edit.volt
<a id=__codelineno-26-13 name=__codelineno-26-13 href=#__codelineno-26-13></a><span class=w>                    </span>├──<span class=w> </span>index.volt
<a id=__codelineno-26-14 name=__codelineno-26-14 href=#__codelineno-26-14></a><span class=w>                    </span>├──<span class=w> </span>new.volt
<a id=__codelineno-26-15 name=__codelineno-26-15 href=#__codelineno-26-15></a><span class=w>                    </span>└──<span class=w> </span>search.volt
</code></pre></div> For other areas (such as companies for instance), the relevant files (prefixed with <code>Company</code>) can be found in the same directories as shown above.</p> <p>Each controller has the following actions:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-27-1 name=__codelineno-27-1 href=#__codelineno-27-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-27-2 name=__codelineno-27-2 href=#__codelineno-27-2></a>
<a id=__codelineno-27-3 name=__codelineno-27-3 href=#__codelineno-27-3></a><span class=k>class</span> <span class=nc>ProductsController</span> <span class=k>extends</span> <span class=nx>ControllerBase</span>
<a id=__codelineno-27-4 name=__codelineno-27-4 href=#__codelineno-27-4></a><span class=p>{</span>
<a id=__codelineno-27-5 name=__codelineno-27-5 href=#__codelineno-27-5></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>createAction</span><span class=p>();</span>
<a id=__codelineno-27-6 name=__codelineno-27-6 href=#__codelineno-27-6></a>
<a id=__codelineno-27-7 name=__codelineno-27-7 href=#__codelineno-27-7></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>editAction</span><span class=p>(</span><span class=nv>$id</span><span class=p>);</span>
<a id=__codelineno-27-8 name=__codelineno-27-8 href=#__codelineno-27-8></a>
<a id=__codelineno-27-9 name=__codelineno-27-9 href=#__codelineno-27-9></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>deleteAction</span><span class=p>(</span><span class=nv>$id</span><span class=p>);</span>
<a id=__codelineno-27-10 name=__codelineno-27-10 href=#__codelineno-27-10></a>
<a id=__codelineno-27-11 name=__codelineno-27-11 href=#__codelineno-27-11></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>indexAction</span><span class=p>();</span>
<a id=__codelineno-27-12 name=__codelineno-27-12 href=#__codelineno-27-12></a>
<a id=__codelineno-27-13 name=__codelineno-27-13 href=#__codelineno-27-13></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>newAction</span><span class=p>();</span>
<a id=__codelineno-27-14 name=__codelineno-27-14 href=#__codelineno-27-14></a>
<a id=__codelineno-27-15 name=__codelineno-27-15 href=#__codelineno-27-15></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>saveAction</span><span class=p>();</span>
<a id=__codelineno-27-16 name=__codelineno-27-16 href=#__codelineno-27-16></a>
<a id=__codelineno-27-17 name=__codelineno-27-17 href=#__codelineno-27-17></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>searchAction</span><span class=p>();</span>
<a id=__codelineno-27-18 name=__codelineno-27-18 href=#__codelineno-27-18></a><span class=p>}</span>
</code></pre></div> <table> <thead> <tr> <th>Action</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>createAction</code></td> <td>Creates a product based on the data entered in the <code>new</code> action</td> </tr> <tr> <td><code>deleteAction</code></td> <td>Deletes an existing product</td> </tr> <tr> <td><code>editAction</code></td> <td>Shows the view to <code>edit</code> an existing product</td> </tr> <tr> <td><code>indexAction</code></td> <td>The start action, shows the <code>search</code> view</td> </tr> <tr> <td><code>newAction</code></td> <td>Shows the view to create a <code>new</code> product</td> </tr> <tr> <td><code>saveAction</code></td> <td>Updates a product based on the data entered in the <code>edit</code> action</td> </tr> <tr> <td><code>searchAction</code></td> <td>Execute the <code>search</code> based on the criteria sent from the <code>index</code>. Returning a paginator for the results</td> </tr> </tbody> </table> <h2 id=search-form>Search Form<a class=headerlink href=#search-form title="Permanent link">&para;</a></h2> <p>Our CRUD operations start with the search form. This form shows each field that the table has (<code>products</code>), allowing the user to enter search criteria for each field. The <code>products</code> table has a relationship with the table <code>products_types</code>. In this case, we previously queried the records in the <code>product_types</code> table to offer search criteria for this field:</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-28-1 name=__codelineno-28-1 href=#__codelineno-28-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-28-2 name=__codelineno-28-2 href=#__codelineno-28-2></a>
<a id=__codelineno-28-3 name=__codelineno-28-3 href=#__codelineno-28-3></a><span class=k>public</span> <span class=k>function</span> <span class=nf>indexAction</span><span class=p>()</span>
<a id=__codelineno-28-4 name=__codelineno-28-4 href=#__codelineno-28-4></a><span class=p>{</span>
<a id=__codelineno-28-5 name=__codelineno-28-5 href=#__codelineno-28-5></a>    <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>persistent</span><span class=o>-&gt;</span><span class=na>searchParams</span> <span class=o>=</span> <span class=k>null</span><span class=p>;</span>
<a id=__codelineno-28-6 name=__codelineno-28-6 href=#__codelineno-28-6></a>
<a id=__codelineno-28-7 name=__codelineno-28-7 href=#__codelineno-28-7></a>    <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>view</span><span class=o>-&gt;</span><span class=na>form</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>ProductsForm</span><span class=p>();</span>
<a id=__codelineno-28-8 name=__codelineno-28-8 href=#__codelineno-28-8></a><span class=p>}</span>
</code></pre></div> An instance of the <code>ProductsForm</code> form (<code>src/Forms/ProductsForm.php</code>) is passed to the view. This form defines the fields that are visible to the user:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-29-1 name=__codelineno-29-1 href=#__codelineno-29-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-29-2 name=__codelineno-29-2 href=#__codelineno-29-2></a>
<a id=__codelineno-29-3 name=__codelineno-29-3 href=#__codelineno-29-3></a><span class=k>use</span> <span class=nx>Phalcon\Forms\Form</span><span class=p>;</span>
<a id=__codelineno-29-4 name=__codelineno-29-4 href=#__codelineno-29-4></a><span class=k>use</span> <span class=nx>Phalcon\Forms\Element\Text</span><span class=p>;</span>
<a id=__codelineno-29-5 name=__codelineno-29-5 href=#__codelineno-29-5></a><span class=k>use</span> <span class=nx>Phalcon\Forms\Element\Hidden</span><span class=p>;</span>
<a id=__codelineno-29-6 name=__codelineno-29-6 href=#__codelineno-29-6></a><span class=k>use</span> <span class=nx>Phalcon\Forms\Element\Select</span><span class=p>;</span>
<a id=__codelineno-29-7 name=__codelineno-29-7 href=#__codelineno-29-7></a><span class=k>use</span> <span class=nx>Phalcon\Validation\Validator\Email</span><span class=p>;</span>
<a id=__codelineno-29-8 name=__codelineno-29-8 href=#__codelineno-29-8></a><span class=k>use</span> <span class=nx>Phalcon\Validation\Validator\PresenceOf</span><span class=p>;</span>
<a id=__codelineno-29-9 name=__codelineno-29-9 href=#__codelineno-29-9></a><span class=k>use</span> <span class=nx>Phalcon\Validation\Validator\Numericality</span><span class=p>;</span>
<a id=__codelineno-29-10 name=__codelineno-29-10 href=#__codelineno-29-10></a>
<a id=__codelineno-29-11 name=__codelineno-29-11 href=#__codelineno-29-11></a><span class=k>class</span> <span class=nc>ProductsForm</span> <span class=k>extends</span> <span class=nx>Form</span>
<a id=__codelineno-29-12 name=__codelineno-29-12 href=#__codelineno-29-12></a><span class=p>{</span>
<a id=__codelineno-29-13 name=__codelineno-29-13 href=#__codelineno-29-13></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>initialize</span><span class=p>(</span><span class=nv>$entity</span> <span class=o>=</span> <span class=k>null</span><span class=p>,</span> <span class=nv>$options</span> <span class=o>=</span> <span class=p>[])</span>
<a id=__codelineno-29-14 name=__codelineno-29-14 href=#__codelineno-29-14></a>    <span class=p>{</span>
<a id=__codelineno-29-15 name=__codelineno-29-15 href=#__codelineno-29-15></a>        <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nb>isset</span><span class=p>(</span><span class=nv>$options</span><span class=p>[</span><span class=s1>&#39;edit&#39;</span><span class=p>]))</span> <span class=p>{</span>
<a id=__codelineno-29-16 name=__codelineno-29-16 href=#__codelineno-29-16></a>            <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>add</span><span class=p>((</span><span class=k>new</span> <span class=nx>Text</span><span class=p>(</span><span class=s1>&#39;id&#39;</span><span class=p>))</span><span class=o>-&gt;</span><span class=na>setLabel</span><span class=p>(</span><span class=s1>&#39;Id&#39;</span><span class=p>));</span>
<a id=__codelineno-29-17 name=__codelineno-29-17 href=#__codelineno-29-17></a>        <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
<a id=__codelineno-29-18 name=__codelineno-29-18 href=#__codelineno-29-18></a>            <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>add</span><span class=p>(</span><span class=k>new</span> <span class=nx>Hidden</span><span class=p>(</span><span class=s1>&#39;id&#39;</span><span class=p>));</span>
<a id=__codelineno-29-19 name=__codelineno-29-19 href=#__codelineno-29-19></a>        <span class=p>}</span>
<a id=__codelineno-29-20 name=__codelineno-29-20 href=#__codelineno-29-20></a>
<a id=__codelineno-29-21 name=__codelineno-29-21 href=#__codelineno-29-21></a>        <span class=sd>/**</span>
<a id=__codelineno-29-22 name=__codelineno-29-22 href=#__codelineno-29-22></a><span class=sd>         * Name text field</span>
<a id=__codelineno-29-23 name=__codelineno-29-23 href=#__codelineno-29-23></a><span class=sd>         */</span>
<a id=__codelineno-29-24 name=__codelineno-29-24 href=#__codelineno-29-24></a>        <span class=nv>$name</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Text</span><span class=p>(</span><span class=s1>&#39;name&#39;</span><span class=p>);</span>
<a id=__codelineno-29-25 name=__codelineno-29-25 href=#__codelineno-29-25></a>        <span class=nv>$name</span><span class=o>-&gt;</span><span class=na>setLabel</span><span class=p>(</span><span class=s1>&#39;Name&#39;</span><span class=p>);</span>
<a id=__codelineno-29-26 name=__codelineno-29-26 href=#__codelineno-29-26></a>        <span class=nv>$name</span><span class=o>-&gt;</span><span class=na>setFilters</span><span class=p>([</span><span class=s1>&#39;striptags&#39;</span><span class=p>,</span> <span class=s1>&#39;string&#39;</span><span class=p>]);</span>
<a id=__codelineno-29-27 name=__codelineno-29-27 href=#__codelineno-29-27></a>        <span class=nv>$name</span><span class=o>-&gt;</span><span class=na>addValidators</span><span class=p>([</span>
<a id=__codelineno-29-28 name=__codelineno-29-28 href=#__codelineno-29-28></a>            <span class=k>new</span> <span class=nx>PresenceOf</span><span class=p>(</span>
<a id=__codelineno-29-29 name=__codelineno-29-29 href=#__codelineno-29-29></a>                <span class=p>[</span>
<a id=__codelineno-29-30 name=__codelineno-29-30 href=#__codelineno-29-30></a>                    <span class=s1>&#39;message&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;Name is required&#39;</span>
<a id=__codelineno-29-31 name=__codelineno-29-31 href=#__codelineno-29-31></a>                <span class=p>]</span>
<a id=__codelineno-29-32 name=__codelineno-29-32 href=#__codelineno-29-32></a>            <span class=p>),</span>
<a id=__codelineno-29-33 name=__codelineno-29-33 href=#__codelineno-29-33></a>        <span class=p>]);</span>
<a id=__codelineno-29-34 name=__codelineno-29-34 href=#__codelineno-29-34></a>
<a id=__codelineno-29-35 name=__codelineno-29-35 href=#__codelineno-29-35></a>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>add</span><span class=p>(</span><span class=nv>$name</span><span class=p>);</span>
<a id=__codelineno-29-36 name=__codelineno-29-36 href=#__codelineno-29-36></a>
<a id=__codelineno-29-37 name=__codelineno-29-37 href=#__codelineno-29-37></a>        <span class=sd>/**</span>
<a id=__codelineno-29-38 name=__codelineno-29-38 href=#__codelineno-29-38></a><span class=sd>         * Product Type ID Select</span>
<a id=__codelineno-29-39 name=__codelineno-29-39 href=#__codelineno-29-39></a><span class=sd>         */</span>
<a id=__codelineno-29-40 name=__codelineno-29-40 href=#__codelineno-29-40></a>        <span class=nv>$type</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Select</span><span class=p>(</span>
<a id=__codelineno-29-41 name=__codelineno-29-41 href=#__codelineno-29-41></a>            <span class=s1>&#39;product_types_id&#39;</span><span class=p>,</span>
<a id=__codelineno-29-42 name=__codelineno-29-42 href=#__codelineno-29-42></a>            <span class=nx>ProductTypes</span><span class=o>::</span><span class=na>find</span><span class=p>(),</span>
<a id=__codelineno-29-43 name=__codelineno-29-43 href=#__codelineno-29-43></a>            <span class=p>[</span>
<a id=__codelineno-29-44 name=__codelineno-29-44 href=#__codelineno-29-44></a>                <span class=s1>&#39;using&#39;</span>      <span class=o>=&gt;</span> <span class=p>[</span><span class=s1>&#39;id&#39;</span><span class=p>,</span> <span class=s1>&#39;name&#39;</span><span class=p>],</span>
<a id=__codelineno-29-45 name=__codelineno-29-45 href=#__codelineno-29-45></a>                <span class=s1>&#39;useEmpty&#39;</span>   <span class=o>=&gt;</span> <span class=k>true</span><span class=p>,</span>
<a id=__codelineno-29-46 name=__codelineno-29-46 href=#__codelineno-29-46></a>                <span class=s1>&#39;emptyText&#39;</span>  <span class=o>=&gt;</span> <span class=s1>&#39;...&#39;</span><span class=p>,</span>
<a id=__codelineno-29-47 name=__codelineno-29-47 href=#__codelineno-29-47></a>                <span class=s1>&#39;emptyValue&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;&#39;</span><span class=p>,</span>
<a id=__codelineno-29-48 name=__codelineno-29-48 href=#__codelineno-29-48></a>            <span class=p>]</span>
<a id=__codelineno-29-49 name=__codelineno-29-49 href=#__codelineno-29-49></a>        <span class=p>);</span>
<a id=__codelineno-29-50 name=__codelineno-29-50 href=#__codelineno-29-50></a>        <span class=nv>$type</span><span class=o>-&gt;</span><span class=na>setLabel</span><span class=p>(</span><span class=s1>&#39;Type&#39;</span><span class=p>);</span>
<a id=__codelineno-29-51 name=__codelineno-29-51 href=#__codelineno-29-51></a>
<a id=__codelineno-29-52 name=__codelineno-29-52 href=#__codelineno-29-52></a>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>add</span><span class=p>(</span><span class=nv>$type</span><span class=p>);</span>
<a id=__codelineno-29-53 name=__codelineno-29-53 href=#__codelineno-29-53></a>
<a id=__codelineno-29-54 name=__codelineno-29-54 href=#__codelineno-29-54></a>        <span class=sd>/**</span>
<a id=__codelineno-29-55 name=__codelineno-29-55 href=#__codelineno-29-55></a><span class=sd>         * Price text field</span>
<a id=__codelineno-29-56 name=__codelineno-29-56 href=#__codelineno-29-56></a><span class=sd>         */</span>
<a id=__codelineno-29-57 name=__codelineno-29-57 href=#__codelineno-29-57></a>        <span class=nv>$price</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Text</span><span class=p>(</span><span class=s1>&#39;price&#39;</span><span class=p>);</span>
<a id=__codelineno-29-58 name=__codelineno-29-58 href=#__codelineno-29-58></a>        <span class=nv>$price</span><span class=o>-&gt;</span><span class=na>setLabel</span><span class=p>(</span><span class=s1>&#39;Price&#39;</span><span class=p>);</span>
<a id=__codelineno-29-59 name=__codelineno-29-59 href=#__codelineno-29-59></a>        <span class=nv>$price</span><span class=o>-&gt;</span><span class=na>setFilters</span><span class=p>([</span><span class=s1>&#39;float&#39;</span><span class=p>]);</span>
<a id=__codelineno-29-60 name=__codelineno-29-60 href=#__codelineno-29-60></a>        <span class=nv>$price</span><span class=o>-&gt;</span><span class=na>addValidators</span><span class=p>([</span>
<a id=__codelineno-29-61 name=__codelineno-29-61 href=#__codelineno-29-61></a>            <span class=k>new</span> <span class=nx>PresenceOf</span><span class=p>(</span>
<a id=__codelineno-29-62 name=__codelineno-29-62 href=#__codelineno-29-62></a>                <span class=p>[</span>
<a id=__codelineno-29-63 name=__codelineno-29-63 href=#__codelineno-29-63></a>                    <span class=s1>&#39;message&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;Price is required&#39;</span>
<a id=__codelineno-29-64 name=__codelineno-29-64 href=#__codelineno-29-64></a>                <span class=p>]</span>
<a id=__codelineno-29-65 name=__codelineno-29-65 href=#__codelineno-29-65></a>            <span class=p>),</span>
<a id=__codelineno-29-66 name=__codelineno-29-66 href=#__codelineno-29-66></a>            <span class=k>new</span> <span class=nx>Numericality</span><span class=p>(</span>
<a id=__codelineno-29-67 name=__codelineno-29-67 href=#__codelineno-29-67></a>                <span class=p>[</span>
<a id=__codelineno-29-68 name=__codelineno-29-68 href=#__codelineno-29-68></a>                    <span class=s1>&#39;message&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;Price is required&#39;</span>
<a id=__codelineno-29-69 name=__codelineno-29-69 href=#__codelineno-29-69></a>                <span class=p>]</span>
<a id=__codelineno-29-70 name=__codelineno-29-70 href=#__codelineno-29-70></a>            <span class=p>),</span>
<a id=__codelineno-29-71 name=__codelineno-29-71 href=#__codelineno-29-71></a>        <span class=p>]);</span>
<a id=__codelineno-29-72 name=__codelineno-29-72 href=#__codelineno-29-72></a>
<a id=__codelineno-29-73 name=__codelineno-29-73 href=#__codelineno-29-73></a>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>add</span><span class=p>(</span><span class=nv>$price</span><span class=p>);</span>
<a id=__codelineno-29-74 name=__codelineno-29-74 href=#__codelineno-29-74></a>     <span class=p>}</span>
<a id=__codelineno-29-75 name=__codelineno-29-75 href=#__codelineno-29-75></a><span class=p>}</span>
</code></pre></div> <p>The form is declared using an object-oriented scheme based on the elements provided by the [Phalcon\Forms\Form][forms] component. Each element defined follows almost the same setup:</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-30-1 name=__codelineno-30-1 href=#__codelineno-30-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-30-2 name=__codelineno-30-2 href=#__codelineno-30-2></a>
<a id=__codelineno-30-3 name=__codelineno-30-3 href=#__codelineno-30-3></a><span class=nv>$name</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Text</span><span class=p>(</span><span class=s1>&#39;name&#39;</span><span class=p>);</span>
<a id=__codelineno-30-4 name=__codelineno-30-4 href=#__codelineno-30-4></a><span class=nv>$name</span><span class=o>-&gt;</span><span class=na>setLabel</span><span class=p>(</span><span class=s1>&#39;Name&#39;</span><span class=p>);</span>
<a id=__codelineno-30-5 name=__codelineno-30-5 href=#__codelineno-30-5></a><span class=nv>$name</span><span class=o>-&gt;</span><span class=na>setFilters</span><span class=p>(</span>
<a id=__codelineno-30-6 name=__codelineno-30-6 href=#__codelineno-30-6></a>    <span class=p>[</span>
<a id=__codelineno-30-7 name=__codelineno-30-7 href=#__codelineno-30-7></a>        <span class=s1>&#39;striptags&#39;</span><span class=p>,</span>
<a id=__codelineno-30-8 name=__codelineno-30-8 href=#__codelineno-30-8></a>        <span class=s1>&#39;string&#39;</span><span class=p>,</span>
<a id=__codelineno-30-9 name=__codelineno-30-9 href=#__codelineno-30-9></a>    <span class=p>]</span>
<a id=__codelineno-30-10 name=__codelineno-30-10 href=#__codelineno-30-10></a><span class=p>);</span>
<a id=__codelineno-30-11 name=__codelineno-30-11 href=#__codelineno-30-11></a>
<a id=__codelineno-30-12 name=__codelineno-30-12 href=#__codelineno-30-12></a><span class=nv>$name</span><span class=o>-&gt;</span><span class=na>addValidators</span><span class=p>(</span>
<a id=__codelineno-30-13 name=__codelineno-30-13 href=#__codelineno-30-13></a>    <span class=p>[</span>
<a id=__codelineno-30-14 name=__codelineno-30-14 href=#__codelineno-30-14></a>        <span class=k>new</span> <span class=nx>PresenceOf</span><span class=p>(</span>
<a id=__codelineno-30-15 name=__codelineno-30-15 href=#__codelineno-30-15></a>            <span class=p>[</span>
<a id=__codelineno-30-16 name=__codelineno-30-16 href=#__codelineno-30-16></a>                <span class=s1>&#39;message&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;Name is required&#39;</span><span class=p>,</span>
<a id=__codelineno-30-17 name=__codelineno-30-17 href=#__codelineno-30-17></a>            <span class=p>]</span>
<a id=__codelineno-30-18 name=__codelineno-30-18 href=#__codelineno-30-18></a>        <span class=p>)</span>
<a id=__codelineno-30-19 name=__codelineno-30-19 href=#__codelineno-30-19></a>    <span class=p>]</span>
<a id=__codelineno-30-20 name=__codelineno-30-20 href=#__codelineno-30-20></a><span class=p>);</span>
<a id=__codelineno-30-21 name=__codelineno-30-21 href=#__codelineno-30-21></a>
<a id=__codelineno-30-22 name=__codelineno-30-22 href=#__codelineno-30-22></a><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>add</span><span class=p>(</span><span class=nv>$name</span><span class=p>);</span>
</code></pre></div> First, we create the element. Then we attach a label to it and attach filters so that we can perform sanitization of data. Following that we apply validators on the element and finally add the element to the form.</p> <p>Other elements are also used in this form:</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-31-1 name=__codelineno-31-1 href=#__codelineno-31-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-31-2 name=__codelineno-31-2 href=#__codelineno-31-2></a>
<a id=__codelineno-31-3 name=__codelineno-31-3 href=#__codelineno-31-3></a><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>add</span><span class=p>(</span>
<a id=__codelineno-31-4 name=__codelineno-31-4 href=#__codelineno-31-4></a>    <span class=k>new</span> <span class=nx>Hidden</span><span class=p>(</span><span class=s1>&#39;id&#39;</span><span class=p>)</span>
<a id=__codelineno-31-5 name=__codelineno-31-5 href=#__codelineno-31-5></a><span class=p>);</span>
<a id=__codelineno-31-6 name=__codelineno-31-6 href=#__codelineno-31-6></a>
<a id=__codelineno-31-7 name=__codelineno-31-7 href=#__codelineno-31-7></a><span class=c1>// ...</span>
<a id=__codelineno-31-8 name=__codelineno-31-8 href=#__codelineno-31-8></a>
<a id=__codelineno-31-9 name=__codelineno-31-9 href=#__codelineno-31-9></a><span class=nv>$productTypes</span> <span class=o>=</span> <span class=nx>ProductTypes</span><span class=o>::</span><span class=na>find</span><span class=p>();</span>
<a id=__codelineno-31-10 name=__codelineno-31-10 href=#__codelineno-31-10></a>
<a id=__codelineno-31-11 name=__codelineno-31-11 href=#__codelineno-31-11></a><span class=nv>$type</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Select</span><span class=p>(</span>
<a id=__codelineno-31-12 name=__codelineno-31-12 href=#__codelineno-31-12></a>    <span class=s1>&#39;profilesId&#39;</span><span class=p>,</span>
<a id=__codelineno-31-13 name=__codelineno-31-13 href=#__codelineno-31-13></a>    <span class=nv>$productTypes</span><span class=p>,</span>
<a id=__codelineno-31-14 name=__codelineno-31-14 href=#__codelineno-31-14></a>    <span class=p>[</span>
<a id=__codelineno-31-15 name=__codelineno-31-15 href=#__codelineno-31-15></a>        <span class=s1>&#39;using&#39;</span>      <span class=o>=&gt;</span> <span class=p>[</span>
<a id=__codelineno-31-16 name=__codelineno-31-16 href=#__codelineno-31-16></a>            <span class=s1>&#39;id&#39;</span><span class=p>,</span>
<a id=__codelineno-31-17 name=__codelineno-31-17 href=#__codelineno-31-17></a>            <span class=s1>&#39;name&#39;</span><span class=p>,</span>
<a id=__codelineno-31-18 name=__codelineno-31-18 href=#__codelineno-31-18></a>        <span class=p>],</span>
<a id=__codelineno-31-19 name=__codelineno-31-19 href=#__codelineno-31-19></a>        <span class=s1>&#39;useEmpty&#39;</span>   <span class=o>=&gt;</span> <span class=k>true</span><span class=p>,</span>
<a id=__codelineno-31-20 name=__codelineno-31-20 href=#__codelineno-31-20></a>        <span class=s1>&#39;emptyText&#39;</span>  <span class=o>=&gt;</span> <span class=s1>&#39;...&#39;</span><span class=p>,</span>
<a id=__codelineno-31-21 name=__codelineno-31-21 href=#__codelineno-31-21></a>        <span class=s1>&#39;emptyValue&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;&#39;</span><span class=p>,</span>
<a id=__codelineno-31-22 name=__codelineno-31-22 href=#__codelineno-31-22></a>    <span class=p>]</span>
<a id=__codelineno-31-23 name=__codelineno-31-23 href=#__codelineno-31-23></a><span class=p>);</span>
</code></pre></div> In the above code snippet, we add a hidden HTML field that holds the <code>id</code> of the product if applicable. We also get all the product types by using the <code>ProductTypes::find()</code> and then use that resultset to fill the HTML <code>select</code> element by using the [Phalcon\Tag][tag] component and its <code>select()</code> method. Once the form is passed to the view, it can be rendered and presented to the user:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-32-1 name=__codelineno-32-1 href=#__codelineno-32-1></a><span class=x>&lt;div class=&quot;row mb-3&quot;&gt;</span>
<a id=__codelineno-32-2 name=__codelineno-32-2 href=#__codelineno-32-2></a><span class=x>    &lt;div class=&quot;col-xs-12 col-md-6&quot;&gt;</span>
<a id=__codelineno-32-3 name=__codelineno-32-3 href=#__codelineno-32-3></a><span class=x>        &lt;h2&gt;Search products&lt;/h2&gt;</span>
<a id=__codelineno-32-4 name=__codelineno-32-4 href=#__codelineno-32-4></a><span class=x>    &lt;/div&gt;</span>
<a id=__codelineno-32-5 name=__codelineno-32-5 href=#__codelineno-32-5></a><span class=x>    &lt;div class=&quot;col-xs-12 col-md-6 text-right&quot;&gt;</span>
<a id=__codelineno-32-6 name=__codelineno-32-6 href=#__codelineno-32-6></a><span class=x>        </span><span class=cp>{{</span> <span class=nv>link_to</span><span class=o>(</span><span class=s2>&quot;products/new&quot;</span><span class=o>,</span> <span class=s2>&quot;Create Product&quot;</span><span class=o>,</span> <span class=s2>&quot;class&quot;</span><span class=o>:</span> <span class=s2>&quot;btn btn-primary&quot;</span><span class=o>)</span> <span class=cp>}}</span>
<a id=__codelineno-32-7 name=__codelineno-32-7 href=#__codelineno-32-7></a><span class=x>    &lt;/div&gt;</span>
<a id=__codelineno-32-8 name=__codelineno-32-8 href=#__codelineno-32-8></a><span class=x>&lt;/div&gt;</span>
<a id=__codelineno-32-9 name=__codelineno-32-9 href=#__codelineno-32-9></a>
<a id=__codelineno-32-10 name=__codelineno-32-10 href=#__codelineno-32-10></a><span class=x>&lt;form action=&quot;/products/search&quot; role=&quot;form&quot; method=&quot;get&quot;&gt;</span>
<a id=__codelineno-32-11 name=__codelineno-32-11 href=#__codelineno-32-11></a><span class=x>    </span><span class=cp>{%</span> <span class=k>for</span> <span class=nv>element</span> <span class=k>in</span> <span class=nv>form</span> <span class=cp>%}</span>
<a id=__codelineno-32-12 name=__codelineno-32-12 href=#__codelineno-32-12></a><span class=x>        </span><span class=cp>{%</span> <span class=k>if</span> <span class=nv>is_a</span><span class=o>(</span><span class=nv>element</span><span class=o>,</span> <span class=s1>&#39;Phalcon\Forms\Element\Hidden&#39;</span><span class=o>)</span> <span class=cp>%}</span>
<a id=__codelineno-32-13 name=__codelineno-32-13 href=#__codelineno-32-13></a><span class=x>            </span><span class=cp>{{</span> <span class=nv>element</span> <span class=cp>}}</span>
<a id=__codelineno-32-14 name=__codelineno-32-14 href=#__codelineno-32-14></a><span class=x>        </span><span class=cp>{%</span> <span class=k>else</span> <span class=cp>%}</span>
<a id=__codelineno-32-15 name=__codelineno-32-15 href=#__codelineno-32-15></a><span class=x>            &lt;div class=&quot;form-group&quot;&gt;</span>
<a id=__codelineno-32-16 name=__codelineno-32-16 href=#__codelineno-32-16></a><span class=x>                </span><span class=cp>{{</span> <span class=nv>element.label</span><span class=o>()</span> <span class=cp>}}</span>
<a id=__codelineno-32-17 name=__codelineno-32-17 href=#__codelineno-32-17></a><span class=x>                &lt;div class=&quot;controls&quot;&gt;</span>
<a id=__codelineno-32-18 name=__codelineno-32-18 href=#__codelineno-32-18></a><span class=x>                    </span><span class=cp>{{</span> <span class=nv>element.setAttribute</span><span class=o>(</span><span class=s2>&quot;class&quot;</span><span class=o>,</span> <span class=s2>&quot;form-control&quot;</span><span class=o>)</span> <span class=cp>}}</span>
<a id=__codelineno-32-19 name=__codelineno-32-19 href=#__codelineno-32-19></a><span class=x>                &lt;/div&gt;</span>
<a id=__codelineno-32-20 name=__codelineno-32-20 href=#__codelineno-32-20></a><span class=x>            &lt;/div&gt;</span>
<a id=__codelineno-32-21 name=__codelineno-32-21 href=#__codelineno-32-21></a><span class=x>        </span><span class=cp>{%</span> <span class=k>endif</span> <span class=cp>%}</span>
<a id=__codelineno-32-22 name=__codelineno-32-22 href=#__codelineno-32-22></a><span class=x>    </span><span class=cp>{%</span> <span class=k>endfor</span> <span class=cp>%}</span>
<a id=__codelineno-32-23 name=__codelineno-32-23 href=#__codelineno-32-23></a>
<a id=__codelineno-32-24 name=__codelineno-32-24 href=#__codelineno-32-24></a><span class=x>    </span><span class=cp>{{</span> <span class=nv>submit_button</span><span class=o>(</span><span class=s2>&quot;Search&quot;</span><span class=o>,</span> <span class=s2>&quot;class&quot;</span><span class=o>:</span> <span class=s2>&quot;btn btn-primary&quot;</span><span class=o>)</span> <span class=cp>}}</span>
<a id=__codelineno-32-25 name=__codelineno-32-25 href=#__codelineno-32-25></a><span class=x>&lt;/form&gt;</span>
</code></pre></div> <p>This produces the following HTML:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-33-1 name=__codelineno-33-1 href=#__codelineno-33-1></a><span class=p>&lt;</span><span class=nt>form</span> <span class=na>action</span><span class=o>=</span><span class=s>&#39;/invo/products/search&#39;</span> <span class=na>method</span><span class=o>=</span><span class=s>&#39;post&#39;</span><span class=p>&gt;</span>
<a id=__codelineno-33-2 name=__codelineno-33-2 href=#__codelineno-33-2></a>
<a id=__codelineno-33-3 name=__codelineno-33-3 href=#__codelineno-33-3></a>    <span class=p>&lt;</span><span class=nt>h2</span><span class=p>&gt;</span>
<a id=__codelineno-33-4 name=__codelineno-33-4 href=#__codelineno-33-4></a>        Search products
<a id=__codelineno-33-5 name=__codelineno-33-5 href=#__codelineno-33-5></a>        <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&quot;col-xs-12 col-md-6 text-right&quot;</span><span class=p>&gt;</span>
<a id=__codelineno-33-6 name=__codelineno-33-6 href=#__codelineno-33-6></a>            <span class=p>&lt;</span><span class=nt>a</span> <span class=na>href</span><span class=o>=</span><span class=s>&quot;products/new&quot;</span> <span class=err>&quot;</span><span class=na>class</span><span class=o>=</span><span class=s>btn</span> <span class=na>btn-primary</span><span class=err>&quot;</span><span class=p>&gt;</span>Create Product<span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span>
<a id=__codelineno-33-7 name=__codelineno-33-7 href=#__codelineno-33-7></a>        <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
<a id=__codelineno-33-8 name=__codelineno-33-8 href=#__codelineno-33-8></a>    <span class=p>&lt;/</span><span class=nt>h2</span><span class=p>&gt;</span>
<a id=__codelineno-33-9 name=__codelineno-33-9 href=#__codelineno-33-9></a>
<a id=__codelineno-33-10 name=__codelineno-33-10 href=#__codelineno-33-10></a>    <span class=p>&lt;</span><span class=nt>fieldset</span><span class=p>&gt;</span>
<a id=__codelineno-33-11 name=__codelineno-33-11 href=#__codelineno-33-11></a>
<a id=__codelineno-33-12 name=__codelineno-33-12 href=#__codelineno-33-12></a>        <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#39;control-group&#39;</span><span class=p>&gt;</span>
<a id=__codelineno-33-13 name=__codelineno-33-13 href=#__codelineno-33-13></a>            <span class=p>&lt;</span><span class=nt>label</span> <span class=na>for</span><span class=o>=</span><span class=s>&#39;id&#39;</span> <span class=na>class</span><span class=o>=</span><span class=s>&#39;control-label&#39;</span><span class=p>&gt;</span>Id<span class=p>&lt;/</span><span class=nt>label</span><span class=p>&gt;</span>
<a id=__codelineno-33-14 name=__codelineno-33-14 href=#__codelineno-33-14></a>
<a id=__codelineno-33-15 name=__codelineno-33-15 href=#__codelineno-33-15></a>            <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#39;controls&#39;</span><span class=p>&gt;</span>
<a id=__codelineno-33-16 name=__codelineno-33-16 href=#__codelineno-33-16></a>                <span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#39;text&#39;</span> <span class=na>id</span><span class=o>=</span><span class=s>&#39;id&#39;</span> <span class=na>name</span><span class=o>=</span><span class=s>&#39;id&#39;</span> <span class=p>/&gt;</span>
<a id=__codelineno-33-17 name=__codelineno-33-17 href=#__codelineno-33-17></a>            <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
<a id=__codelineno-33-18 name=__codelineno-33-18 href=#__codelineno-33-18></a>        <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
<a id=__codelineno-33-19 name=__codelineno-33-19 href=#__codelineno-33-19></a>
<a id=__codelineno-33-20 name=__codelineno-33-20 href=#__codelineno-33-20></a>        <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#39;control-group&#39;</span><span class=p>&gt;</span>
<a id=__codelineno-33-21 name=__codelineno-33-21 href=#__codelineno-33-21></a>            <span class=p>&lt;</span><span class=nt>label</span> <span class=na>for</span><span class=o>=</span><span class=s>&#39;name&#39;</span> <span class=na>class</span><span class=o>=</span><span class=s>&#39;control-label&#39;</span><span class=p>&gt;</span>Name<span class=p>&lt;/</span><span class=nt>label</span><span class=p>&gt;</span>
<a id=__codelineno-33-22 name=__codelineno-33-22 href=#__codelineno-33-22></a>
<a id=__codelineno-33-23 name=__codelineno-33-23 href=#__codelineno-33-23></a>            <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#39;controls&#39;</span><span class=p>&gt;</span>
<a id=__codelineno-33-24 name=__codelineno-33-24 href=#__codelineno-33-24></a>                <span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#39;text&#39;</span> <span class=na>id</span><span class=o>=</span><span class=s>&#39;name&#39;</span> <span class=na>name</span><span class=o>=</span><span class=s>&#39;name&#39;</span> <span class=p>/&gt;</span>
<a id=__codelineno-33-25 name=__codelineno-33-25 href=#__codelineno-33-25></a>            <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
<a id=__codelineno-33-26 name=__codelineno-33-26 href=#__codelineno-33-26></a>        <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
<a id=__codelineno-33-27 name=__codelineno-33-27 href=#__codelineno-33-27></a>
<a id=__codelineno-33-28 name=__codelineno-33-28 href=#__codelineno-33-28></a>        <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#39;control-group&#39;</span><span class=p>&gt;</span>
<a id=__codelineno-33-29 name=__codelineno-33-29 href=#__codelineno-33-29></a>            <span class=p>&lt;</span><span class=nt>label</span> <span class=na>for</span><span class=o>=</span><span class=s>&#39;profilesId&#39;</span> <span class=na>class</span><span class=o>=</span><span class=s>&#39;control-label&#39;</span><span class=p>&gt;</span>
<a id=__codelineno-33-30 name=__codelineno-33-30 href=#__codelineno-33-30></a>                profilesId
<a id=__codelineno-33-31 name=__codelineno-33-31 href=#__codelineno-33-31></a>            <span class=p>&lt;/</span><span class=nt>label</span><span class=p>&gt;</span>
<a id=__codelineno-33-32 name=__codelineno-33-32 href=#__codelineno-33-32></a>
<a id=__codelineno-33-33 name=__codelineno-33-33 href=#__codelineno-33-33></a>            <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#39;controls&#39;</span><span class=p>&gt;</span>
<a id=__codelineno-33-34 name=__codelineno-33-34 href=#__codelineno-33-34></a>                <span class=p>&lt;</span><span class=nt>select</span> <span class=na>id</span><span class=o>=</span><span class=s>&#39;profilesId&#39;</span> <span class=na>name</span><span class=o>=</span><span class=s>&#39;profilesId&#39;</span><span class=p>&gt;</span>
<a id=__codelineno-33-35 name=__codelineno-33-35 href=#__codelineno-33-35></a>                    <span class=p>&lt;</span><span class=nt>option</span> <span class=na>value</span><span class=o>=</span><span class=s>&#39;&#39;</span><span class=p>&gt;</span>...<span class=p>&lt;/</span><span class=nt>option</span><span class=p>&gt;</span>
<a id=__codelineno-33-36 name=__codelineno-33-36 href=#__codelineno-33-36></a>                    <span class=p>&lt;</span><span class=nt>option</span> <span class=na>value</span><span class=o>=</span><span class=s>&#39;1&#39;</span><span class=p>&gt;</span>Vegetables<span class=p>&lt;/</span><span class=nt>option</span><span class=p>&gt;</span>
<a id=__codelineno-33-37 name=__codelineno-33-37 href=#__codelineno-33-37></a>                    <span class=p>&lt;</span><span class=nt>option</span> <span class=na>value</span><span class=o>=</span><span class=s>&#39;2&#39;</span><span class=p>&gt;</span>Fruits<span class=p>&lt;/</span><span class=nt>option</span><span class=p>&gt;</span>
<a id=__codelineno-33-38 name=__codelineno-33-38 href=#__codelineno-33-38></a>                <span class=p>&lt;/</span><span class=nt>select</span><span class=p>&gt;</span>
<a id=__codelineno-33-39 name=__codelineno-33-39 href=#__codelineno-33-39></a>            <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
<a id=__codelineno-33-40 name=__codelineno-33-40 href=#__codelineno-33-40></a>        <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
<a id=__codelineno-33-41 name=__codelineno-33-41 href=#__codelineno-33-41></a>
<a id=__codelineno-33-42 name=__codelineno-33-42 href=#__codelineno-33-42></a>        <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#39;control-group&#39;</span><span class=p>&gt;</span>
<a id=__codelineno-33-43 name=__codelineno-33-43 href=#__codelineno-33-43></a>            <span class=p>&lt;</span><span class=nt>label</span> <span class=na>for</span><span class=o>=</span><span class=s>&#39;price&#39;</span> <span class=na>class</span><span class=o>=</span><span class=s>&#39;control-label&#39;</span><span class=p>&gt;</span>Price<span class=p>&lt;/</span><span class=nt>label</span><span class=p>&gt;</span>
<a id=__codelineno-33-44 name=__codelineno-33-44 href=#__codelineno-33-44></a>
<a id=__codelineno-33-45 name=__codelineno-33-45 href=#__codelineno-33-45></a>            <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#39;controls&#39;</span><span class=p>&gt;</span>
<a id=__codelineno-33-46 name=__codelineno-33-46 href=#__codelineno-33-46></a>                <span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#39;text&#39;</span> <span class=na>id</span><span class=o>=</span><span class=s>&#39;price&#39;</span> <span class=na>name</span><span class=o>=</span><span class=s>&#39;price&#39;</span> <span class=p>/&gt;</span>
<a id=__codelineno-33-47 name=__codelineno-33-47 href=#__codelineno-33-47></a>            <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
<a id=__codelineno-33-48 name=__codelineno-33-48 href=#__codelineno-33-48></a>        <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
<a id=__codelineno-33-49 name=__codelineno-33-49 href=#__codelineno-33-49></a>
<a id=__codelineno-33-50 name=__codelineno-33-50 href=#__codelineno-33-50></a>        <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#39;control-group&#39;</span><span class=p>&gt;</span>
<a id=__codelineno-33-51 name=__codelineno-33-51 href=#__codelineno-33-51></a>            <span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#39;submit&#39;</span> 
<a id=__codelineno-33-52 name=__codelineno-33-52 href=#__codelineno-33-52></a>                   <span class=na>value</span><span class=o>=</span><span class=s>&#39;Search&#39;</span> 
<a id=__codelineno-33-53 name=__codelineno-33-53 href=#__codelineno-33-53></a>                   <span class=na>class</span><span class=o>=</span><span class=s>&#39;btn btn-primary&#39;</span> <span class=p>/&gt;</span>
<a id=__codelineno-33-54 name=__codelineno-33-54 href=#__codelineno-33-54></a>        <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
<a id=__codelineno-33-55 name=__codelineno-33-55 href=#__codelineno-33-55></a>
<a id=__codelineno-33-56 name=__codelineno-33-56 href=#__codelineno-33-56></a>    <span class=p>&lt;/</span><span class=nt>fieldset</span><span class=p>&gt;</span>
<a id=__codelineno-33-57 name=__codelineno-33-57 href=#__codelineno-33-57></a>
<a id=__codelineno-33-58 name=__codelineno-33-58 href=#__codelineno-33-58></a><span class=p>&lt;/</span><span class=nt>form</span><span class=p>&gt;</span>
</code></pre></div> <p>When the form is submitted, the <code>search</code> action is executed in the controller performing the search based on the data entered by the user.</p> <h2 id=search>Search<a class=headerlink href=#search title="Permanent link">&para;</a></h2> <p>The <code>search</code> action has two operations. When accessed using the HTTP method <code>POST</code>, it performs the search based on the data sent from the form. When it is accessed using the HTTP method <code>GET</code>, it moves the current page in the paginator. To check which HTTP method has been used, we use the [Request][request] component:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-34-1 name=__codelineno-34-1 href=#__codelineno-34-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-34-2 name=__codelineno-34-2 href=#__codelineno-34-2></a>
<a id=__codelineno-34-3 name=__codelineno-34-3 href=#__codelineno-34-3></a><span class=k>public</span> <span class=k>function</span> <span class=nf>searchAction</span><span class=p>()</span>
<a id=__codelineno-34-4 name=__codelineno-34-4 href=#__codelineno-34-4></a><span class=p>{</span>
<a id=__codelineno-34-5 name=__codelineno-34-5 href=#__codelineno-34-5></a>    <span class=k>if</span> <span class=p>(</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>request</span><span class=o>-&gt;</span><span class=na>isPost</span><span class=p>())</span> <span class=p>{</span>
<a id=__codelineno-34-6 name=__codelineno-34-6 href=#__codelineno-34-6></a>        <span class=c1>// POST</span>
<a id=__codelineno-34-7 name=__codelineno-34-7 href=#__codelineno-34-7></a>    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
<a id=__codelineno-34-8 name=__codelineno-34-8 href=#__codelineno-34-8></a>        <span class=c1>// GET</span>
<a id=__codelineno-34-9 name=__codelineno-34-9 href=#__codelineno-34-9></a>    <span class=p>}</span>
<a id=__codelineno-34-10 name=__codelineno-34-10 href=#__codelineno-34-10></a>
<a id=__codelineno-34-11 name=__codelineno-34-11 href=#__codelineno-34-11></a>    <span class=c1>// ...</span>
<a id=__codelineno-34-12 name=__codelineno-34-12 href=#__codelineno-34-12></a><span class=p>}</span>
</code></pre></div> <p>With the help of <a href=../api/phalcon_mvc/#mvcmodelcriteria->Phalcon\Mvc\Model\Criteria</a>, we can create the search conditions based on the data types and values sent from the form:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-35-1 name=__codelineno-35-1 href=#__codelineno-35-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-35-2 name=__codelineno-35-2 href=#__codelineno-35-2></a>
<a id=__codelineno-35-3 name=__codelineno-35-3 href=#__codelineno-35-3></a><span class=nv>$query</span> <span class=o>=</span> <span class=nx>Criteria</span><span class=o>::</span><span class=na>fromInput</span><span class=p>(</span>
<a id=__codelineno-35-4 name=__codelineno-35-4 href=#__codelineno-35-4></a>    <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>di</span><span class=p>,</span>
<a id=__codelineno-35-5 name=__codelineno-35-5 href=#__codelineno-35-5></a>    <span class=s1>&#39;Products&#39;</span><span class=p>,</span>
<a id=__codelineno-35-6 name=__codelineno-35-6 href=#__codelineno-35-6></a>    <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>request</span><span class=o>-&gt;</span><span class=na>getPost</span><span class=p>()</span>
<a id=__codelineno-35-7 name=__codelineno-35-7 href=#__codelineno-35-7></a><span class=p>);</span>
</code></pre></div> <p>This method verifies which values are different from '' (empty string) and <code>null</code> and takes them into account to create the search criteria:</p> <ul> <li>If the field data type is <code>text</code> or similar (<code>char</code>, <code>varchar</code>, <code>text</code>, etc.) It uses an SQL <code>like</code> operator to filter the results.</li> <li>If the data type is not <code>text</code> or similar, it will use the operator <code>=</code>.</li> </ul> <p>Additionally, <code>Criteria</code> ignores all the <code>$_POST</code> variables that do not match any field in the table. Values are automatically escaped using <code>bound parameters</code>.</p> <p>Now, we store the produced parameters in the controller's session bag:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-36-1 name=__codelineno-36-1 href=#__codelineno-36-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-36-2 name=__codelineno-36-2 href=#__codelineno-36-2></a>
<a id=__codelineno-36-3 name=__codelineno-36-3 href=#__codelineno-36-3></a><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>persistent</span><span class=o>-&gt;</span><span class=na>searchParams</span> <span class=o>=</span> <span class=nv>$query</span><span class=o>-&gt;</span><span class=na>getParams</span><span class=p>();</span>
</code></pre></div> <p>A session bag, (<code>persistent</code> property) is a special attribute in a controller that persists data between requests using the session service. When accessed, this attribute injects a <a href=../session/#persistent-data>Phalcon\Session\Bag</a> instance that is independent in each controller.</p> <p>Then, based on the built params we perform the query:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-37-1 name=__codelineno-37-1 href=#__codelineno-37-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-37-2 name=__codelineno-37-2 href=#__codelineno-37-2></a>
<a id=__codelineno-37-3 name=__codelineno-37-3 href=#__codelineno-37-3></a><span class=nv>$products</span> <span class=o>=</span> <span class=nx>Products</span><span class=o>::</span><span class=na>find</span><span class=p>(</span><span class=nv>$parameters</span><span class=p>);</span>
<a id=__codelineno-37-4 name=__codelineno-37-4 href=#__codelineno-37-4></a>
<a id=__codelineno-37-5 name=__codelineno-37-5 href=#__codelineno-37-5></a><span class=k>if</span> <span class=p>(</span><span class=nb>count</span><span class=p>(</span><span class=nv>$products</span><span class=p>)</span> <span class=o>===</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-37-6 name=__codelineno-37-6 href=#__codelineno-37-6></a>    <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>flash</span><span class=o>-&gt;</span><span class=na>notice</span><span class=p>(</span>
<a id=__codelineno-37-7 name=__codelineno-37-7 href=#__codelineno-37-7></a>        <span class=s1>&#39;The search did not find any products&#39;</span>
<a id=__codelineno-37-8 name=__codelineno-37-8 href=#__codelineno-37-8></a>    <span class=p>);</span>
<a id=__codelineno-37-9 name=__codelineno-37-9 href=#__codelineno-37-9></a>
<a id=__codelineno-37-10 name=__codelineno-37-10 href=#__codelineno-37-10></a>    <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>dispatcher</span><span class=o>-&gt;</span><span class=na>forward</span><span class=p>(</span>
<a id=__codelineno-37-11 name=__codelineno-37-11 href=#__codelineno-37-11></a>        <span class=p>[</span>
<a id=__codelineno-37-12 name=__codelineno-37-12 href=#__codelineno-37-12></a>            <span class=s1>&#39;controller&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;products&#39;</span><span class=p>,</span>
<a id=__codelineno-37-13 name=__codelineno-37-13 href=#__codelineno-37-13></a>            <span class=s1>&#39;action&#39;</span>     <span class=o>=&gt;</span> <span class=s1>&#39;index&#39;</span><span class=p>,</span>
<a id=__codelineno-37-14 name=__codelineno-37-14 href=#__codelineno-37-14></a>        <span class=p>]</span>
<a id=__codelineno-37-15 name=__codelineno-37-15 href=#__codelineno-37-15></a>    <span class=p>);</span>
<a id=__codelineno-37-16 name=__codelineno-37-16 href=#__codelineno-37-16></a><span class=p>}</span>
</code></pre></div> <p>If the search does not return any product, we forward the user to the <code>index</code> action again. If the search returns results, we pass them to a paginator object so that we can navigate through chunks of resultsets:</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-38-1 name=__codelineno-38-1 href=#__codelineno-38-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-38-2 name=__codelineno-38-2 href=#__codelineno-38-2></a>
<a id=__codelineno-38-3 name=__codelineno-38-3 href=#__codelineno-38-3></a><span class=k>use</span> <span class=nx>Phalcon\Paginator\Adapter\Model</span> <span class=k>as</span> <span class=nx>Paginator</span><span class=p>;</span>
<a id=__codelineno-38-4 name=__codelineno-38-4 href=#__codelineno-38-4></a>
<a id=__codelineno-38-5 name=__codelineno-38-5 href=#__codelineno-38-5></a><span class=c1>// ...</span>
<a id=__codelineno-38-6 name=__codelineno-38-6 href=#__codelineno-38-6></a>
<a id=__codelineno-38-7 name=__codelineno-38-7 href=#__codelineno-38-7></a><span class=nv>$paginator</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Paginator</span><span class=p>(</span>
<a id=__codelineno-38-8 name=__codelineno-38-8 href=#__codelineno-38-8></a>    <span class=p>[</span>
<a id=__codelineno-38-9 name=__codelineno-38-9 href=#__codelineno-38-9></a>        <span class=s1>&#39;data&#39;</span>  <span class=o>=&gt;</span> <span class=nv>$products</span><span class=p>,</span>
<a id=__codelineno-38-10 name=__codelineno-38-10 href=#__codelineno-38-10></a>        <span class=s1>&#39;limit&#39;</span> <span class=o>=&gt;</span> <span class=mi>5</span><span class=p>,</span>
<a id=__codelineno-38-11 name=__codelineno-38-11 href=#__codelineno-38-11></a>        <span class=s1>&#39;page&#39;</span>  <span class=o>=&gt;</span> <span class=nv>$numberPage</span><span class=p>,</span>
<a id=__codelineno-38-12 name=__codelineno-38-12 href=#__codelineno-38-12></a>    <span class=p>]</span>
<a id=__codelineno-38-13 name=__codelineno-38-13 href=#__codelineno-38-13></a><span class=p>);</span>
<a id=__codelineno-38-14 name=__codelineno-38-14 href=#__codelineno-38-14></a>
<a id=__codelineno-38-15 name=__codelineno-38-15 href=#__codelineno-38-15></a><span class=nv>$page</span> <span class=o>=</span> <span class=nv>$paginator</span><span class=o>-&gt;</span><span class=na>paginate</span><span class=p>();</span>
</code></pre></div> The <a href=../db-pagination/ >paginator</a> object receives the results obtained by the search. We also set a limit (results per page) as well as the page number. Finally, we call <code>paginate()</code> to get the appropriate chunk of the resultset back.</p> <p>We then pass the returned page to view:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-39-1 name=__codelineno-39-1 href=#__codelineno-39-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-39-2 name=__codelineno-39-2 href=#__codelineno-39-2></a>
<a id=__codelineno-39-3 name=__codelineno-39-3 href=#__codelineno-39-3></a><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>view</span><span class=o>-&gt;</span><span class=na>page</span> <span class=o>=</span> <span class=nv>$page</span><span class=p>;</span>
</code></pre></div> <p>In the view (<code>themes/invo/products/search.volt</code>), we traverse the results corresponding to the current page, showing every row in the current page to the user:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-40-1 name=__codelineno-40-1 href=#__codelineno-40-1></a><span class=cp>{%</span> <span class=k>for</span> <span class=nv>product</span> <span class=k>in</span> <span class=nv>page.items</span> <span class=cp>%}</span>
<a id=__codelineno-40-2 name=__codelineno-40-2 href=#__codelineno-40-2></a><span class=x>    </span><span class=cp>{%</span> <span class=k>if</span> <span class=nb>loop</span><span class=nv>.first</span> <span class=cp>%}</span>
<a id=__codelineno-40-3 name=__codelineno-40-3 href=#__codelineno-40-3></a><span class=x>        &lt;table class=&quot;table table-bordered table-striped&quot; align=&quot;center&quot;&gt;</span>
<a id=__codelineno-40-4 name=__codelineno-40-4 href=#__codelineno-40-4></a><span class=x>        &lt;thead&gt;</span>
<a id=__codelineno-40-5 name=__codelineno-40-5 href=#__codelineno-40-5></a><span class=x>        &lt;tr&gt;</span>
<a id=__codelineno-40-6 name=__codelineno-40-6 href=#__codelineno-40-6></a><span class=x>            &lt;th&gt;Id&lt;/th&gt;</span>
<a id=__codelineno-40-7 name=__codelineno-40-7 href=#__codelineno-40-7></a><span class=x>            &lt;th&gt;Product Type&lt;/th&gt;</span>
<a id=__codelineno-40-8 name=__codelineno-40-8 href=#__codelineno-40-8></a><span class=x>            &lt;th&gt;Name&lt;/th&gt;</span>
<a id=__codelineno-40-9 name=__codelineno-40-9 href=#__codelineno-40-9></a><span class=x>            &lt;th&gt;Price&lt;/th&gt;</span>
<a id=__codelineno-40-10 name=__codelineno-40-10 href=#__codelineno-40-10></a><span class=x>            &lt;th&gt;Active&lt;/th&gt;</span>
<a id=__codelineno-40-11 name=__codelineno-40-11 href=#__codelineno-40-11></a><span class=x>        &lt;/tr&gt;</span>
<a id=__codelineno-40-12 name=__codelineno-40-12 href=#__codelineno-40-12></a><span class=x>        &lt;/thead&gt;</span>
<a id=__codelineno-40-13 name=__codelineno-40-13 href=#__codelineno-40-13></a><span class=x>        &lt;tbody&gt;</span>
<a id=__codelineno-40-14 name=__codelineno-40-14 href=#__codelineno-40-14></a><span class=x>    </span><span class=cp>{%</span> <span class=k>endif</span> <span class=cp>%}</span>
<a id=__codelineno-40-15 name=__codelineno-40-15 href=#__codelineno-40-15></a><span class=x>    &lt;tr&gt;</span>
<a id=__codelineno-40-16 name=__codelineno-40-16 href=#__codelineno-40-16></a><span class=x>        &lt;td&gt;</span><span class=cp>{{</span> <span class=nv>product.id</span> <span class=cp>}}</span><span class=x>&lt;/td&gt;</span>
<a id=__codelineno-40-17 name=__codelineno-40-17 href=#__codelineno-40-17></a><span class=x>        &lt;td&gt;</span><span class=cp>{{</span> <span class=nv>product.getProductTypes</span><span class=o>()</span><span class=nv>.name</span> <span class=cp>}}</span><span class=x>&lt;/td&gt;</span>
<a id=__codelineno-40-18 name=__codelineno-40-18 href=#__codelineno-40-18></a><span class=x>        &lt;td&gt;</span><span class=cp>{{</span> <span class=nv>product.name</span> <span class=cp>}}</span><span class=x>&lt;/td&gt;</span>
<a id=__codelineno-40-19 name=__codelineno-40-19 href=#__codelineno-40-19></a><span class=x>        &lt;td&gt;$</span><span class=cp>{{</span> <span class=s2>&quot;%.2f&quot;</span><span class=o>|</span><span class=nf>format</span><span class=o>(</span><span class=nv>product.price</span><span class=o>)</span> <span class=cp>}}</span><span class=x>&lt;/td&gt;</span>
<a id=__codelineno-40-20 name=__codelineno-40-20 href=#__codelineno-40-20></a><span class=x>        &lt;td&gt;</span><span class=cp>{{</span> <span class=nv>product.getActiveDetail</span><span class=o>()</span> <span class=cp>}}</span><span class=x>&lt;/td&gt;</span>
<a id=__codelineno-40-21 name=__codelineno-40-21 href=#__codelineno-40-21></a><span class=x>        &lt;td width=&quot;7%&quot;&gt;</span>
<a id=__codelineno-40-22 name=__codelineno-40-22 href=#__codelineno-40-22></a><span class=x>            </span><span class=cp>{{</span> 
<a id=__codelineno-40-23 name=__codelineno-40-23 href=#__codelineno-40-23></a>                <span class=nv>link_to</span><span class=o>(</span>
<a id=__codelineno-40-24 name=__codelineno-40-24 href=#__codelineno-40-24></a>                    <span class=s2>&quot;products/edit/&quot;</span> <span class=o>~</span> <span class=nv>product.id</span><span class=o>,</span> 
<a id=__codelineno-40-25 name=__codelineno-40-25 href=#__codelineno-40-25></a>                    <span class=s1>&#39;&lt;i class=&quot;glyphicon glyphicon-edit&quot;&gt;&lt;/i&gt; Edit&#39;</span><span class=o>,</span> 
<a id=__codelineno-40-26 name=__codelineno-40-26 href=#__codelineno-40-26></a>                    <span class=s2>&quot;class&quot;</span><span class=o>:</span> <span class=s2>&quot;btn btn-default&quot;</span>
<a id=__codelineno-40-27 name=__codelineno-40-27 href=#__codelineno-40-27></a>                <span class=o>)</span> 
<a id=__codelineno-40-28 name=__codelineno-40-28 href=#__codelineno-40-28></a>            <span class=cp>}}</span>
<a id=__codelineno-40-29 name=__codelineno-40-29 href=#__codelineno-40-29></a><span class=x>        &lt;/td&gt;</span>
<a id=__codelineno-40-30 name=__codelineno-40-30 href=#__codelineno-40-30></a><span class=x>        &lt;td width=&quot;7%&quot;&gt;</span>
<a id=__codelineno-40-31 name=__codelineno-40-31 href=#__codelineno-40-31></a><span class=x>            </span><span class=cp>{{</span> 
<a id=__codelineno-40-32 name=__codelineno-40-32 href=#__codelineno-40-32></a>                <span class=nv>link_to</span><span class=o>(</span>
<a id=__codelineno-40-33 name=__codelineno-40-33 href=#__codelineno-40-33></a>                    <span class=s2>&quot;products/delete/&quot;</span> <span class=o>~</span> <span class=nv>product.id</span><span class=o>,</span> 
<a id=__codelineno-40-34 name=__codelineno-40-34 href=#__codelineno-40-34></a>                    <span class=s1>&#39;&lt;i class=&quot;glyphicon glyphicon-remove&quot;&gt;&lt;/i&gt; Delete&#39;</span><span class=o>,</span> 
<a id=__codelineno-40-35 name=__codelineno-40-35 href=#__codelineno-40-35></a>                    <span class=s2>&quot;class&quot;</span><span class=o>:</span> <span class=s2>&quot;btn btn-default&quot;</span>
<a id=__codelineno-40-36 name=__codelineno-40-36 href=#__codelineno-40-36></a>                <span class=o>)</span> 
<a id=__codelineno-40-37 name=__codelineno-40-37 href=#__codelineno-40-37></a>            <span class=cp>}}</span>
<a id=__codelineno-40-38 name=__codelineno-40-38 href=#__codelineno-40-38></a><span class=x>        &lt;/td&gt;</span>
<a id=__codelineno-40-39 name=__codelineno-40-39 href=#__codelineno-40-39></a><span class=x>    &lt;/tr&gt;</span>
<a id=__codelineno-40-40 name=__codelineno-40-40 href=#__codelineno-40-40></a><span class=x>    </span><span class=cp>{%</span> <span class=k>if</span> <span class=nb>loop</span><span class=nv>.last</span> <span class=cp>%}</span>
<a id=__codelineno-40-41 name=__codelineno-40-41 href=#__codelineno-40-41></a><span class=x>        &lt;/tbody&gt;</span>
<a id=__codelineno-40-42 name=__codelineno-40-42 href=#__codelineno-40-42></a><span class=x>        &lt;tbody&gt;</span>
<a id=__codelineno-40-43 name=__codelineno-40-43 href=#__codelineno-40-43></a><span class=x>        &lt;tr&gt;</span>
<a id=__codelineno-40-44 name=__codelineno-40-44 href=#__codelineno-40-44></a><span class=x>            &lt;td colspan=&quot;7&quot; align=&quot;right&quot;&gt;</span>
<a id=__codelineno-40-45 name=__codelineno-40-45 href=#__codelineno-40-45></a><span class=x>                &lt;div class=&quot;btn-group&quot;&gt;</span>
<a id=__codelineno-40-46 name=__codelineno-40-46 href=#__codelineno-40-46></a><span class=x>                    </span><span class=cp>{{</span> 
<a id=__codelineno-40-47 name=__codelineno-40-47 href=#__codelineno-40-47></a>                        <span class=nv>link_to</span><span class=o>(</span>
<a id=__codelineno-40-48 name=__codelineno-40-48 href=#__codelineno-40-48></a>                            <span class=s2>&quot;products/search&quot;</span><span class=o>,</span> 
<a id=__codelineno-40-49 name=__codelineno-40-49 href=#__codelineno-40-49></a>                            <span class=s1>&#39;&lt;i class=&quot;icon-fast-backward&quot;&gt;&lt;/i&gt; First&#39;</span><span class=o>,</span> 
<a id=__codelineno-40-50 name=__codelineno-40-50 href=#__codelineno-40-50></a>                            <span class=s2>&quot;class&quot;</span><span class=o>:</span> <span class=s2>&quot;btn&quot;</span>
<a id=__codelineno-40-51 name=__codelineno-40-51 href=#__codelineno-40-51></a>                        <span class=o>)</span> 
<a id=__codelineno-40-52 name=__codelineno-40-52 href=#__codelineno-40-52></a>                    <span class=cp>}}</span>
<a id=__codelineno-40-53 name=__codelineno-40-53 href=#__codelineno-40-53></a><span class=x>                    </span><span class=cp>{{</span> 
<a id=__codelineno-40-54 name=__codelineno-40-54 href=#__codelineno-40-54></a>                        <span class=nv>link_to</span><span class=o>(</span>
<a id=__codelineno-40-55 name=__codelineno-40-55 href=#__codelineno-40-55></a>                            <span class=s2>&quot;products/search?page=&quot;</span> <span class=o>~</span> <span class=nv>page.before</span><span class=o>,</span> 
<a id=__codelineno-40-56 name=__codelineno-40-56 href=#__codelineno-40-56></a>                            <span class=s1>&#39;&lt;i class=&quot;icon-step-backward&quot;&gt;&lt;/i&gt; Previous&#39;</span><span class=o>,</span> 
<a id=__codelineno-40-57 name=__codelineno-40-57 href=#__codelineno-40-57></a>                            <span class=s2>&quot;class&quot;</span><span class=o>:</span> <span class=s2>&quot;btn&quot;</span>
<a id=__codelineno-40-58 name=__codelineno-40-58 href=#__codelineno-40-58></a>                        <span class=o>)</span> 
<a id=__codelineno-40-59 name=__codelineno-40-59 href=#__codelineno-40-59></a>                    <span class=cp>}}</span>
<a id=__codelineno-40-60 name=__codelineno-40-60 href=#__codelineno-40-60></a><span class=x>                    </span><span class=cp>{{</span> 
<a id=__codelineno-40-61 name=__codelineno-40-61 href=#__codelineno-40-61></a>                        <span class=nv>link_to</span><span class=o>(</span>
<a id=__codelineno-40-62 name=__codelineno-40-62 href=#__codelineno-40-62></a>                            <span class=s2>&quot;products/search?page=&quot;</span> <span class=o>~</span> <span class=nv>page.next</span><span class=o>,</span> 
<a id=__codelineno-40-63 name=__codelineno-40-63 href=#__codelineno-40-63></a>                            <span class=s1>&#39;&lt;i class=&quot;icon-step-forward&quot;&gt;&lt;/i&gt; Next&#39;</span><span class=o>,</span> 
<a id=__codelineno-40-64 name=__codelineno-40-64 href=#__codelineno-40-64></a>                            <span class=s2>&quot;class&quot;</span><span class=o>:</span> <span class=s2>&quot;btn&quot;</span>
<a id=__codelineno-40-65 name=__codelineno-40-65 href=#__codelineno-40-65></a>                        <span class=o>)</span> 
<a id=__codelineno-40-66 name=__codelineno-40-66 href=#__codelineno-40-66></a>                    <span class=cp>}}</span>
<a id=__codelineno-40-67 name=__codelineno-40-67 href=#__codelineno-40-67></a><span class=x>                    </span><span class=cp>{{</span> 
<a id=__codelineno-40-68 name=__codelineno-40-68 href=#__codelineno-40-68></a>                        <span class=nv>link_to</span><span class=o>(</span>
<a id=__codelineno-40-69 name=__codelineno-40-69 href=#__codelineno-40-69></a>                            <span class=s2>&quot;products/search?page=&quot;</span> <span class=o>~</span> <span class=nv>page.last</span><span class=o>,</span> 
<a id=__codelineno-40-70 name=__codelineno-40-70 href=#__codelineno-40-70></a>                            <span class=s1>&#39;&lt;i class=&quot;icon-fast-forward&quot;&gt;&lt;/i&gt; Last&#39;</span><span class=o>,</span> 
<a id=__codelineno-40-71 name=__codelineno-40-71 href=#__codelineno-40-71></a>                            <span class=s2>&quot;class&quot;</span><span class=o>:</span> <span class=s2>&quot;btn&quot;</span>
<a id=__codelineno-40-72 name=__codelineno-40-72 href=#__codelineno-40-72></a>                        <span class=o>)</span> 
<a id=__codelineno-40-73 name=__codelineno-40-73 href=#__codelineno-40-73></a>                    <span class=cp>}}</span>
<a id=__codelineno-40-74 name=__codelineno-40-74 href=#__codelineno-40-74></a><span class=x>                    &lt;span class=&quot;help-inline&quot;&gt;</span>
<a id=__codelineno-40-75 name=__codelineno-40-75 href=#__codelineno-40-75></a><span class=x>                        </span><span class=cp>{{</span> <span class=nv>page.current</span> <span class=cp>}}</span><span class=x> of </span><span class=cp>{{</span> <span class=nv>page.total_pages</span> <span class=cp>}}</span>
<a id=__codelineno-40-76 name=__codelineno-40-76 href=#__codelineno-40-76></a><span class=x>                    &lt;/span&gt;</span>
<a id=__codelineno-40-77 name=__codelineno-40-77 href=#__codelineno-40-77></a><span class=x>                &lt;/div&gt;</span>
<a id=__codelineno-40-78 name=__codelineno-40-78 href=#__codelineno-40-78></a><span class=x>            &lt;/td&gt;</span>
<a id=__codelineno-40-79 name=__codelineno-40-79 href=#__codelineno-40-79></a><span class=x>        &lt;/tr&gt;</span>
<a id=__codelineno-40-80 name=__codelineno-40-80 href=#__codelineno-40-80></a><span class=x>        &lt;/tbody&gt;</span>
<a id=__codelineno-40-81 name=__codelineno-40-81 href=#__codelineno-40-81></a><span class=x>        &lt;/table&gt;</span>
<a id=__codelineno-40-82 name=__codelineno-40-82 href=#__codelineno-40-82></a><span class=x>    </span><span class=cp>{%</span> <span class=k>endif</span> <span class=cp>%}</span>
<a id=__codelineno-40-83 name=__codelineno-40-83 href=#__codelineno-40-83></a><span class=cp>{%</span> <span class=k>else</span> <span class=cp>%}</span>
<a id=__codelineno-40-84 name=__codelineno-40-84 href=#__codelineno-40-84></a><span class=x>    No products are recorded</span>
<a id=__codelineno-40-85 name=__codelineno-40-85 href=#__codelineno-40-85></a><span class=cp>{%</span> <span class=k>endfor</span> <span class=cp>%}</span>
</code></pre></div> <p>Looking at the code above it is worth mentioning:</p> <p>The active items in the current page are traversed using a Volt's <code>for</code>. Volt provides a simpler syntax for a PHP <code>foreach</code>.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-41-1 name=__codelineno-41-1 href=#__codelineno-41-1></a><span class=cp>{%</span> <span class=k>for</span> <span class=nv>product</span> <span class=k>in</span> <span class=nv>page.items</span> <span class=cp>%}</span>
</code></pre></div> <p>Which in PHP is the same as:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-42-1 name=__codelineno-42-1 href=#__codelineno-42-1></a><span class=o>&lt;?</span><span class=nx>php</span> <span class=k>foreach</span> <span class=p>(</span><span class=nv>$page</span><span class=o>-&gt;</span><span class=na>items</span> <span class=k>as</span> <span class=nv>$product</span><span class=p>)</span> <span class=p>{</span> <span class=cp>?&gt;</span>
</code></pre></div> <p>The whole <code>for</code> block is:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-43-1 name=__codelineno-43-1 href=#__codelineno-43-1></a><span class=cp>{%</span> <span class=k>for</span> <span class=nv>product</span> <span class=k>in</span> <span class=nv>page.items</span> <span class=cp>%}</span>
<a id=__codelineno-43-2 name=__codelineno-43-2 href=#__codelineno-43-2></a><span class=x>    </span><span class=cp>{%</span> <span class=k>if</span> <span class=nb>loop</span><span class=nv>.first</span> <span class=cp>%}</span>
<a id=__codelineno-43-3 name=__codelineno-43-3 href=#__codelineno-43-3></a><span class=x>        // Executed before the first product in the loop</span>
<a id=__codelineno-43-4 name=__codelineno-43-4 href=#__codelineno-43-4></a><span class=x>    </span><span class=cp>{%</span> <span class=k>endif</span> <span class=cp>%}</span>
<a id=__codelineno-43-5 name=__codelineno-43-5 href=#__codelineno-43-5></a>
<a id=__codelineno-43-6 name=__codelineno-43-6 href=#__codelineno-43-6></a><span class=x>    // Executed for every product on `page.items`</span>
<a id=__codelineno-43-7 name=__codelineno-43-7 href=#__codelineno-43-7></a>
<a id=__codelineno-43-8 name=__codelineno-43-8 href=#__codelineno-43-8></a><span class=x>    </span><span class=cp>{%</span> <span class=k>if</span> <span class=nb>loop</span><span class=nv>.last</span> <span class=cp>%}</span>
<a id=__codelineno-43-9 name=__codelineno-43-9 href=#__codelineno-43-9></a><span class=x>        // Executed after the last product in the loop</span>
<a id=__codelineno-43-10 name=__codelineno-43-10 href=#__codelineno-43-10></a><span class=x>    </span><span class=cp>{%</span> <span class=k>endif</span> <span class=cp>%}</span>
<a id=__codelineno-43-11 name=__codelineno-43-11 href=#__codelineno-43-11></a><span class=cp>{%</span> <span class=k>else</span> <span class=cp>%}</span>
<a id=__codelineno-43-12 name=__codelineno-43-12 href=#__codelineno-43-12></a><span class=x>    // Executed if `page.items` does not have any products</span>
<a id=__codelineno-43-13 name=__codelineno-43-13 href=#__codelineno-43-13></a><span class=cp>{%</span> <span class=k>endfor</span> <span class=cp>%}</span>
</code></pre></div> <p>Now you can go back to the view and find out what every block is doing. Every field in <code>product</code> is printed accordingly:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-44-1 name=__codelineno-44-1 href=#__codelineno-44-1></a><span class=x>&lt;tr&gt;</span>
<a id=__codelineno-44-2 name=__codelineno-44-2 href=#__codelineno-44-2></a><span class=x>    &lt;td&gt;</span>
<a id=__codelineno-44-3 name=__codelineno-44-3 href=#__codelineno-44-3></a><span class=x>        </span><span class=cp>{{</span> <span class=nv>product.id</span> <span class=cp>}}</span>
<a id=__codelineno-44-4 name=__codelineno-44-4 href=#__codelineno-44-4></a><span class=x>    &lt;/td&gt;</span>
<a id=__codelineno-44-5 name=__codelineno-44-5 href=#__codelineno-44-5></a>
<a id=__codelineno-44-6 name=__codelineno-44-6 href=#__codelineno-44-6></a><span class=x>    &lt;td&gt;</span>
<a id=__codelineno-44-7 name=__codelineno-44-7 href=#__codelineno-44-7></a><span class=x>        </span><span class=cp>{{</span> <span class=nv>product.getProductTypes</span><span class=o>()</span><span class=nv>.name</span> <span class=cp>}}</span>
<a id=__codelineno-44-8 name=__codelineno-44-8 href=#__codelineno-44-8></a><span class=x>    &lt;/td&gt;</span>
<a id=__codelineno-44-9 name=__codelineno-44-9 href=#__codelineno-44-9></a>
<a id=__codelineno-44-10 name=__codelineno-44-10 href=#__codelineno-44-10></a><span class=x>    &lt;td&gt;</span>
<a id=__codelineno-44-11 name=__codelineno-44-11 href=#__codelineno-44-11></a><span class=x>        </span><span class=cp>{{</span> <span class=nv>product.name</span> <span class=cp>}}</span>
<a id=__codelineno-44-12 name=__codelineno-44-12 href=#__codelineno-44-12></a><span class=x>    &lt;/td&gt;</span>
<a id=__codelineno-44-13 name=__codelineno-44-13 href=#__codelineno-44-13></a>
<a id=__codelineno-44-14 name=__codelineno-44-14 href=#__codelineno-44-14></a><span class=x>    &lt;td&gt;</span>
<a id=__codelineno-44-15 name=__codelineno-44-15 href=#__codelineno-44-15></a><span class=x>        </span><span class=cp>{{</span> <span class=s1>&#39;%.2f&#39;</span><span class=o>|</span><span class=nf>format</span><span class=o>(</span><span class=nv>product.price</span><span class=o>)</span> <span class=cp>}}</span>
<a id=__codelineno-44-16 name=__codelineno-44-16 href=#__codelineno-44-16></a><span class=x>    &lt;/td&gt;</span>
<a id=__codelineno-44-17 name=__codelineno-44-17 href=#__codelineno-44-17></a>
<a id=__codelineno-44-18 name=__codelineno-44-18 href=#__codelineno-44-18></a><span class=x>    &lt;td&gt;</span>
<a id=__codelineno-44-19 name=__codelineno-44-19 href=#__codelineno-44-19></a><span class=x>        </span><span class=cp>{{</span> <span class=nv>product.getActiveDetail</span><span class=o>()</span> <span class=cp>}}</span>
<a id=__codelineno-44-20 name=__codelineno-44-20 href=#__codelineno-44-20></a><span class=x>    &lt;/td&gt;</span>
<a id=__codelineno-44-21 name=__codelineno-44-21 href=#__codelineno-44-21></a>
<a id=__codelineno-44-22 name=__codelineno-44-22 href=#__codelineno-44-22></a><span class=x>    &lt;td width=&#39;7%&#39;&gt;</span>
<a id=__codelineno-44-23 name=__codelineno-44-23 href=#__codelineno-44-23></a><span class=x>        </span><span class=cp>{{</span> <span class=nv>link_to</span><span class=o>(</span><span class=s1>&#39;products/edit/&#39;</span> <span class=o>~</span> <span class=nv>product.id</span><span class=o>,</span> <span class=s1>&#39;Edit&#39;</span><span class=o>)</span> <span class=cp>}}</span>
<a id=__codelineno-44-24 name=__codelineno-44-24 href=#__codelineno-44-24></a><span class=x>    &lt;/td&gt;</span>
<a id=__codelineno-44-25 name=__codelineno-44-25 href=#__codelineno-44-25></a>
<a id=__codelineno-44-26 name=__codelineno-44-26 href=#__codelineno-44-26></a><span class=x>    &lt;td width=&#39;7%&#39;&gt;</span>
<a id=__codelineno-44-27 name=__codelineno-44-27 href=#__codelineno-44-27></a><span class=x>        </span><span class=cp>{{</span> <span class=nv>link_to</span><span class=o>(</span><span class=s1>&#39;products/delete/&#39;</span> <span class=o>~</span> <span class=nv>product.id</span><span class=o>,</span> <span class=s1>&#39;Delete&#39;</span><span class=o>)</span> <span class=cp>}}</span>
<a id=__codelineno-44-28 name=__codelineno-44-28 href=#__codelineno-44-28></a><span class=x>    &lt;/td&gt;</span>
<a id=__codelineno-44-29 name=__codelineno-44-29 href=#__codelineno-44-29></a><span class=x>&lt;/tr&gt;</span>
</code></pre></div> <p>As we have seen before using <code>product.id</code> is the same as in PHP as doing: <code>$product-&gt;id</code>, we made the same with <code>product.name</code> and so on. Other fields are rendered differently, for instance, let's focus in <code>product.getProductTypes().name</code>. To understand this part, we have to check the Products model (<code>app/models/Products.php</code>):</p> <div class=highlight><pre><span></span><code><a id=__codelineno-45-1 name=__codelineno-45-1 href=#__codelineno-45-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-45-2 name=__codelineno-45-2 href=#__codelineno-45-2></a>
<a id=__codelineno-45-3 name=__codelineno-45-3 href=#__codelineno-45-3></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Model</span><span class=p>;</span>
<a id=__codelineno-45-4 name=__codelineno-45-4 href=#__codelineno-45-4></a>
<a id=__codelineno-45-5 name=__codelineno-45-5 href=#__codelineno-45-5></a><span class=sd>/**</span>
<a id=__codelineno-45-6 name=__codelineno-45-6 href=#__codelineno-45-6></a><span class=sd> * Products</span>
<a id=__codelineno-45-7 name=__codelineno-45-7 href=#__codelineno-45-7></a><span class=sd> */</span>
<a id=__codelineno-45-8 name=__codelineno-45-8 href=#__codelineno-45-8></a><span class=k>class</span> <span class=nc>Products</span> <span class=k>extends</span> <span class=nx>Model</span>
<a id=__codelineno-45-9 name=__codelineno-45-9 href=#__codelineno-45-9></a><span class=p>{</span>
<a id=__codelineno-45-10 name=__codelineno-45-10 href=#__codelineno-45-10></a>    <span class=c1>// ...</span>
<a id=__codelineno-45-11 name=__codelineno-45-11 href=#__codelineno-45-11></a>
<a id=__codelineno-45-12 name=__codelineno-45-12 href=#__codelineno-45-12></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>initialize</span><span class=p>()</span>
<a id=__codelineno-45-13 name=__codelineno-45-13 href=#__codelineno-45-13></a>    <span class=p>{</span>
<a id=__codelineno-45-14 name=__codelineno-45-14 href=#__codelineno-45-14></a>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>belongsTo</span><span class=p>(</span>
<a id=__codelineno-45-15 name=__codelineno-45-15 href=#__codelineno-45-15></a>            <span class=s1>&#39;product_types_id&#39;</span><span class=p>,</span>
<a id=__codelineno-45-16 name=__codelineno-45-16 href=#__codelineno-45-16></a>            <span class=s1>&#39;ProductTypes&#39;</span><span class=p>,</span>
<a id=__codelineno-45-17 name=__codelineno-45-17 href=#__codelineno-45-17></a>            <span class=s1>&#39;id&#39;</span><span class=p>,</span>
<a id=__codelineno-45-18 name=__codelineno-45-18 href=#__codelineno-45-18></a>            <span class=p>[</span>
<a id=__codelineno-45-19 name=__codelineno-45-19 href=#__codelineno-45-19></a>                <span class=s1>&#39;reusable&#39;</span> <span class=o>=&gt;</span> <span class=k>true</span><span class=p>,</span>
<a id=__codelineno-45-20 name=__codelineno-45-20 href=#__codelineno-45-20></a>            <span class=p>]</span>
<a id=__codelineno-45-21 name=__codelineno-45-21 href=#__codelineno-45-21></a>        <span class=p>);</span>
<a id=__codelineno-45-22 name=__codelineno-45-22 href=#__codelineno-45-22></a>    <span class=p>}</span>
<a id=__codelineno-45-23 name=__codelineno-45-23 href=#__codelineno-45-23></a>
<a id=__codelineno-45-24 name=__codelineno-45-24 href=#__codelineno-45-24></a>    <span class=c1>// ...</span>
<a id=__codelineno-45-25 name=__codelineno-45-25 href=#__codelineno-45-25></a><span class=p>}</span>
</code></pre></div> <p>A model can have a method called <code>initialize()</code>, this method is called once per request, and it serves the ORM to initialize a model. In this case, <code>Products</code> is initialized by defining that this model has a one-to-many relationship to another model called <code>ProductTypes</code>.</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-46-1 name=__codelineno-46-1 href=#__codelineno-46-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-46-2 name=__codelineno-46-2 href=#__codelineno-46-2></a>
<a id=__codelineno-46-3 name=__codelineno-46-3 href=#__codelineno-46-3></a><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>belongsTo</span><span class=p>(</span>
<a id=__codelineno-46-4 name=__codelineno-46-4 href=#__codelineno-46-4></a>    <span class=s1>&#39;product_types_id&#39;</span><span class=p>,</span>
<a id=__codelineno-46-5 name=__codelineno-46-5 href=#__codelineno-46-5></a>    <span class=s1>&#39;ProductTypes&#39;</span><span class=p>,</span>
<a id=__codelineno-46-6 name=__codelineno-46-6 href=#__codelineno-46-6></a>    <span class=s1>&#39;id&#39;</span><span class=p>,</span>
<a id=__codelineno-46-7 name=__codelineno-46-7 href=#__codelineno-46-7></a>    <span class=p>[</span>
<a id=__codelineno-46-8 name=__codelineno-46-8 href=#__codelineno-46-8></a>        <span class=s1>&#39;reusable&#39;</span> <span class=o>=&gt;</span> <span class=k>true</span><span class=p>,</span>
<a id=__codelineno-46-9 name=__codelineno-46-9 href=#__codelineno-46-9></a>    <span class=p>]</span>
<a id=__codelineno-46-10 name=__codelineno-46-10 href=#__codelineno-46-10></a><span class=p>);</span>
</code></pre></div> This means, the local attribute <code>product_types_id</code> in <code>Products</code> has a one-to-many relation to the <code>ProductTypes</code> model in its attribute <code>id</code>. By defining this relationship we can access the name of the product type by using:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-47-1 name=__codelineno-47-1 href=#__codelineno-47-1></a><span class=x>&lt;td&gt;</span><span class=cp>{{</span> <span class=nv>product.getProductTypes</span><span class=o>()</span><span class=nv>.name</span> <span class=cp>}}</span><span class=x>&lt;/td&gt;</span>
</code></pre></div> <p>The field <code>price</code> is printed by its formatted using a Volt filter:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-48-1 name=__codelineno-48-1 href=#__codelineno-48-1></a><span class=x>&lt;td&gt;</span><span class=cp>{{</span> <span class=s1>&#39;%.2f&#39;</span> <span class=o>|</span> <span class=nf>format</span><span class=o>(</span><span class=nv>product.price</span><span class=o>)</span> <span class=cp>}}</span><span class=x>&lt;/td&gt;</span>
</code></pre></div> <p>In plain PHP, this would be:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-49-1 name=__codelineno-49-1 href=#__codelineno-49-1></a><span class=o>&lt;?</span><span class=nx>php</span> <span class=k>echo</span> <span class=nb>sprintf</span><span class=p>(</span><span class=s1>&#39;%.2f&#39;</span><span class=p>,</span> <span class=nv>$product</span><span class=o>-&gt;</span><span class=na>price</span><span class=p>)</span> <span class=cp>?&gt;</span>
</code></pre></div> <p>Printing whether the product is active or not uses a helper method:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-50-1 name=__codelineno-50-1 href=#__codelineno-50-1></a><span class=o>&lt;</span><span class=nx>td</span><span class=o>&gt;</span><span class=p>{{</span> <span class=nx>product</span><span class=o>.</span><span class=nx>getActiveDetail</span><span class=p>()</span> <span class=p>}}</span><span class=o>&lt;/</span><span class=nx>td</span><span class=o>&gt;</span>
</code></pre></div> <p>This method is implemented in the model.</p> <h2 id=createupdate>Create/Update<a class=headerlink href=#createupdate title="Permanent link">&para;</a></h2> <p>When creating and updating records, we use the <code>new</code> and <code>edit</code> views. The data entered by the user is sent to the <code>create</code> and <code>save</code> actions that perform actions of <em>creating</em> and <em>updating</em> products, respectively.</p> <p>In the creation case, we get the data submitted and assign them to a new <code>Products</code> instance:</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-51-1 name=__codelineno-51-1 href=#__codelineno-51-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-51-2 name=__codelineno-51-2 href=#__codelineno-51-2></a>
<a id=__codelineno-51-3 name=__codelineno-51-3 href=#__codelineno-51-3></a><span class=k>public</span> <span class=k>function</span> <span class=nf>createAction</span><span class=p>()</span>
<a id=__codelineno-51-4 name=__codelineno-51-4 href=#__codelineno-51-4></a><span class=p>{</span>
<a id=__codelineno-51-5 name=__codelineno-51-5 href=#__codelineno-51-5></a>    <span class=k>if</span> <span class=p>(</span><span class=k>true</span> <span class=o>!==</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>request</span><span class=o>-&gt;</span><span class=na>isPost</span><span class=p>())</span> <span class=p>{</span>
<a id=__codelineno-51-6 name=__codelineno-51-6 href=#__codelineno-51-6></a>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>dispatcher</span><span class=o>-&gt;</span><span class=na>forward</span><span class=p>(</span>
<a id=__codelineno-51-7 name=__codelineno-51-7 href=#__codelineno-51-7></a>            <span class=p>[</span>
<a id=__codelineno-51-8 name=__codelineno-51-8 href=#__codelineno-51-8></a>                <span class=s1>&#39;controller&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;products&#39;</span><span class=p>,</span>
<a id=__codelineno-51-9 name=__codelineno-51-9 href=#__codelineno-51-9></a>                <span class=s1>&#39;action&#39;</span>     <span class=o>=&gt;</span> <span class=s1>&#39;index&#39;</span><span class=p>,</span>
<a id=__codelineno-51-10 name=__codelineno-51-10 href=#__codelineno-51-10></a>            <span class=p>]</span>
<a id=__codelineno-51-11 name=__codelineno-51-11 href=#__codelineno-51-11></a>        <span class=p>);</span>
<a id=__codelineno-51-12 name=__codelineno-51-12 href=#__codelineno-51-12></a>    <span class=p>}</span>
<a id=__codelineno-51-13 name=__codelineno-51-13 href=#__codelineno-51-13></a>
<a id=__codelineno-51-14 name=__codelineno-51-14 href=#__codelineno-51-14></a>    <span class=nv>$form</span>    <span class=o>=</span> <span class=k>new</span> <span class=nx>ProductsForm</span><span class=p>();</span>
<a id=__codelineno-51-15 name=__codelineno-51-15 href=#__codelineno-51-15></a>    <span class=nv>$product</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Products</span><span class=p>();</span>
<a id=__codelineno-51-16 name=__codelineno-51-16 href=#__codelineno-51-16></a>
<a id=__codelineno-51-17 name=__codelineno-51-17 href=#__codelineno-51-17></a>    <span class=nv>$product</span><span class=o>-&gt;</span><span class=na>id</span> <span class=o>=</span> <span class=nv>$this</span>
<a id=__codelineno-51-18 name=__codelineno-51-18 href=#__codelineno-51-18></a>        <span class=o>-&gt;</span><span class=na>request</span>
<a id=__codelineno-51-19 name=__codelineno-51-19 href=#__codelineno-51-19></a>        <span class=o>-&gt;</span><span class=na>getPost</span><span class=p>(</span><span class=s1>&#39;id&#39;</span><span class=p>,</span> <span class=s1>&#39;int&#39;</span><span class=p>)</span>
<a id=__codelineno-51-20 name=__codelineno-51-20 href=#__codelineno-51-20></a>    <span class=p>;</span>
<a id=__codelineno-51-21 name=__codelineno-51-21 href=#__codelineno-51-21></a>
<a id=__codelineno-51-22 name=__codelineno-51-22 href=#__codelineno-51-22></a>    <span class=nv>$product</span><span class=o>-&gt;</span><span class=na>product_types_id</span> <span class=o>=</span> <span class=nv>$this</span>
<a id=__codelineno-51-23 name=__codelineno-51-23 href=#__codelineno-51-23></a>        <span class=o>-&gt;</span><span class=na>request</span>
<a id=__codelineno-51-24 name=__codelineno-51-24 href=#__codelineno-51-24></a>        <span class=o>-&gt;</span><span class=na>getPost</span><span class=p>(</span><span class=s1>&#39;product_types_id&#39;</span><span class=p>,</span> <span class=s1>&#39;int&#39;</span><span class=p>)</span>
<a id=__codelineno-51-25 name=__codelineno-51-25 href=#__codelineno-51-25></a>    <span class=p>;</span>
<a id=__codelineno-51-26 name=__codelineno-51-26 href=#__codelineno-51-26></a>
<a id=__codelineno-51-27 name=__codelineno-51-27 href=#__codelineno-51-27></a>    <span class=nv>$product</span><span class=o>-&gt;</span><span class=na>name</span> <span class=o>=</span> <span class=nv>$this</span>
<a id=__codelineno-51-28 name=__codelineno-51-28 href=#__codelineno-51-28></a>        <span class=o>-&gt;</span><span class=na>request</span>
<a id=__codelineno-51-29 name=__codelineno-51-29 href=#__codelineno-51-29></a>        <span class=o>-&gt;</span><span class=na>getPost</span><span class=p>(</span><span class=s1>&#39;name&#39;</span><span class=p>,</span> <span class=s1>&#39;striptags&#39;</span><span class=p>)</span>
<a id=__codelineno-51-30 name=__codelineno-51-30 href=#__codelineno-51-30></a>    <span class=p>;</span>
<a id=__codelineno-51-31 name=__codelineno-51-31 href=#__codelineno-51-31></a>
<a id=__codelineno-51-32 name=__codelineno-51-32 href=#__codelineno-51-32></a>    <span class=nv>$product</span><span class=o>-&gt;</span><span class=na>price</span> <span class=o>=</span> <span class=nv>$this</span>
<a id=__codelineno-51-33 name=__codelineno-51-33 href=#__codelineno-51-33></a>        <span class=o>-&gt;</span><span class=na>request</span>
<a id=__codelineno-51-34 name=__codelineno-51-34 href=#__codelineno-51-34></a>        <span class=o>-&gt;</span><span class=na>getPost</span><span class=p>(</span><span class=s1>&#39;price&#39;</span><span class=p>,</span> <span class=s1>&#39;double&#39;</span><span class=p>)</span>
<a id=__codelineno-51-35 name=__codelineno-51-35 href=#__codelineno-51-35></a>    <span class=p>;</span>
<a id=__codelineno-51-36 name=__codelineno-51-36 href=#__codelineno-51-36></a>
<a id=__codelineno-51-37 name=__codelineno-51-37 href=#__codelineno-51-37></a>    <span class=nv>$product</span><span class=o>-&gt;</span><span class=na>active</span> <span class=o>=</span> <span class=nv>$this</span>
<a id=__codelineno-51-38 name=__codelineno-51-38 href=#__codelineno-51-38></a>        <span class=o>-&gt;</span><span class=na>request</span>
<a id=__codelineno-51-39 name=__codelineno-51-39 href=#__codelineno-51-39></a>        <span class=o>-&gt;</span><span class=na>getPost</span><span class=p>(</span><span class=s1>&#39;active&#39;</span><span class=p>)</span>
<a id=__codelineno-51-40 name=__codelineno-51-40 href=#__codelineno-51-40></a>    <span class=p>;</span>
<a id=__codelineno-51-41 name=__codelineno-51-41 href=#__codelineno-51-41></a>
<a id=__codelineno-51-42 name=__codelineno-51-42 href=#__codelineno-51-42></a>    <span class=c1>// ...</span>
<a id=__codelineno-51-43 name=__codelineno-51-43 href=#__codelineno-51-43></a><span class=p>}</span>
</code></pre></div> As seen earlier, when we were creating the form, there were some filters assigned to the relevant elements. When the data is passed to the form, these filters are invoked, and they sanitize the supplied input. Although this filtering is optional, it is always a good practice. Added to this, the ORM also escapes the supplied data and performs additional casting according to the column types:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-52-1 name=__codelineno-52-1 href=#__codelineno-52-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-52-2 name=__codelineno-52-2 href=#__codelineno-52-2></a>
<a id=__codelineno-52-3 name=__codelineno-52-3 href=#__codelineno-52-3></a><span class=c1>// ...</span>
<a id=__codelineno-52-4 name=__codelineno-52-4 href=#__codelineno-52-4></a>
<a id=__codelineno-52-5 name=__codelineno-52-5 href=#__codelineno-52-5></a><span class=nv>$name</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Text</span><span class=p>(</span><span class=s1>&#39;name&#39;</span><span class=p>);</span>
<a id=__codelineno-52-6 name=__codelineno-52-6 href=#__codelineno-52-6></a><span class=nv>$name</span><span class=o>-&gt;</span><span class=na>setLabel</span><span class=p>(</span><span class=s1>&#39;Name&#39;</span><span class=p>);</span>
<a id=__codelineno-52-7 name=__codelineno-52-7 href=#__codelineno-52-7></a><span class=nv>$name</span><span class=o>-&gt;</span><span class=na>setFilters</span><span class=p>(</span>
<a id=__codelineno-52-8 name=__codelineno-52-8 href=#__codelineno-52-8></a>    <span class=p>[</span>
<a id=__codelineno-52-9 name=__codelineno-52-9 href=#__codelineno-52-9></a>        <span class=s1>&#39;striptags&#39;</span><span class=p>,</span>
<a id=__codelineno-52-10 name=__codelineno-52-10 href=#__codelineno-52-10></a>        <span class=s1>&#39;string&#39;</span><span class=p>,</span>
<a id=__codelineno-52-11 name=__codelineno-52-11 href=#__codelineno-52-11></a>    <span class=p>]</span>
<a id=__codelineno-52-12 name=__codelineno-52-12 href=#__codelineno-52-12></a><span class=p>);</span>
<a id=__codelineno-52-13 name=__codelineno-52-13 href=#__codelineno-52-13></a>
<a id=__codelineno-52-14 name=__codelineno-52-14 href=#__codelineno-52-14></a><span class=nv>$name</span><span class=o>-&gt;</span><span class=na>addValidators</span><span class=p>(</span>
<a id=__codelineno-52-15 name=__codelineno-52-15 href=#__codelineno-52-15></a>    <span class=p>[</span>
<a id=__codelineno-52-16 name=__codelineno-52-16 href=#__codelineno-52-16></a>        <span class=k>new</span> <span class=nx>PresenceOf</span><span class=p>(</span>
<a id=__codelineno-52-17 name=__codelineno-52-17 href=#__codelineno-52-17></a>            <span class=p>[</span>
<a id=__codelineno-52-18 name=__codelineno-52-18 href=#__codelineno-52-18></a>                <span class=s1>&#39;message&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;Name is required&#39;</span><span class=p>,</span>
<a id=__codelineno-52-19 name=__codelineno-52-19 href=#__codelineno-52-19></a>            <span class=p>]</span>
<a id=__codelineno-52-20 name=__codelineno-52-20 href=#__codelineno-52-20></a>        <span class=p>)</span>
<a id=__codelineno-52-21 name=__codelineno-52-21 href=#__codelineno-52-21></a>    <span class=p>]</span>
<a id=__codelineno-52-22 name=__codelineno-52-22 href=#__codelineno-52-22></a><span class=p>);</span>
<a id=__codelineno-52-23 name=__codelineno-52-23 href=#__codelineno-52-23></a>
<a id=__codelineno-52-24 name=__codelineno-52-24 href=#__codelineno-52-24></a><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>add</span><span class=p>(</span><span class=nv>$name</span><span class=p>);</span>
</code></pre></div> <p>Upon saving the data, we will know whether the business rules and validations implemented in the <code>ProductsForm</code> pass (<code>src/Forms/ProductsForm.php</code>):</p> <div class=highlight><pre><span></span><code><a id=__codelineno-53-1 name=__codelineno-53-1 href=#__codelineno-53-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-53-2 name=__codelineno-53-2 href=#__codelineno-53-2></a>
<a id=__codelineno-53-3 name=__codelineno-53-3 href=#__codelineno-53-3></a><span class=c1>// ...</span>
<a id=__codelineno-53-4 name=__codelineno-53-4 href=#__codelineno-53-4></a>
<a id=__codelineno-53-5 name=__codelineno-53-5 href=#__codelineno-53-5></a><span class=nv>$form</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>ProductsForm</span><span class=p>();</span>
<a id=__codelineno-53-6 name=__codelineno-53-6 href=#__codelineno-53-6></a>
<a id=__codelineno-53-7 name=__codelineno-53-7 href=#__codelineno-53-7></a><span class=nv>$product</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Products</span><span class=p>();</span>
<a id=__codelineno-53-8 name=__codelineno-53-8 href=#__codelineno-53-8></a>
<a id=__codelineno-53-9 name=__codelineno-53-9 href=#__codelineno-53-9></a><span class=nv>$data</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>request</span><span class=o>-&gt;</span><span class=na>getPost</span><span class=p>();</span>
<a id=__codelineno-53-10 name=__codelineno-53-10 href=#__codelineno-53-10></a>
<a id=__codelineno-53-11 name=__codelineno-53-11 href=#__codelineno-53-11></a><span class=k>if</span> <span class=p>(</span><span class=k>true</span> <span class=o>!==</span> <span class=nv>$form</span><span class=o>-&gt;</span><span class=na>isValid</span><span class=p>(</span><span class=nv>$data</span><span class=p>,</span> <span class=nv>$product</span><span class=p>))</span> <span class=p>{</span>
<a id=__codelineno-53-12 name=__codelineno-53-12 href=#__codelineno-53-12></a>    <span class=nv>$messages</span> <span class=o>=</span> <span class=nv>$form</span><span class=o>-&gt;</span><span class=na>getMessages</span><span class=p>();</span>
<a id=__codelineno-53-13 name=__codelineno-53-13 href=#__codelineno-53-13></a>
<a id=__codelineno-53-14 name=__codelineno-53-14 href=#__codelineno-53-14></a>    <span class=k>foreach</span> <span class=p>(</span><span class=nv>$messages</span> <span class=k>as</span> <span class=nv>$message</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-53-15 name=__codelineno-53-15 href=#__codelineno-53-15></a>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>flash</span><span class=o>-&gt;</span><span class=na>error</span><span class=p>(</span><span class=nv>$message</span><span class=o>-&gt;</span><span class=na>getMessage</span><span class=p>());</span>
<a id=__codelineno-53-16 name=__codelineno-53-16 href=#__codelineno-53-16></a>    <span class=p>}</span>
<a id=__codelineno-53-17 name=__codelineno-53-17 href=#__codelineno-53-17></a>
<a id=__codelineno-53-18 name=__codelineno-53-18 href=#__codelineno-53-18></a>    <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>dispatcher</span><span class=o>-&gt;</span><span class=na>forward</span><span class=p>(</span>
<a id=__codelineno-53-19 name=__codelineno-53-19 href=#__codelineno-53-19></a>        <span class=p>[</span>
<a id=__codelineno-53-20 name=__codelineno-53-20 href=#__codelineno-53-20></a>            <span class=s1>&#39;controller&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;products&#39;</span><span class=p>,</span>
<a id=__codelineno-53-21 name=__codelineno-53-21 href=#__codelineno-53-21></a>            <span class=s1>&#39;action&#39;</span>     <span class=o>=&gt;</span> <span class=s1>&#39;new&#39;</span><span class=p>,</span>
<a id=__codelineno-53-22 name=__codelineno-53-22 href=#__codelineno-53-22></a>        <span class=p>]</span>
<a id=__codelineno-53-23 name=__codelineno-53-23 href=#__codelineno-53-23></a>    <span class=p>);</span>
<a id=__codelineno-53-24 name=__codelineno-53-24 href=#__codelineno-53-24></a><span class=p>}</span>
</code></pre></div> <p>Calling <code>$form-&gt;isValid()</code> invokes all the validators set in the form. If the validation does not pass, the <code>$messages</code> variable will contain the relevant messages of the failed validations.</p> <p>If there are no validation errors, we can save the record:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-54-1 name=__codelineno-54-1 href=#__codelineno-54-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-54-2 name=__codelineno-54-2 href=#__codelineno-54-2></a>
<a id=__codelineno-54-3 name=__codelineno-54-3 href=#__codelineno-54-3></a><span class=c1>// ...</span>
<a id=__codelineno-54-4 name=__codelineno-54-4 href=#__codelineno-54-4></a>
<a id=__codelineno-54-5 name=__codelineno-54-5 href=#__codelineno-54-5></a><span class=k>if</span> <span class=p>(</span><span class=nv>$product</span><span class=o>-&gt;</span><span class=na>save</span><span class=p>()</span> <span class=o>===</span> <span class=k>false</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-54-6 name=__codelineno-54-6 href=#__codelineno-54-6></a>    <span class=nv>$messages</span> <span class=o>=</span> <span class=nv>$product</span><span class=o>-&gt;</span><span class=na>getMessages</span><span class=p>();</span>
<a id=__codelineno-54-7 name=__codelineno-54-7 href=#__codelineno-54-7></a>
<a id=__codelineno-54-8 name=__codelineno-54-8 href=#__codelineno-54-8></a>    <span class=k>foreach</span> <span class=p>(</span><span class=nv>$messages</span> <span class=k>as</span> <span class=nv>$message</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-54-9 name=__codelineno-54-9 href=#__codelineno-54-9></a>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>flash</span><span class=o>-&gt;</span><span class=na>error</span><span class=p>(</span><span class=nv>$message</span><span class=o>-&gt;</span><span class=na>getMessage</span><span class=p>());</span>
<a id=__codelineno-54-10 name=__codelineno-54-10 href=#__codelineno-54-10></a>    <span class=p>}</span>
<a id=__codelineno-54-11 name=__codelineno-54-11 href=#__codelineno-54-11></a>
<a id=__codelineno-54-12 name=__codelineno-54-12 href=#__codelineno-54-12></a>    <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>dispatcher</span><span class=o>-&gt;</span><span class=na>forward</span><span class=p>(</span>
<a id=__codelineno-54-13 name=__codelineno-54-13 href=#__codelineno-54-13></a>        <span class=p>[</span>
<a id=__codelineno-54-14 name=__codelineno-54-14 href=#__codelineno-54-14></a>            <span class=s1>&#39;controller&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;products&#39;</span><span class=p>,</span>
<a id=__codelineno-54-15 name=__codelineno-54-15 href=#__codelineno-54-15></a>            <span class=s1>&#39;action&#39;</span>     <span class=o>=&gt;</span> <span class=s1>&#39;new&#39;</span><span class=p>,</span>
<a id=__codelineno-54-16 name=__codelineno-54-16 href=#__codelineno-54-16></a>        <span class=p>]</span>
<a id=__codelineno-54-17 name=__codelineno-54-17 href=#__codelineno-54-17></a>    <span class=p>);</span>
<a id=__codelineno-54-18 name=__codelineno-54-18 href=#__codelineno-54-18></a><span class=p>}</span>
<a id=__codelineno-54-19 name=__codelineno-54-19 href=#__codelineno-54-19></a>
<a id=__codelineno-54-20 name=__codelineno-54-20 href=#__codelineno-54-20></a><span class=nv>$form</span><span class=o>-&gt;</span><span class=na>clear</span><span class=p>();</span>
<a id=__codelineno-54-21 name=__codelineno-54-21 href=#__codelineno-54-21></a>
<a id=__codelineno-54-22 name=__codelineno-54-22 href=#__codelineno-54-22></a><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>flash</span><span class=o>-&gt;</span><span class=na>success</span><span class=p>(</span>
<a id=__codelineno-54-23 name=__codelineno-54-23 href=#__codelineno-54-23></a>    <span class=s1>&#39;Product was created successfully&#39;</span>
<a id=__codelineno-54-24 name=__codelineno-54-24 href=#__codelineno-54-24></a><span class=p>);</span>
<a id=__codelineno-54-25 name=__codelineno-54-25 href=#__codelineno-54-25></a>
<a id=__codelineno-54-26 name=__codelineno-54-26 href=#__codelineno-54-26></a><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>dispatcher</span><span class=o>-&gt;</span><span class=na>forward</span><span class=p>(</span>
<a id=__codelineno-54-27 name=__codelineno-54-27 href=#__codelineno-54-27></a>    <span class=p>[</span>
<a id=__codelineno-54-28 name=__codelineno-54-28 href=#__codelineno-54-28></a>        <span class=s1>&#39;controller&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;products&#39;</span><span class=p>,</span>
<a id=__codelineno-54-29 name=__codelineno-54-29 href=#__codelineno-54-29></a>        <span class=s1>&#39;action&#39;</span>     <span class=o>=&gt;</span> <span class=s1>&#39;index&#39;</span><span class=p>,</span>
<a id=__codelineno-54-30 name=__codelineno-54-30 href=#__codelineno-54-30></a>    <span class=p>]</span>
<a id=__codelineno-54-31 name=__codelineno-54-31 href=#__codelineno-54-31></a><span class=p>);</span>
</code></pre></div> <p>We are checking the result of the <code>save()</code> method on the model and if errors occur, they will be present in the <code>$messages</code> variable and the user will be sent back to the <code>products/new</code> action with error messages displayed. If everything is OK, the form is cleared and the user is redirected to the <code>products/index</code> with the relevant success message.</p> <p>In the case of updating a product, we must first get the relevant record from the database and then populate the form with the existing data:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-55-1 name=__codelineno-55-1 href=#__codelineno-55-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-55-2 name=__codelineno-55-2 href=#__codelineno-55-2></a>
<a id=__codelineno-55-3 name=__codelineno-55-3 href=#__codelineno-55-3></a><span class=k>public</span> <span class=k>function</span> <span class=nf>editAction</span><span class=p>(</span><span class=nv>$id</span><span class=p>)</span>
<a id=__codelineno-55-4 name=__codelineno-55-4 href=#__codelineno-55-4></a><span class=p>{</span>
<a id=__codelineno-55-5 name=__codelineno-55-5 href=#__codelineno-55-5></a>    <span class=k>if</span> <span class=p>(</span><span class=k>true</span> <span class=o>!==</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>request</span><span class=o>-&gt;</span><span class=na>isPost</span><span class=p>())</span> <span class=p>{</span>
<a id=__codelineno-55-6 name=__codelineno-55-6 href=#__codelineno-55-6></a>        <span class=nv>$product</span> <span class=o>=</span> <span class=nx>Products</span><span class=o>::</span><span class=na>findFirstById</span><span class=p>(</span><span class=nv>$id</span><span class=p>);</span>
<a id=__codelineno-55-7 name=__codelineno-55-7 href=#__codelineno-55-7></a>
<a id=__codelineno-55-8 name=__codelineno-55-8 href=#__codelineno-55-8></a>        <span class=k>if</span> <span class=p>(</span><span class=k>null</span> <span class=o>!==</span> <span class=nv>$product</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-55-9 name=__codelineno-55-9 href=#__codelineno-55-9></a>            <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>flash</span><span class=o>-&gt;</span><span class=na>error</span><span class=p>(</span>
<a id=__codelineno-55-10 name=__codelineno-55-10 href=#__codelineno-55-10></a>                <span class=s1>&#39;Product was not found&#39;</span>
<a id=__codelineno-55-11 name=__codelineno-55-11 href=#__codelineno-55-11></a>            <span class=p>);</span>
<a id=__codelineno-55-12 name=__codelineno-55-12 href=#__codelineno-55-12></a>
<a id=__codelineno-55-13 name=__codelineno-55-13 href=#__codelineno-55-13></a>            <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>dispatcher</span><span class=o>-&gt;</span><span class=na>forward</span><span class=p>(</span>
<a id=__codelineno-55-14 name=__codelineno-55-14 href=#__codelineno-55-14></a>                <span class=p>[</span>
<a id=__codelineno-55-15 name=__codelineno-55-15 href=#__codelineno-55-15></a>                    <span class=s1>&#39;controller&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;products&#39;</span><span class=p>,</span>
<a id=__codelineno-55-16 name=__codelineno-55-16 href=#__codelineno-55-16></a>                    <span class=s1>&#39;action&#39;</span>     <span class=o>=&gt;</span> <span class=s1>&#39;index&#39;</span><span class=p>,</span>
<a id=__codelineno-55-17 name=__codelineno-55-17 href=#__codelineno-55-17></a>                <span class=p>]</span>
<a id=__codelineno-55-18 name=__codelineno-55-18 href=#__codelineno-55-18></a>            <span class=p>);</span>
<a id=__codelineno-55-19 name=__codelineno-55-19 href=#__codelineno-55-19></a>        <span class=p>}</span>
<a id=__codelineno-55-20 name=__codelineno-55-20 href=#__codelineno-55-20></a>
<a id=__codelineno-55-21 name=__codelineno-55-21 href=#__codelineno-55-21></a>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>view</span><span class=o>-&gt;</span><span class=na>form</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>ProductsForm</span><span class=p>(</span>
<a id=__codelineno-55-22 name=__codelineno-55-22 href=#__codelineno-55-22></a>            <span class=nv>$product</span><span class=p>,</span>
<a id=__codelineno-55-23 name=__codelineno-55-23 href=#__codelineno-55-23></a>            <span class=p>[</span>
<a id=__codelineno-55-24 name=__codelineno-55-24 href=#__codelineno-55-24></a>                <span class=s1>&#39;edit&#39;</span> <span class=o>=&gt;</span> <span class=k>true</span><span class=p>,</span>
<a id=__codelineno-55-25 name=__codelineno-55-25 href=#__codelineno-55-25></a>            <span class=p>]</span>
<a id=__codelineno-55-26 name=__codelineno-55-26 href=#__codelineno-55-26></a>        <span class=p>);</span>
<a id=__codelineno-55-27 name=__codelineno-55-27 href=#__codelineno-55-27></a>    <span class=p>}</span>
<a id=__codelineno-55-28 name=__codelineno-55-28 href=#__codelineno-55-28></a><span class=p>}</span>
</code></pre></div> <p>The data found is bound to the form by passing the model as the first parameter. Because of this, the user can change any value and then send it back to the database through to the <code>save</code> action:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-56-1 name=__codelineno-56-1 href=#__codelineno-56-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-56-2 name=__codelineno-56-2 href=#__codelineno-56-2></a>
<a id=__codelineno-56-3 name=__codelineno-56-3 href=#__codelineno-56-3></a><span class=k>public</span> <span class=k>function</span> <span class=nf>saveAction</span><span class=p>()</span>
<a id=__codelineno-56-4 name=__codelineno-56-4 href=#__codelineno-56-4></a><span class=p>{</span>
<a id=__codelineno-56-5 name=__codelineno-56-5 href=#__codelineno-56-5></a>    <span class=k>if</span> <span class=p>(</span><span class=k>true</span> <span class=o>!==</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>request</span><span class=o>-&gt;</span><span class=na>isPost</span><span class=p>())</span> <span class=p>{</span>
<a id=__codelineno-56-6 name=__codelineno-56-6 href=#__codelineno-56-6></a>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>dispatcher</span><span class=o>-&gt;</span><span class=na>forward</span><span class=p>(</span>
<a id=__codelineno-56-7 name=__codelineno-56-7 href=#__codelineno-56-7></a>            <span class=p>[</span>
<a id=__codelineno-56-8 name=__codelineno-56-8 href=#__codelineno-56-8></a>                <span class=s1>&#39;controller&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;products&#39;</span><span class=p>,</span>
<a id=__codelineno-56-9 name=__codelineno-56-9 href=#__codelineno-56-9></a>                <span class=s1>&#39;action&#39;</span>     <span class=o>=&gt;</span> <span class=s1>&#39;index&#39;</span><span class=p>,</span>
<a id=__codelineno-56-10 name=__codelineno-56-10 href=#__codelineno-56-10></a>            <span class=p>]</span>
<a id=__codelineno-56-11 name=__codelineno-56-11 href=#__codelineno-56-11></a>        <span class=p>);</span>
<a id=__codelineno-56-12 name=__codelineno-56-12 href=#__codelineno-56-12></a>    <span class=p>}</span>
<a id=__codelineno-56-13 name=__codelineno-56-13 href=#__codelineno-56-13></a>
<a id=__codelineno-56-14 name=__codelineno-56-14 href=#__codelineno-56-14></a>    <span class=nv>$id</span>      <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>request</span><span class=o>-&gt;</span><span class=na>getPost</span><span class=p>(</span><span class=s1>&#39;id&#39;</span><span class=p>,</span> <span class=s1>&#39;int&#39;</span><span class=p>);</span>
<a id=__codelineno-56-15 name=__codelineno-56-15 href=#__codelineno-56-15></a>    <span class=nv>$product</span> <span class=o>=</span> <span class=nx>Products</span><span class=o>::</span><span class=na>findFirstById</span><span class=p>(</span><span class=nv>$id</span><span class=p>);</span>
<a id=__codelineno-56-16 name=__codelineno-56-16 href=#__codelineno-56-16></a>
<a id=__codelineno-56-17 name=__codelineno-56-17 href=#__codelineno-56-17></a>    <span class=k>if</span> <span class=p>(</span><span class=k>null</span> <span class=o>!==</span> <span class=nv>$product</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-56-18 name=__codelineno-56-18 href=#__codelineno-56-18></a>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>flash</span><span class=o>-&gt;</span><span class=na>error</span><span class=p>(</span>
<a id=__codelineno-56-19 name=__codelineno-56-19 href=#__codelineno-56-19></a>            <span class=s1>&#39;Product does not exist&#39;</span>
<a id=__codelineno-56-20 name=__codelineno-56-20 href=#__codelineno-56-20></a>        <span class=p>);</span>
<a id=__codelineno-56-21 name=__codelineno-56-21 href=#__codelineno-56-21></a>
<a id=__codelineno-56-22 name=__codelineno-56-22 href=#__codelineno-56-22></a>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>dispatcher</span><span class=o>-&gt;</span><span class=na>forward</span><span class=p>(</span>
<a id=__codelineno-56-23 name=__codelineno-56-23 href=#__codelineno-56-23></a>            <span class=p>[</span>
<a id=__codelineno-56-24 name=__codelineno-56-24 href=#__codelineno-56-24></a>                <span class=s1>&#39;controller&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;products&#39;</span><span class=p>,</span>
<a id=__codelineno-56-25 name=__codelineno-56-25 href=#__codelineno-56-25></a>                <span class=s1>&#39;action&#39;</span>     <span class=o>=&gt;</span> <span class=s1>&#39;index&#39;</span><span class=p>,</span>
<a id=__codelineno-56-26 name=__codelineno-56-26 href=#__codelineno-56-26></a>            <span class=p>]</span>
<a id=__codelineno-56-27 name=__codelineno-56-27 href=#__codelineno-56-27></a>        <span class=p>);</span>
<a id=__codelineno-56-28 name=__codelineno-56-28 href=#__codelineno-56-28></a>    <span class=p>}</span>
<a id=__codelineno-56-29 name=__codelineno-56-29 href=#__codelineno-56-29></a>
<a id=__codelineno-56-30 name=__codelineno-56-30 href=#__codelineno-56-30></a>    <span class=nv>$form</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>ProductsForm</span><span class=p>();</span>
<a id=__codelineno-56-31 name=__codelineno-56-31 href=#__codelineno-56-31></a>    <span class=nv>$data</span> <span class=o>=</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>request</span><span class=o>-&gt;</span><span class=na>getPost</span><span class=p>();</span>
<a id=__codelineno-56-32 name=__codelineno-56-32 href=#__codelineno-56-32></a>
<a id=__codelineno-56-33 name=__codelineno-56-33 href=#__codelineno-56-33></a>    <span class=k>if</span> <span class=p>(</span><span class=k>true</span> <span class=o>!==</span> <span class=nv>$form</span><span class=o>-&gt;</span><span class=na>isValid</span><span class=p>(</span><span class=nv>$data</span><span class=p>,</span> <span class=nv>$product</span><span class=p>))</span> <span class=p>{</span>
<a id=__codelineno-56-34 name=__codelineno-56-34 href=#__codelineno-56-34></a>        <span class=nv>$messages</span> <span class=o>=</span> <span class=nv>$form</span><span class=o>-&gt;</span><span class=na>getMessages</span><span class=p>();</span>
<a id=__codelineno-56-35 name=__codelineno-56-35 href=#__codelineno-56-35></a>
<a id=__codelineno-56-36 name=__codelineno-56-36 href=#__codelineno-56-36></a>        <span class=k>foreach</span> <span class=p>(</span><span class=nv>$messages</span> <span class=k>as</span> <span class=nv>$message</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-56-37 name=__codelineno-56-37 href=#__codelineno-56-37></a>            <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>flash</span><span class=o>-&gt;</span><span class=na>error</span><span class=p>(</span><span class=nv>$message</span><span class=o>-&gt;</span><span class=na>getMessage</span><span class=p>());</span>
<a id=__codelineno-56-38 name=__codelineno-56-38 href=#__codelineno-56-38></a>        <span class=p>}</span>
<a id=__codelineno-56-39 name=__codelineno-56-39 href=#__codelineno-56-39></a>
<a id=__codelineno-56-40 name=__codelineno-56-40 href=#__codelineno-56-40></a>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>dispatcher</span><span class=o>-&gt;</span><span class=na>forward</span><span class=p>(</span>
<a id=__codelineno-56-41 name=__codelineno-56-41 href=#__codelineno-56-41></a>            <span class=p>[</span>
<a id=__codelineno-56-42 name=__codelineno-56-42 href=#__codelineno-56-42></a>                <span class=s1>&#39;controller&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;products&#39;</span><span class=p>,</span>
<a id=__codelineno-56-43 name=__codelineno-56-43 href=#__codelineno-56-43></a>                <span class=s1>&#39;action&#39;</span>     <span class=o>=&gt;</span> <span class=s1>&#39;new&#39;</span><span class=p>,</span>
<a id=__codelineno-56-44 name=__codelineno-56-44 href=#__codelineno-56-44></a>            <span class=p>]</span>
<a id=__codelineno-56-45 name=__codelineno-56-45 href=#__codelineno-56-45></a>        <span class=p>);</span>
<a id=__codelineno-56-46 name=__codelineno-56-46 href=#__codelineno-56-46></a>    <span class=p>}</span>
<a id=__codelineno-56-47 name=__codelineno-56-47 href=#__codelineno-56-47></a>
<a id=__codelineno-56-48 name=__codelineno-56-48 href=#__codelineno-56-48></a>    <span class=k>if</span> <span class=p>(</span><span class=k>false</span> <span class=o>===</span> <span class=nv>$product</span><span class=o>-&gt;</span><span class=na>save</span><span class=p>())</span> <span class=p>{</span>
<a id=__codelineno-56-49 name=__codelineno-56-49 href=#__codelineno-56-49></a>        <span class=nv>$messages</span> <span class=o>=</span> <span class=nv>$product</span><span class=o>-&gt;</span><span class=na>getMessages</span><span class=p>();</span>
<a id=__codelineno-56-50 name=__codelineno-56-50 href=#__codelineno-56-50></a>
<a id=__codelineno-56-51 name=__codelineno-56-51 href=#__codelineno-56-51></a>        <span class=k>foreach</span> <span class=p>(</span><span class=nv>$messages</span> <span class=k>as</span> <span class=nv>$message</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-56-52 name=__codelineno-56-52 href=#__codelineno-56-52></a>            <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>flash</span><span class=o>-&gt;</span><span class=na>error</span><span class=p>(</span><span class=nv>$message</span><span class=o>-&gt;</span><span class=na>getMessage</span><span class=p>());</span>
<a id=__codelineno-56-53 name=__codelineno-56-53 href=#__codelineno-56-53></a>        <span class=p>}</span>
<a id=__codelineno-56-54 name=__codelineno-56-54 href=#__codelineno-56-54></a>
<a id=__codelineno-56-55 name=__codelineno-56-55 href=#__codelineno-56-55></a>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>dispatcher</span><span class=o>-&gt;</span><span class=na>forward</span><span class=p>(</span>
<a id=__codelineno-56-56 name=__codelineno-56-56 href=#__codelineno-56-56></a>            <span class=p>[</span>
<a id=__codelineno-56-57 name=__codelineno-56-57 href=#__codelineno-56-57></a>                <span class=s1>&#39;controller&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;products&#39;</span><span class=p>,</span>
<a id=__codelineno-56-58 name=__codelineno-56-58 href=#__codelineno-56-58></a>                <span class=s1>&#39;action&#39;</span>     <span class=o>=&gt;</span> <span class=s1>&#39;new&#39;</span><span class=p>,</span>
<a id=__codelineno-56-59 name=__codelineno-56-59 href=#__codelineno-56-59></a>            <span class=p>]</span>
<a id=__codelineno-56-60 name=__codelineno-56-60 href=#__codelineno-56-60></a>        <span class=p>);</span>
<a id=__codelineno-56-61 name=__codelineno-56-61 href=#__codelineno-56-61></a>    <span class=p>}</span>
<a id=__codelineno-56-62 name=__codelineno-56-62 href=#__codelineno-56-62></a>
<a id=__codelineno-56-63 name=__codelineno-56-63 href=#__codelineno-56-63></a>    <span class=nv>$form</span><span class=o>-&gt;</span><span class=na>clear</span><span class=p>();</span>
<a id=__codelineno-56-64 name=__codelineno-56-64 href=#__codelineno-56-64></a>
<a id=__codelineno-56-65 name=__codelineno-56-65 href=#__codelineno-56-65></a>    <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>flash</span><span class=o>-&gt;</span><span class=na>success</span><span class=p>(</span>
<a id=__codelineno-56-66 name=__codelineno-56-66 href=#__codelineno-56-66></a>        <span class=s1>&#39;Product was updated successfully&#39;</span>
<a id=__codelineno-56-67 name=__codelineno-56-67 href=#__codelineno-56-67></a>    <span class=p>);</span>
<a id=__codelineno-56-68 name=__codelineno-56-68 href=#__codelineno-56-68></a>
<a id=__codelineno-56-69 name=__codelineno-56-69 href=#__codelineno-56-69></a>    <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>dispatcher</span><span class=o>-&gt;</span><span class=na>forward</span><span class=p>(</span>
<a id=__codelineno-56-70 name=__codelineno-56-70 href=#__codelineno-56-70></a>        <span class=p>[</span>
<a id=__codelineno-56-71 name=__codelineno-56-71 href=#__codelineno-56-71></a>            <span class=s1>&#39;controller&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;products&#39;</span><span class=p>,</span>
<a id=__codelineno-56-72 name=__codelineno-56-72 href=#__codelineno-56-72></a>            <span class=s1>&#39;action&#39;</span>     <span class=o>=&gt;</span> <span class=s1>&#39;index&#39;</span><span class=p>,</span>
<a id=__codelineno-56-73 name=__codelineno-56-73 href=#__codelineno-56-73></a>        <span class=p>]</span>
<a id=__codelineno-56-74 name=__codelineno-56-74 href=#__codelineno-56-74></a>    <span class=p>);</span>
<a id=__codelineno-56-75 name=__codelineno-56-75 href=#__codelineno-56-75></a><span class=p>}</span>
</code></pre></div> <h2 id=dynamic-titles>Dynamic Titles<a class=headerlink href=#dynamic-titles title="Permanent link">&para;</a></h2> <p>When you navigate through the application, you will see that the title changes dynamically indicating where we are currently working. This is achieved in each controller (<code>initialize()</code> method):</p> <div class=highlight><pre><span></span><code><a id=__codelineno-57-1 name=__codelineno-57-1 href=#__codelineno-57-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-57-2 name=__codelineno-57-2 href=#__codelineno-57-2></a>
<a id=__codelineno-57-3 name=__codelineno-57-3 href=#__codelineno-57-3></a><span class=k>class</span> <span class=nc>ProductsController</span> <span class=k>extends</span> <span class=nx>ControllerBase</span>
<a id=__codelineno-57-4 name=__codelineno-57-4 href=#__codelineno-57-4></a><span class=p>{</span>
<a id=__codelineno-57-5 name=__codelineno-57-5 href=#__codelineno-57-5></a>    <span class=k>public</span> <span class=k>function</span> <span class=nf>initialize</span><span class=p>()</span>
<a id=__codelineno-57-6 name=__codelineno-57-6 href=#__codelineno-57-6></a>    <span class=p>{</span>
<a id=__codelineno-57-7 name=__codelineno-57-7 href=#__codelineno-57-7></a>        <span class=k>parent</span><span class=o>::</span><span class=na>initialize</span><span class=p>();</span>
<a id=__codelineno-57-8 name=__codelineno-57-8 href=#__codelineno-57-8></a>
<a id=__codelineno-57-9 name=__codelineno-57-9 href=#__codelineno-57-9></a>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>tag</span><span class=o>-&gt;</span><span class=na>title</span><span class=p>()</span>
<a id=__codelineno-57-10 name=__codelineno-57-10 href=#__codelineno-57-10></a>                  <span class=o>-&gt;</span><span class=na>set</span><span class=p>(</span><span class=s1>&#39;Manage your products&#39;</span><span class=p>)</span>
<a id=__codelineno-57-11 name=__codelineno-57-11 href=#__codelineno-57-11></a>        <span class=p>;</span>
<a id=__codelineno-57-12 name=__codelineno-57-12 href=#__codelineno-57-12></a>    <span class=p>}</span>
<a id=__codelineno-57-13 name=__codelineno-57-13 href=#__codelineno-57-13></a>
<a id=__codelineno-57-14 name=__codelineno-57-14 href=#__codelineno-57-14></a>    <span class=c1>// ...</span>
<a id=__codelineno-57-15 name=__codelineno-57-15 href=#__codelineno-57-15></a><span class=p>}</span>
</code></pre></div> <p>Note, that the method <code>parent::initialize()</code> is also called, it adds more data to the title:</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-58-1 name=__codelineno-58-1 href=#__codelineno-58-1></a><span class=o>&lt;?</span><span class=nx>php</span>
<a id=__codelineno-58-2 name=__codelineno-58-2 href=#__codelineno-58-2></a>
<a id=__codelineno-58-3 name=__codelineno-58-3 href=#__codelineno-58-3></a><span class=k>use</span> <span class=nx>Phalcon\Mvc\Controller</span><span class=p>;</span>
<a id=__codelineno-58-4 name=__codelineno-58-4 href=#__codelineno-58-4></a>
<a id=__codelineno-58-5 name=__codelineno-58-5 href=#__codelineno-58-5></a><span class=k>class</span> <span class=nc>ControllerBase</span> <span class=k>extends</span> <span class=nx>Controller</span>
<a id=__codelineno-58-6 name=__codelineno-58-6 href=#__codelineno-58-6></a><span class=p>{</span>
<a id=__codelineno-58-7 name=__codelineno-58-7 href=#__codelineno-58-7></a>    <span class=k>protected</span> <span class=k>function</span> <span class=nf>initialize</span><span class=p>()</span>
<a id=__codelineno-58-8 name=__codelineno-58-8 href=#__codelineno-58-8></a>    <span class=p>{</span>
<a id=__codelineno-58-9 name=__codelineno-58-9 href=#__codelineno-58-9></a>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>tag</span><span class=o>-&gt;</span><span class=na>title</span><span class=p>()</span>
<a id=__codelineno-58-10 name=__codelineno-58-10 href=#__codelineno-58-10></a>                  <span class=o>-&gt;</span><span class=na>prepend</span><span class=p>(</span><span class=s1>&#39;INVO | &#39;</span><span class=p>)</span>
<a id=__codelineno-58-11 name=__codelineno-58-11 href=#__codelineno-58-11></a>        <span class=p>;</span>
<a id=__codelineno-58-12 name=__codelineno-58-12 href=#__codelineno-58-12></a>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>view</span><span class=o>-&gt;</span><span class=na>setTemplateAfter</span><span class=p>(</span><span class=s1>&#39;main&#39;</span><span class=p>);</span>
<a id=__codelineno-58-13 name=__codelineno-58-13 href=#__codelineno-58-13></a>    <span class=p>}</span>
<a id=__codelineno-58-14 name=__codelineno-58-14 href=#__codelineno-58-14></a>
<a id=__codelineno-58-15 name=__codelineno-58-15 href=#__codelineno-58-15></a>    <span class=c1>// ...</span>
<a id=__codelineno-58-16 name=__codelineno-58-16 href=#__codelineno-58-16></a><span class=p>}</span>
</code></pre></div> The above code prepends the application name to the title</p> <p>Finally, the title is printed in the main view (<code>themes/invo/views/index.volt</code>):</p> <div class=highlight><pre><span></span><code><a id=__codelineno-59-1 name=__codelineno-59-1 href=#__codelineno-59-1></a><span class=o>&lt;!</span><span class=nx>DOCTYPE</span> <span class=nx>html</span><span class=o>&gt;</span>
<a id=__codelineno-59-2 name=__codelineno-59-2 href=#__codelineno-59-2></a><span class=o>&lt;</span><span class=nx>html</span><span class=o>&gt;</span>
<a id=__codelineno-59-3 name=__codelineno-59-3 href=#__codelineno-59-3></a>    <span class=o>&lt;</span><span class=nx>head</span><span class=o>&gt;</span>
<a id=__codelineno-59-4 name=__codelineno-59-4 href=#__codelineno-59-4></a>        <span class=o>&lt;?</span><span class=nx>php</span> <span class=k>echo</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>tag</span><span class=o>-&gt;</span><span class=na>getTitle</span><span class=p>();</span> <span class=cp>?&gt;</span>
<a id=__codelineno-59-5 name=__codelineno-59-5 href=#__codelineno-59-5></a><span class=x>    &lt;/head&gt;</span>
<a id=__codelineno-59-6 name=__codelineno-59-6 href=#__codelineno-59-6></a>
<a id=__codelineno-59-7 name=__codelineno-59-7 href=#__codelineno-59-7></a><span class=x>    &lt;!-- ... --&gt;</span>
<a id=__codelineno-59-8 name=__codelineno-59-8 href=#__codelineno-59-8></a><span class=x>&lt;/html&gt;</span>
</code></pre></div> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../tutorial-basic/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Basic"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> Basic </div> </div> </a> <a href=../tutorial-rest/ class="md-footer__link md-footer__link--next" aria-label="Next: REST"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> REST </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2012 - present Phalcon Team </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://phalcon.io/discord target=_blank rel=noopener title=Discord class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 640 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M524.531 69.836a1.5 1.5 0 0 0-.764-.7A485.065 485.065 0 0 0 404.081 32.03a1.816 1.816 0 0 0-1.923.91 337.461 337.461 0 0 0-14.9 30.6 447.848 447.848 0 0 0-134.426 0 309.541 309.541 0 0 0-15.135-30.6 1.89 1.89 0 0 0-1.924-.91 483.689 483.689 0 0 0-119.688 37.107 1.712 1.712 0 0 0-.788.676C39.068 183.651 18.186 294.69 28.43 404.354a2.016 2.016 0 0 0 .765 1.375 487.666 487.666 0 0 0 146.825 74.189 1.9 1.9 0 0 0 2.063-.676A348.2 348.2 0 0 0 208.12 430.4a1.86 1.86 0 0 0-1.019-2.588 321.173 321.173 0 0 1-45.868-21.853 1.885 1.885 0 0 1-.185-3.126 251.047 251.047 0 0 0 9.109-7.137 1.819 1.819 0 0 1 1.9-.256c96.229 43.917 200.41 43.917 295.5 0a1.812 1.812 0 0 1 1.924.233 234.533 234.533 0 0 0 9.132 7.16 1.884 1.884 0 0 1-.162 3.126 301.407 301.407 0 0 1-45.89 21.83 1.875 1.875 0 0 0-1 2.611 391.055 391.055 0 0 0 30.014 48.815 1.864 1.864 0 0 0 2.063.7A486.048 486.048 0 0 0 610.7 405.729a1.882 1.882 0 0 0 .765-1.352c12.264-126.783-20.532-236.912-86.934-334.541ZM222.491 337.58c-28.972 0-52.844-26.587-52.844-59.239s23.409-59.241 52.844-59.241c29.665 0 53.306 26.82 52.843 59.239 0 32.654-23.41 59.241-52.843 59.241Zm195.38 0c-28.971 0-52.843-26.587-52.843-59.239s23.409-59.241 52.843-59.241c29.667 0 53.307 26.82 52.844 59.239 0 32.654-23.177 59.241-52.844 59.241Z"/></svg> </a> <a href=https://phalcon.io/discussions target=_blank rel=noopener title="GitHub Discussions" class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9 22a1 1 0 0 1-1-1v-3H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2h-6.1l-3.7 3.71c-.2.19-.45.29-.7.29H9Z"/></svg> </a> <a href=https://phalcon.io/github target=_blank rel=noopener title="GitHub Project" class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> <a href=https://phalcon.io/telegram target=_blank rel=noopener title=Telegram class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M248 8C111.033 8 0 119.033 0 256s111.033 248 248 248 248-111.033 248-248S384.967 8 248 8Zm114.952 168.66c-3.732 39.215-19.881 134.378-28.1 178.3-3.476 18.584-10.322 24.816-16.948 25.425-14.4 1.326-25.338-9.517-39.287-18.661-21.827-14.308-34.158-23.215-55.346-37.177-24.485-16.135-8.612-25 5.342-39.5 3.652-3.793 67.107-61.51 68.335-66.746.153-.655.3-3.1-1.154-4.384s-3.59-.849-5.135-.5q-3.283.746-104.608 69.142-14.845 10.194-26.894 9.934c-8.855-.191-25.888-5.006-38.551-9.123-15.531-5.048-27.875-7.717-26.8-16.291q.84-6.7 18.45-13.7 108.446-47.248 144.628-62.3c68.872-28.647 83.183-33.623 92.511-33.789 2.052-.034 6.639.474 9.61 2.885a10.452 10.452 0 0 1 3.53 6.716 43.765 43.765 0 0 1 .417 9.769Z"/></svg> </a> <a href=https://phalcon.io/gab target=_blank rel=noopener title=Gab class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 576 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M368 32c41.7 0 75.9 31.8 79.7 72.5l85.6 26.3c25.4 7.8 42.8 31.3 42.8 57.9 0 21.8-11.7 41.9-30.7 52.7l-144.6 82.1 92.5 92.5H544c17.7 0 32 14.3 32 32s-14.3 32-32 32h-64c-8.5 0-16.6-3.4-22.6-9.4L346.9 360.2c11.7-36 3.2-77.1-25.4-105.7-40.6-40.6-106.3-40.6-146.9-.1l-73.6 70c-6.4 6.1-6.7 16.2-.6 22.6s16.2 6.6 22.6.6l73.8-70.2.1-.1.1-.1c3.5-3.5 7.3-6.6 11.3-9.2 27.9-18.5 65.9-15.4 90.5 9.2 24.7 24.7 27.7 62.9 9 90.9-2.6 3.8-5.6 7.5-9 10.9l-37 37H352c17.7 0 32 14.3 32 32s-14.3 32-32 32H64c-35.3 0-64-28.7-64-64C0 249.6 127 112.9 289.3 97.5 296.2 60.2 328.8 32 368 32zm0 104a24 24 0 1 0 0-48 24 24 0 1 0 0 48z"/></svg> </a> <a href=https://phalcon.io/t target=_blank rel=noopener title=Twitter class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8l164.9-188.5L26.8 48h145.6l100.5 132.9L389.2 48zm-24.8 373.8h39.1L151.1 88h-42l255.3 333.8z"/></svg> </a> <a href=https://phalcon.io/fb target=_blank rel=noopener title=Facebook class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M512 256C512 114.6 397.4 0 256 0S0 114.6 0 256c0 120 82.7 220.8 194.2 248.5V334.2h-52.8V256h52.8v-33.7c0-87.1 39.4-127.5 125-127.5 16.2 0 44.2 3.2 55.7 6.4V172c-6-.6-16.5-1-29.6-1-42 0-58.2 15.9-58.2 57.2V256h83.6l-14.4 78.2H287v175.9C413.8 494.8 512 386.9 512 256z"/></svg> </a> <a href=https://phalcon.io/linkedin target=_blank rel=noopener title=LinkedIn class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg> </a> <a href=https://phalcon.io/youtube target=_blank rel=noopener title=LinkedIn class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 576 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-progress data-md-component=progress role=progressbar></div> <script id=__config type=application/json>{"base": "..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.code.select", "content.tooltips", "navigation.footer", "navigation.indexes", "navigation.instant", "navigation.instant.progress", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "5.4.0", "provider": "mike"}}</script> <script src=../assets/javascripts/bundle.ad660dcc.min.js></script> </body> </html>